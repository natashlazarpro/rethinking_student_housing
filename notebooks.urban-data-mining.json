{"version":3,"kind":"Notebook","sha256":"d8b84ccc8b38dc9b187cfb71dfb9df7641faf88e8d8f284877c50e0caeafe05b","slug":"notebooks.urban-data-mining","location":"/notebooks/2.2_urban_data_mining.ipynb","dependencies":[],"frontmatter":{"title":"2.2 Urban Data Mining","content_includes_title":true,"kernelspec":{"name":"python3","display_name":"geodatascience2.0","language":"python"},"authors":[{"nameParsed":{"literal":"Lazareva Nataliia","given":"Lazareva","family":"Nataliia"},"name":"Lazareva Nataliia","id":"contributors-myst-generated-uid-0"},{"nameParsed":{"literal":"Urban Design M.Sc.","given":"Urban Design","family":"M.Sc."},"name":"Urban Design M.Sc.","id":"contributors-myst-generated-uid-1"},{"nameParsed":{"literal":"Technical University of Berlin","given":"Technical University","non_dropping_particle":"of","family":"Berlin"},"name":"Technical University of Berlin","id":"contributors-myst-generated-uid-2"}],"github":"https://github.com/natashlazarpro/rethinking_student_housing","copyright":"2025","numbering":{"title":{"offset":1}},"source_url":"https://github.com/natashlazarpro/rethinking_student_housing/blob/main/student-housing-book/notebooks/2.2_urban_data_mining.ipynb","edit_url":"https://github.com/natashlazarpro/rethinking_student_housing/edit/main/student-housing-book/notebooks/2.2_urban_data_mining.ipynb","exports":[{"format":"ipynb","filename":"2.2_urban_data_mining.ipynb","url":"/rethinking_student_housing/build/2.2_urban_data_minin-8627e6bc6a1b280b3604ea201372b393.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"import warnings\n\nwarnings.filterwarnings(\"ignore\")\n\nimport pandas as pd\nimport os\nhf = r'../outputs/2.2_urban_data_mining/'\nos.makedirs(hf, exist_ok=True)","visibility":"remove","key":"d1vsIIsbBk"},{"type":"outputs","id":"lrKHDMcgra8tq6pAmXVhg","children":[],"visibility":"show","key":"zAcP8j0i3G"}],"visibility":"show","key":"Oi5QcSJvUF"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":1,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"2.2 Urban Data Mining","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"f9uqHkqfZl"}],"identifier":"id-2-2-urban-data-mining","label":"2.2 Urban Data Mining","html_id":"id-2-2-urban-data-mining","implicit":true,"key":"cBOYzSpoeK"}],"key":"jjyIXiVuBZ"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Urban Data Mining, or the process of collecting and preparing data for analysis, consisted of two stages, which can be divided into manual collection and automated data preparation. The purpose of the manual stage was to collect data and convert it into tabular form, while the automated process was aimed to convert the tabular data into geospatial data.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"bI3k3qz8fZ"}],"key":"VMwwJQovQS"}],"key":"Jw9Z3UJFgD"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":1,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Manual Data Collection","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"GGyWbQCzG3"}],"identifier":"manual-data-collection","label":"Manual Data Collection","html_id":"manual-data-collection","implicit":true,"key":"SntLSBbpGN"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"The main task of manual data collection is searching purpose-built student accommodation and higher education universities in Berlin and collecting capacity and demand data, respectively.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Y3FkHnjTek"}],"key":"w5soWNwJ4v"}],"key":"wsnzbI2f1c"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Student Accommodation","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"zWeou17wwN"}],"identifier":"student-accommodation","label":"Student Accommodation","html_id":"student-accommodation","implicit":true,"key":"Ww7rdWsZz0"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"The Studentenwerk (StW, 2025) website was used as the initial source of data for the purpose of building student accommodation. StW is a public, non-profit organisation that provides essential services to students in Germany, including affordable housing, operating student dormitories in collaboration with universities. The StW website provides not only detailed information about addresses, prices, accommodation types, and living space in student accommodation, but also references to other publicly funded companies that provide social housing for students, such as Howoge, Gewobag, Berlinvo, and others. Data on the capacity of public student dormitories was collected from the Study in Germany website, which is supported by the Federal Ministry of Education and Research (BMBF, 2025) and is part of the ‘Germany – Land of Ideas’ campaign.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"oNCor658Fw"}],"key":"pGSn0smWbZ"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"The missing addresses of private companies were collected from online platforms of companies specialising in student housing and property rental in Berlin. While public companies publish data openly, private companies have less transparent policy, which limits the research process and complicates the manual data mining process.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"khlmto8Lva"}],"key":"PwR8lJzZdP"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"A complete list of online sources used for manual data collection on student accommodation is presented in Table XX.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"h9JZm0dvv0"}],"key":"CC2EAopIj6"}],"key":"QrgkyDTUj3"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"sp = r\"../inputs/2.2_urban_data_mining/urban_data_mining_sourses.xlsx\"\n\nsourses = pd.read_excel(sp)\nsourses[[\n    \"sourse\",\n    \"comment¹\",\n    \"link\",\n]].head(23)","visibility":"remove","key":"OPywHnZ2pZ"},{"type":"outputs","id":"_K3N9TjlJiRPuemAbyFtr","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":3,"metadata":{},"data":{"application/vnd.microsoft.datawrangler.viewer.v0+json":{"content":"{\"columns\":[{\"name\":\"index\",\"rawType\":\"int64\",\"type\":\"integer\"},{\"name\":\"sourse\",\"rawType\":\"object\",\"type\":\"string\"},{\"name\":\"comment¹\",\"rawType\":\"object\",\"type\":\"string\"},{\"name\":\"link\",\"rawType\":\"object\",\"type\":\"string\"}],\"ref\":\"3a87a023-4dcd-4af8-b3f8-26342b404736\",\"rows\":[[\"0\",\"Study in Germany \",\"An official informational platform aimed at international students who wish to study in Germany. It offers practical guidance on finding accommodation, budgeting for student life, and navigating housing markets. The initiative is supported by the Federal Ministry of Education and Research (BMBF) and is part of the \\\"Germany – Land of Ideas\\\" campaign, reflecting its credibility and public mission to promote higher education in Germany.\",\"https://www.study-in-germany.com/de/\"],[\"1\",\"HOWOGE Wohnungsbaugesellschaft mbH\",\"Municipal housing company with dedicated student apartment projects; includes location, amenities, and price.\",\"https://www.howoge.de/immobiliensuche/neubauprojekte\"],[\"2\",\"GESOBAU AG\",\"Public housing provider offering projects like GESOcampus. Info on construction, rent, and layout.\",\"https://www.gesobau.de/wohnungsbau/neubauprojekte\"],[\"3\",\"GEWOBAG\",\"New-build and modernized housing projects, some suitable for students.\",\"https://www.gewobag.de/\"],[\"4\",\"WBM\",\"Municipal housing firm offering apartments in central districts including student-suitable options.\",\"https://www.wbm.de/neubau-berlin/\"],[\"5\",\"Berlinovo\",\"Offers student apartments across Berlin. Filters for availability, price, and furnishing.\",\"https://www.berlinovo.de/de/apartments\"],[\"6\",\"BGG Berlin\",\"Private housing group with student-suitable apartment complexes in East Berlin.\",\"https://www.bgg-berlin.com/de\"],[\"7\",\"STW Berlin\",\"Official student dorm provider in Berlin; listings of all residences with application process, pricing, amenities.\",\"https://www.stw.berlin/en/\"],[\"8\",\"Studentendorf Berlin\",\"Community-oriented residences in Adlershof and Schlachtensee; shared flats and studios.\",\"https://www.studentendorf.berlin/\"],[\"9\",\"The FIZZ\",\"International student housing brand; premium housing with social and study spaces.\",\"https://www.the-fizz.com/en/\"],[\"10\",\"Neon Wood\",\"Private student housing provider; fully furnished, all-inclusive co-living apartments.\",\"https://neonwood.com/de/\"],[\"11\",\"Home in Berlin\",\"Central Berlin housing platform targeting students and internationals; multiple locations.\",\"https://home-in-berlin.de/\"],[\"12\",\"Insider Apartments\",\"Furnished rental apartments for students and professionals.\",\"https://insiderapartments.com/projects\"],[\"13\",\"Studentenhotel Hubertusallee\",\"Hotel-style short- and long-term housing option for students.\",\"https://studentenhotel-hubertusallee.hotel-in-berlin.org/de/#main\"],[\"14\",\"Studentenwohnheim\",\"External platform listing some Berlin student housing; basic contact info.\",\"http://www.studentenwohnheim.ch/berlin/\"],[\"15\",\"Felixx Student\",\"Premium student housing in Berlin-Charlottenburg.\",\"https://www.felixx-student.de/\"],[\"16\",\"Smartments Student\",\"Fully furnished student housing units in central Berlin.\",\"https://smartments-student.com/de/\"],[\"17\",\"MyGermanUniversity\",\"Informational site for international students in Germany. Includes guides and number of plases in publuic-dorms\",\"https://www.mygermanuniversity.com/\"],[\"18\",\"UniAcco\",\"Global student housing aggregator with listings in Berlin.\",\"https://uniacco.com/\"],[\"19\",\"The Social Hub\",\"Co-living and student-centered community with shared spaces, events, and workspace access.\",\"https://www.thesocialhub.co/\"],[\"20\",\"GLS Campus Berlin\",\"Language school campus with on-site student housing in Berlin Prenzlauer Berg.\",\"https://www.gls-campus-berlin.com/\"],[\"21\",\"Campo Novo Berlin\",\"Berlin location offers furnished apartments and amenities geared toward students.\",\"https://campo-novo-berlin.de/\"],[\"22\",\"STUK Berlin\",\"Student co-living platform with locations and shared housing for Berlin-based students.\",\"https://www.stuk.berlin/\"]],\"shape\":{\"columns\":3,\"rows\":23}}","content_type":"application/vnd.microsoft.datawrangler.viewer.v0+json"},"text/html":{"content":"<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>sourse</th>\n      <th>comment¹</th>\n      <th>link</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>Study in Germany</td>\n      <td>An official informational platform aimed at in...</td>\n      <td>https://www.study-in-germany.com/de/</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>HOWOGE Wohnungsbaugesellschaft mbH</td>\n      <td>Municipal housing company with dedicated stude...</td>\n      <td>https://www.howoge.de/immobiliensuche/neubaupr...</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>GESOBAU AG</td>\n      <td>Public housing provider offering projects like...</td>\n      <td>https://www.gesobau.de/wohnungsbau/neubauprojekte</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>GEWOBAG</td>\n      <td>New-build and modernized housing projects, som...</td>\n      <td>https://www.gewobag.de/</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>WBM</td>\n      <td>Municipal housing firm offering apartments in ...</td>\n      <td>https://www.wbm.de/neubau-berlin/</td>\n    </tr>\n    <tr>\n      <th>5</th>\n      <td>Berlinovo</td>\n      <td>Offers student apartments across Berlin. Filte...</td>\n      <td>https://www.berlinovo.de/de/apartments</td>\n    </tr>\n    <tr>\n      <th>6</th>\n      <td>BGG Berlin</td>\n      <td>Private housing group with student-suitable ap...</td>\n      <td>https://www.bgg-berlin.com/de</td>\n    </tr>\n    <tr>\n      <th>7</th>\n      <td>STW Berlin</td>\n      <td>Official student dorm provider in Berlin; list...</td>\n      <td>https://www.stw.berlin/en/</td>\n    </tr>\n    <tr>\n      <th>8</th>\n      <td>Studentendorf Berlin</td>\n      <td>Community-oriented residences in Adlershof and...</td>\n      <td>https://www.studentendorf.berlin/</td>\n    </tr>\n    <tr>\n      <th>9</th>\n      <td>The FIZZ</td>\n      <td>International student housing brand; premium h...</td>\n      <td>https://www.the-fizz.com/en/</td>\n    </tr>\n    <tr>\n      <th>10</th>\n      <td>Neon Wood</td>\n      <td>Private student housing provider; fully furnis...</td>\n      <td>https://neonwood.com/de/</td>\n    </tr>\n    <tr>\n      <th>11</th>\n      <td>Home in Berlin</td>\n      <td>Central Berlin housing platform targeting stud...</td>\n      <td>https://home-in-berlin.de/</td>\n    </tr>\n    <tr>\n      <th>12</th>\n      <td>Insider Apartments</td>\n      <td>Furnished rental apartments for students and p...</td>\n      <td>https://insiderapartments.com/projects</td>\n    </tr>\n    <tr>\n      <th>13</th>\n      <td>Studentenhotel Hubertusallee</td>\n      <td>Hotel-style short- and long-term housing optio...</td>\n      <td>https://studentenhotel-hubertusallee.hotel-in-...</td>\n    </tr>\n    <tr>\n      <th>14</th>\n      <td>Studentenwohnheim</td>\n      <td>External platform listing some Berlin student ...</td>\n      <td>http://www.studentenwohnheim.ch/berlin/</td>\n    </tr>\n    <tr>\n      <th>15</th>\n      <td>Felixx Student</td>\n      <td>Premium student housing in Berlin-Charlottenburg.</td>\n      <td>https://www.felixx-student.de/</td>\n    </tr>\n    <tr>\n      <th>16</th>\n      <td>Smartments Student</td>\n      <td>Fully furnished student housing units in centr...</td>\n      <td>https://smartments-student.com/de/</td>\n    </tr>\n    <tr>\n      <th>17</th>\n      <td>MyGermanUniversity</td>\n      <td>Informational site for international students ...</td>\n      <td>https://www.mygermanuniversity.com/</td>\n    </tr>\n    <tr>\n      <th>18</th>\n      <td>UniAcco</td>\n      <td>Global student housing aggregator with listing...</td>\n      <td>https://uniacco.com/</td>\n    </tr>\n    <tr>\n      <th>19</th>\n      <td>The Social Hub</td>\n      <td>Co-living and student-centered community with ...</td>\n      <td>https://www.thesocialhub.co/</td>\n    </tr>\n    <tr>\n      <th>20</th>\n      <td>GLS Campus Berlin</td>\n      <td>Language school campus with on-site student ho...</td>\n      <td>https://www.gls-campus-berlin.com/</td>\n    </tr>\n    <tr>\n      <th>21</th>\n      <td>Campo Novo Berlin</td>\n      <td>Berlin location offers furnished apartments an...</td>\n      <td>https://campo-novo-berlin.de/</td>\n    </tr>\n    <tr>\n      <th>22</th>\n      <td>STUK Berlin</td>\n      <td>Student co-living platform with locations and ...</td>\n      <td>https://www.stuk.berlin/</td>\n    </tr>\n  </tbody>\n</table>\n</div>","content_type":"text/html"},"text/plain":{"content":"                                sourse  \\\n0                    Study in Germany    \n1   HOWOGE Wohnungsbaugesellschaft mbH   \n2                           GESOBAU AG   \n3                              GEWOBAG   \n4                                  WBM   \n5                            Berlinovo   \n6                           BGG Berlin   \n7                           STW Berlin   \n8                 Studentendorf Berlin   \n9                             The FIZZ   \n10                           Neon Wood   \n11                      Home in Berlin   \n12                  Insider Apartments   \n13        Studentenhotel Hubertusallee   \n14                   Studentenwohnheim   \n15                      Felixx Student   \n16                  Smartments Student   \n17                  MyGermanUniversity   \n18                             UniAcco   \n19                      The Social Hub   \n20                   GLS Campus Berlin   \n21                   Campo Novo Berlin   \n22                         STUK Berlin   \n\n                                             comment¹  \\\n0   An official informational platform aimed at in...   \n1   Municipal housing company with dedicated stude...   \n2   Public housing provider offering projects like...   \n3   New-build and modernized housing projects, som...   \n4   Municipal housing firm offering apartments in ...   \n5   Offers student apartments across Berlin. Filte...   \n6   Private housing group with student-suitable ap...   \n7   Official student dorm provider in Berlin; list...   \n8   Community-oriented residences in Adlershof and...   \n9   International student housing brand; premium h...   \n10  Private student housing provider; fully furnis...   \n11  Central Berlin housing platform targeting stud...   \n12  Furnished rental apartments for students and p...   \n13  Hotel-style short- and long-term housing optio...   \n14  External platform listing some Berlin student ...   \n15  Premium student housing in Berlin-Charlottenburg.   \n16  Fully furnished student housing units in centr...   \n17  Informational site for international students ...   \n18  Global student housing aggregator with listing...   \n19  Co-living and student-centered community with ...   \n20  Language school campus with on-site student ho...   \n21  Berlin location offers furnished apartments an...   \n22  Student co-living platform with locations and ...   \n\n                                                 link  \n0                https://www.study-in-germany.com/de/  \n1   https://www.howoge.de/immobiliensuche/neubaupr...  \n2   https://www.gesobau.de/wohnungsbau/neubauprojekte  \n3                             https://www.gewobag.de/  \n4                   https://www.wbm.de/neubau-berlin/  \n5              https://www.berlinovo.de/de/apartments  \n6                       https://www.bgg-berlin.com/de  \n7                          https://www.stw.berlin/en/  \n8                   https://www.studentendorf.berlin/  \n9                        https://www.the-fizz.com/en/  \n10                           https://neonwood.com/de/  \n11                         https://home-in-berlin.de/  \n12             https://insiderapartments.com/projects  \n13  https://studentenhotel-hubertusallee.hotel-in-...  \n14            http://www.studentenwohnheim.ch/berlin/  \n15                     https://www.felixx-student.de/  \n16                 https://smartments-student.com/de/  \n17                https://www.mygermanuniversity.com/  \n18                               https://uniacco.com/  \n19                       https://www.thesocialhub.co/  \n20                 https://www.gls-campus-berlin.com/  \n21                      https://campo-novo-berlin.de/  \n22                           https://www.stuk.berlin/  ","content_type":"text/plain"}}},"children":[],"key":"TxJTs3LMNJ"}],"visibility":"show","key":"M6z0o6CxwP"}],"visibility":"show","key":"eQFGdEFLjx"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"emphasis","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Table XX. Manual Data Collection Sources for Student Accommodation","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"foMZCEOvPv"}],"key":"CPqYD7BC7G"}],"key":"Y4mmn88Mys"}],"key":"vpUHNzOqT1"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The address is a critical parameter for conducting spatial econometric analysis. However, many student accommodations have more than one building. For example, WH Spandauer Damm comprises five buildings located at Spandauer Damm 134–142 (Studierendenwerk Berlin, 2025). During manual data collection, one of the tasks was to collect unique addresses related to the student housing market in order to calculate centroids afterwards, during automated data preparetion.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"nxBaKBR36T"}],"key":"CWnIrgEoAQ"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"For student housing, the data collected included the address (","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"QOuHYYxOwb"},{"type":"inlineCode","value":"street","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"npKqoK16nQ"},{"type":"text","value":", ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"MVYc4M9hzq"},{"type":"inlineCode","value":"house_nummer","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"KGxj8AdfN1"},{"type":"text","value":", ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"XyMHr4ESLY"},{"type":"inlineCode","value":"plz","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"XyYwnAypLH"},{"type":"text","value":", ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"mys4UKJ6jk"},{"type":"inlineCode","value":"city","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"QHyxlF2sIs"},{"type":"text","value":"), the name of the building complex (","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"NekRuVFl8u"},{"type":"inlineCode","value":"name","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ccUxkmJPlQ"},{"type":"text","value":"), the ownership company name (","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"faG3wSVcek"},{"type":"inlineCode","value":"ownership","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"FAtuloUz7T"},{"type":"text","value":"), the ownership model (","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"LGxkY5V8zS"},{"type":"inlineCode","value":"ownership model","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"d2XIXAuaX8"},{"type":"text","value":"), number of residential units (","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"YjRFUuMov1"},{"type":"inlineCode","value":"!units","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"LqQIPV9EiV"},{"type":"text","value":"), their capacity (","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"o8UJtEUXuN"},{"type":"inlineCode","value":"!students","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"DsZZtGb6WI"},{"type":"text","value":") and type (","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"fIKz58RUOb"},{"type":"inlineCode","value":"units type","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"JWIdNJBHlf"},{"type":"text","value":"), maximum and minimum price (","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"gv29cjUaCP"},{"type":"inlineCode","value":"price_min","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"sTnu9t7pWb"},{"type":"text","value":", ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"CM3ZVaIKYw"},{"type":"inlineCode","value":"price_max","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"NJhXvsmA8v"},{"type":"text","value":"), maximum and minimum living space (","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"YDCNeMVcyR"},{"type":"inlineCode","value":"area_min","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"wqru6x8l5g"},{"type":"text","value":", ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"VtMbIhazpf"},{"type":"inlineCode","value":"area_max","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"MN1Dvvjlfv"},{"type":"text","value":"), link to the source (","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"L52c2st3su"},{"type":"inlineCode","value":"link","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"RwzM35TCUt"},{"type":"text","value":").","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ZSGSGCTbbu"}],"key":"iaWBXRipJo"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"As a result of manual data collection, data was collected on 94 proposed student accommodation buildings located at 171 unique addresses.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"vzXlTp4znL"}],"key":"FfnOgp6ZFl"}],"key":"EXOeWoTEJW"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"fp = r\"../inputs/2.2_urban_data_mining/input_pbsa.xlsx\"\n\npbsa = pd.read_excel(fp, sheet_name='SA', dtype={'street': str, 'house_nummer': str, 'plz': str})","key":"XNJjIFvysz"},{"type":"outputs","id":"zDJxuftqdyKeMTLufo1QC","children":[],"key":"ilbrZHFVCZ"}],"key":"dvVn72R3Ah"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"pbsa.info()","key":"Vrc7Uv5Gya"},{"type":"outputs","id":"E3-M_cxKd-92YdaKZni8_","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"<class 'pandas.core.frame.DataFrame'>\nRangeIndex: 171 entries, 0 to 170\nData columns (total 16 columns):\n #   Column           Non-Null Count  Dtype  \n---  ------           --------------  -----  \n 0   name             171 non-null    object \n 1   street           171 non-null    object \n 2   house_nummer     171 non-null    object \n 3   plz              171 non-null    object \n 4   city             171 non-null    object \n 5   model            171 non-null    object \n 6   ownership        171 non-null    object \n 7   ownership_model  171 non-null    object \n 8   !units           93 non-null     float64\n 9   !students        148 non-null    float64\n 10  units type       168 non-null    object \n 11  price_min        148 non-null    float64\n 12  price_max        96 non-null     float64\n 13  area_min         154 non-null    float64\n 14  area_max         144 non-null    float64\n 15  link             168 non-null    object \ndtypes: float64(6), object(10)\nmemory usage: 21.5+ KB\n"},"children":[],"key":"gbV3oIWhoF"}],"key":"FS2JEPeqJu"}],"key":"osB9Q2bCRG"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Higher Education Universities","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"GLhhfoTHov"}],"identifier":"higher-education-universities","label":"Higher Education Universities","html_id":"higher-education-universities","implicit":true,"key":"NEC7joLfJ1"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"In order to indicate Berlin’s student demand, it was necessary to collect data on all of Berlin’s higher education institutions and the number of students enrolled in them. Although the initial plan was to limit the search to public educational institutions only. Nevertheless during the data collection process it became evident that the list and statistics for private universities were also publicly available.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"PwffRLJsNQ"}],"key":"sgBmfXz9tx"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"The dataset provided by the Statistisches Bundesamt (DESTATIS, 2025) serves as the most comprehensive source, capturing detailed information on student enrollments, origin, and gender at public and private German higher education institutions. The data provided was so detailed that it included information about branches of Berlin universities in other regions of the country. For example, Media Design School Berlin also has a campus in Munich. These universities  were excluded from the statistics as they do not put pressure on the Berlin Student Housing Market.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"dMaurFqimi"}],"key":"dazVc9mBwj"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"After cleaning, the Higher Education Institution list from the Federal Statistical Office was double-checked with the official Berlin city directory of higher education institutions (Berlin City Portal, 2025) and the official registry maintained by the German Rectors’ Conference (Hochschul Kompass, 2025).","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"ZyqBRuiPuK"}],"key":"RzQiDGokEG"},{"type":"paragraph","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"A complete list of online sources used for manual data collection on higher education institutions is provided in Table XX.","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"U7utXdCDvo"}],"key":"Z64AJ84Hm8"}],"key":"fzFbb2JzjA"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"sourses[[\n    \"sourse\",\n    \"comment¹\",\n    \"link\",\n]].iloc[23:] ","key":"oHZwM6WOFQ"},{"type":"outputs","id":"N3L6o9sCJBfZBH1sfCvEy","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":4,"metadata":{},"data":{"application/vnd.microsoft.datawrangler.viewer.v0+json":{"content":"{\"columns\":[{\"name\":\"index\",\"rawType\":\"int64\",\"type\":\"integer\"},{\"name\":\"sourse\",\"rawType\":\"object\",\"type\":\"string\"},{\"name\":\"comment¹\",\"rawType\":\"object\",\"type\":\"string\"},{\"name\":\"link\",\"rawType\":\"object\",\"type\":\"string\"}],\"ref\":\"a9e54c9a-f27a-4ff8-b2f0-f6203d2a32e5\",\"rows\":[[\"23\",\"STW\",\"Official public map of university-related facilities, including student services and universites\",\"https://www.stw.berlin\"],[\"24\",\"Hochschul Kompass\",\"Official registry of higher education institutions in Germany. Provides names, locations, and types of universities; maintained by the German Rectors’ Conference\",\"https://www.hochschulkompass.de/hochschulen/hochschulsuche.html?tx_szhrksearch_pi1%5Bsearch%5D=1&tx_szhrksearch_pi1%5BQUICK%5D=1&tx_szhrksearch_pi1%5Bname%5D=Berlin&tx_szhrksearch_pi1%5Btraegerschaft%5D=\"],[\"25\",\"Berlin City Portal \",\"Official Berlin city directory of higher education institutions, including public and private universities and applied sciences institutions\",\"https://www.berlin.de/sen/wissenschaft/einrichtungen/hochschulen/\"],[\"26\",\"Federal Statistical Office of Germany (Destatis)\",\"Statistik der Studenten (Code: 21311-0002) is a comprehensive semester-based dataset provided by the Statistisches Bundesamt (DESTATIS), capturing detailed information on student enrollments at German higher education institutions.   It includes variables such as gender, nationality, study program and institution\",\"https://www.openstreetmap.org/#map=12/52.5141/13.3707\"]],\"shape\":{\"columns\":3,\"rows\":4}}","content_type":"application/vnd.microsoft.datawrangler.viewer.v0+json"},"text/html":{"content":"<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>sourse</th>\n      <th>comment¹</th>\n      <th>link</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>23</th>\n      <td>STW</td>\n      <td>Official public map of university-related faci...</td>\n      <td>https://www.stw.berlin</td>\n    </tr>\n    <tr>\n      <th>24</th>\n      <td>Hochschul Kompass</td>\n      <td>Official registry of higher education institut...</td>\n      <td>https://www.hochschulkompass.de/hochschulen/ho...</td>\n    </tr>\n    <tr>\n      <th>25</th>\n      <td>Berlin City Portal</td>\n      <td>Official Berlin city directory of higher educa...</td>\n      <td>https://www.berlin.de/sen/wissenschaft/einrich...</td>\n    </tr>\n    <tr>\n      <th>26</th>\n      <td>Federal Statistical Office of Germany (Destatis)</td>\n      <td>Statistik der Studenten (Code: 21311-0002) is ...</td>\n      <td>https://www.openstreetmap.org/#map=12/52.5141/...</td>\n    </tr>\n  </tbody>\n</table>\n</div>","content_type":"text/html"},"text/plain":{"content":"                                              sourse  \\\n23                                               STW   \n24                                 Hochschul Kompass   \n25                               Berlin City Portal    \n26  Federal Statistical Office of Germany (Destatis)   \n\n                                             comment¹  \\\n23  Official public map of university-related faci...   \n24  Official registry of higher education institut...   \n25  Official Berlin city directory of higher educa...   \n26  Statistik der Studenten (Code: 21311-0002) is ...   \n\n                                                 link  \n23                             https://www.stw.berlin  \n24  https://www.hochschulkompass.de/hochschulen/ho...  \n25  https://www.berlin.de/sen/wissenschaft/einrich...  \n26  https://www.openstreetmap.org/#map=12/52.5141/...  ","content_type":"text/plain"}}},"children":[],"key":"fuQXjgLKVF"}],"key":"EtHquLd96y"}],"key":"LF0Po894Sx"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"emphasis","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Table XX. Manual Data Collection Sources for Higher Education Universities","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"L0KNRe4wh4"}],"key":"k9BnNtLRya"}],"key":"kGRnqq3mR0"}],"key":"SCOERzAvVo"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"After secondary verification of the list of educational institutions, the next task was to collect unique addresses, as large universities have more than one campus. For example, Charité - Universitätsmedizin Berlin has four campuses in Berlin, which are located at a total of 41 unique addresses. The manual search for addresses was carried out using two services: Open Street Map and Google Maps.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Ocegry5rJ1"}],"key":"cbeqBthksT"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"For Higher Education Universities, the data collected included the code according to the Federal Statistical Office, the abbreviation (","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"IAFYNRyRXj"},{"type":"inlineCode","value":"abr","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"PJanz4W2UB"},{"type":"text","value":"), the name (","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"OFw5jAwThn"},{"type":"inlineCode","value":"name","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"yKEZHU4MOJ"},{"type":"text","value":") and the full name (","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Kcf7s1ad9h"},{"type":"inlineCode","value":"fname","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"JkhuCHWGaU"},{"type":"text","value":"), the address (","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"j3HQYdI5Mh"},{"type":"inlineCode","value":"adr","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"av2jSCrnEZ"},{"type":"text","value":"), the ownership model (","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"MUX75qYUsS"},{"type":"inlineCode","value":"own","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"QueRks3rDA"},{"type":"text","value":"), type of educational institution (","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"OqS3VPOXk9"},{"type":"inlineCode","value":"stud","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"avzl6BIWqT"},{"type":"text","value":"), number of German students (","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"MYmbMEhxjQ"},{"type":"inlineCode","value":"!s_de","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ZQ11FKrX9m"},{"type":"text","value":"), number of foreign students (","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"q8M0QGJJ9O"},{"type":"inlineCode","value":"!s_aus","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"u9byaUMtwG"},{"type":"text","value":") and total number of students (","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"yAFhwc6f9k"},{"type":"inlineCode","value":"!s_all","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"E7zX3rwcqZ"},{"type":"text","value":").","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"TNfGZzZ1i0"}],"key":"DzzmnHJ3HJ"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"As a result of manual data collection, data was collected on 70 higher education institutions in Berlin, located at 357 unique addresses.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"DVc3iifenJ"}],"key":"bgskO7Rrv3"}],"key":"tTbsojZSgl"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"op = r\"../inputs/2.2_urban_data_mining/input_uni.xlsx\"\n\nuni = pd.read_excel(op, sheet_name='Uni', dtype={'adr': str})","key":"qUsXzeob9W"},{"type":"outputs","id":"2lZFrKlRGMQ3E9UqRs7eD","children":[],"key":"A3y1W76QX6"}],"key":"cXW3gC8cR0"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"uni.info()","key":"V0KbcP5Dz0"},{"type":"outputs","id":"0nrBnp7CrZW69c551Tb-t","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"<class 'pandas.core.frame.DataFrame'>\nRangeIndex: 357 entries, 0 to 356\nData columns (total 11 columns):\n #   Column  Non-Null Count  Dtype  \n---  ------  --------------  -----  \n 0   code    357 non-null    object \n 1   abr     70 non-null     object \n 2   name    70 non-null     object \n 3   fname   70 non-null     object \n 4   adr     357 non-null    object \n 5   own     70 non-null     object \n 6   stud    71 non-null     object \n 7   !s_de   53 non-null     float64\n 8   !s_aus  52 non-null     float64\n 9   !s_all  54 non-null     float64\n 10  url     42 non-null     object \ndtypes: float64(3), object(8)\nmemory usage: 30.8+ KB\n"},"children":[],"key":"nvDjIYlSJ2"}],"key":"FHm2drZlPz"}],"key":"Tm1HJZjTye"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":1,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Automated Data Preparation","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"tsZ43FBPgv"}],"identifier":"automated-data-preparation","label":"Automated Data Preparation","html_id":"automated-data-preparation","implicit":true,"key":"HsZUjcNF1R"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"During Manual Data Collection, one of the biggest challenges of data-driven research - finding and selecting data - was successfully overcome.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"PbJutMGsre"},{"type":"break","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"L7Ot8wFpIX"},{"type":"text","value":"The next challenge within Urban Data Mining is data cleaning, formatting, and standartalising. Data preparation using the Python programming language not only allows you to identify errors in manual input data, but also automates problem-solving during data import, cleaning, and export, as well as during geocoding.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"hmfRbSUMKr"}],"key":"z8aVQxHwI8"}],"key":"zJNJIzzPcz"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Set Up","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"fmHuFxkIpY"}],"identifier":"set-up","label":"Set Up","html_id":"set-up","implicit":true,"key":"PpgIqjeBnx"}],"key":"czWctMFFl0"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Import Libraries","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"FzUJVryMsp"}],"key":"KZVNRygF5w"}],"key":"rwra8clCPr"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import pandas as pd \nimport numpy as np \nfrom tqdm import tqdm  \nimport geopandas as gpd \nfrom geopy.geocoders import Nominatim, Photon \nfrom geopy.extra.rate_limiter import RateLimiter \nimport matplotlib.pyplot as plt \nfrom matplotlib.colors import LinearSegmentedColormap \nfrom shapely.geometry import MultiPoint \nfrom sklearn.cluster import DBSCAN \nimport time  ","key":"iQkw1ZGr1U"},{"type":"outputs","id":"6abGsASFrwxDXm8aL-WlQ","children":[],"key":"RHOIE05sri"}],"key":"hbkWKTqbTh"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Scripts","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"a4RNL0ssHf"}],"key":"Wfg9iU8Jok"}],"key":"eycdWNetyG"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"In order to access spatial analysis and spatial economics methods and Tools, it is necessary to convert addresses to geographical coordinates, which consist of longitude and latitude. Geocoding converts addresses into geographical coordinates to be placed on a map.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"imbYJRHXhT"}],"key":"g04w6Wi39d"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Two services, Nominatim and Photon, were used for geocoding. Despite the use of several services, about 10% of addresses were not recognised or were misinterpreted, indicating errors in the manually collected data.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"iw4pPeK5T5"}],"key":"icKyWZm2ZX"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"To improve the accuracy of the coordinate search, the names of the city (Berlin) and country (Germany) were added to each address, which made it possible to uniquely identify objects in the German capital. In addition, to account for the particularities of the German language and possible spelling errors, an alternative spelling mechanism was implemented: special characters such as ‘ß’ were automatically replaced with ‘ss’, which increased the likelihood of successfully matching the address with the geographic database.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"DwdNZiaxLY"}],"key":"yIPjUz8byI"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Since the addresses for student accommodation and higher education universities were collected in different formats, two different scripts were also used for geocoding, which differed from each other in their query (","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"MoY4sF6CHI"},{"type":"inlineCode","value":"df[“query”]","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"M7svhDOUIR"},{"type":"text","value":"). At the same time, it would be advisable to avoid writing two scripts by collecting data on student accommodation and higher education universities in a single format (for example, ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"w04wy2yB6l"},{"type":"inlineCode","value":"df['query'] = df['street'] + ' ' + df['house_nummer'] + ', ' + df['plz'] + ', ' + df['city'] + ', Germany'","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"VDyKsMkw6o"},{"type":"text","value":").","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"T1VMy8uYAM"}],"key":"psOgMVGbtA"}],"key":"aTCQawe3kJ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def geocode_pbsa(df):\n    # Initialize geocoders\n    nom = RateLimiter(Nominatim(user_agent=\"berlin_housing\", timeout=10).geocode, \n                     min_delay_seconds=1)\n    photon = RateLimiter(Photon(user_agent=\"berlin_housing\", timeout=10).geocode,\n                        min_delay_seconds=0.5)\n    \n    # Create address strings\n    #df['query'] = df['adr'] + ', Germany'   \n    df['query'] = df['street'] + ' ' + df['house_nummer'] + ', ' + df['plz'] + ', ' + df['city'] + ', Germany'                 \n    df['query_alt'] = df['query'].str.replace('ß', 'ss')  # Alternative spelling\n    \n    # Geocoding function with retries\n    def geocode(address, geocoder, retries=2):\n        for _ in range(retries):\n            try:\n                loc = geocoder(address)\n                return (loc.latitude, loc.longitude) if loc else (None, None)\n            except:\n                time.sleep(1)\n        return (None, None)\n    \n    # Primary geocoding (Nominatim)\n    tqdm.pandas(desc=\"Primary geocoding\", disable=True)\n    df[['lat', 'lon']] = df['query'].progress_apply(\n        lambda x: pd.Series(geocode(x, nom))\n    )\n    \n    # Fallback (Photon for failed addresses)\n    missing = df[df['lat'].isna()]\n    if not missing.empty:\n        tqdm.pandas(desc=\"Fallback geocoding\", disable=True)\n        missing[['lat', 'lon']] = missing['query_alt'].progress_apply(\n            lambda x: pd.Series(geocode(x, photon)))\n        df.update(missing)\n    \n    # Convert to GeoDataFrame (Berlin CRS)\n    return gpd.GeoDataFrame(\n        df.drop(['query', 'query_alt'], axis=1, errors='ignore'),\n        geometry=gpd.points_from_xy(df['lon'], df['lat']),\n        crs=\"EPSG:4326\"\n    ).to_crs(\"EPSG:25833\")","key":"WackjBJOxT"},{"type":"outputs","id":"b6ZKhUCeZ7yzH4w7lq7Nz","children":[],"key":"Vy7pv15jWl"}],"key":"v7ac0MKk6U"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def geocode_uni(df):\n    # Initialize geocoders\n    nom = RateLimiter(Nominatim(user_agent=\"berlin_housing\", timeout=10).geocode, \n                     min_delay_seconds=1)\n    photon = RateLimiter(Photon(user_agent=\"berlin_housing\", timeout=10).geocode,\n                        min_delay_seconds=0.5)\n    \n    # Create address strings\n    df['query'] = df['adr'] + ', Germany'   \n    df['query_alt'] = df['query'].str.replace('ß', 'ss')  # Alternative spelling\n    \n    # Geocoding function with retries\n    def geocode(address, geocoder, retries=2):\n        for _ in range(retries):\n            try:\n                loc = geocoder(address)\n                return (loc.latitude, loc.longitude) if loc else (None, None)\n            except:\n                time.sleep(1)\n        return (None, None)\n    \n    # Primary geocoding (Nominatim)\n    tqdm.pandas(desc=\"Primary geocoding\", disable=True)\n    df[['lat', 'lon']] = df['query'].progress_apply(\n        lambda x: pd.Series(geocode(x, nom))\n    )\n    \n    # Fallback (Photon for failed addresses)\n    missing = df[df['lat'].isna()]\n    if not missing.empty:\n        tqdm.pandas(desc=\"Fallback geocoding\", disable=True)\n        missing[['lat', 'lon']] = missing['query_alt'].progress_apply(\n            lambda x: pd.Series(geocode(x, photon)))\n        df.update(missing)\n    \n    # Convert to GeoDataFrame (Berlin CRS)\n    return gpd.GeoDataFrame(\n        df.drop(['query', 'query_alt'], axis=1, errors='ignore'),\n        geometry=gpd.points_from_xy(df['lon'], df['lat']),\n        crs=\"EPSG:4326\"\n    ).to_crs(\"EPSG:25833\")","key":"FzFnpyE6HU"},{"type":"outputs","id":"twG8TKWt95CZZRen_euzW","children":[],"key":"EHeg1A4emC"}],"key":"aWk7R6zGzE"},{"type":"block","kind":"notebook-content","data":{"tags":[]},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Colors","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"CPPHokXxTg"}],"key":"DvALgmOcTe"}],"visibility":"remove","key":"gShwP1YgvW"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"color_palettes = {\n    \"Pi\": [\"#F8EDEB\", \"#FAE1DD\", \"#FCD5CE\", \"#FEC5BB\", \"#F8AD9D\", \"#F4978E\", \"#F08080\"],\n    \"Or\": [\"#FFE5D9\", \"#FFD7BA\", \"#FEC89A\", \"#FFB78F\", \"#F49F7D\", \"#F28B6D\"],\n    \"GrSc\":  [\"#434343\", \"#666666\", \"#999999\", \"#b7b7b7\", \"#cccccc\", \"#d9d9d9\", \"#efefef\", \"#f3f3f3\", \"#ffffff\"]\n}\n\ncmap_pi = LinearSegmentedColormap.from_list(\"Pi\", color_palettes[\"Pi\"])\ncmap_or = LinearSegmentedColormap.from_list(\"Or\", color_palettes[\"Or\"])\ncmap_grsc = LinearSegmentedColormap.from_list(\"GrSc\", color_palettes[\"GrSc\"])","visibility":"remove","key":"pLe2uue2gu"},{"type":"outputs","id":"dElROgDo6xtj18H2WGVIo","children":[],"visibility":"show","key":"rgGqF7Dt62"}],"visibility":"show","key":"n7941YVXah"},{"type":"block","kind":"notebook-content","data":{"tags":[]},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Font","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"rTgN8BqWV5"}],"key":"zmEnel6CIg"}],"visibility":"remove","key":"XAokkaIwgf"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"plt.rcParams[\"font.family\"] = \"Helvetica\"","visibility":"remove","key":"bAGCJwbC2A"},{"type":"outputs","id":"ItmKcwex1VY_WxCpPCs1k","children":[],"visibility":"show","key":"sMRBVcNfH0"}],"visibility":"show","key":"a6pfwYt9Qw"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Berlin Spatial Boundaries","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"pgKzO78g0I"}],"key":"pQN75fohbO"}],"key":"Xz32dnbHar"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"pf = r\"../inputs/2.2_urban_data_mining/lor_pgr.gpkg\"\npgr = gpd.read_file(pf)\npgr.replace({'-': np.nan, 0: np.nan, '': np.nan}, inplace=True)\n\nbf = r\"../inputs/2.2_urban_data_mining/adm_bz.gpkg\"\nbz = gpd.read_file(bf)\nbz.replace({'-': np.nan, 0: np.nan, '': np.nan}, inplace=True)\n\nof = r\"../inputs/2.2_urban_data_mining/adm_out.gpkg\"\nout = gpd.read_file(of)\nout.replace({'-': np.nan, 0: np.nan, '': np.nan}, inplace=True)","key":"smmiUdWxmp"},{"type":"outputs","id":"4p4o3p-tYYEebcP12-Dd0","children":[],"key":"eZwAjIDHlO"}],"key":"pyECjHsGGY"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Data Import","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"iwHtu7RF7d"}],"identifier":"data-import","label":"Data Import","html_id":"data-import","implicit":true,"key":"oHwX1Fjf8m"}],"key":"t8Wb8a3sHI"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The data obtained as a result of manual data collection served as input data for the automated stage.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"CtDHwDax3E"}],"key":"NZCcifwLah"}],"key":"zELeCFSHYK"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"fp = r\"../inputs/2.2_urban_data_mining/input_pbsa.xlsx\"\n\npbsa = pd.read_excel(fp, sheet_name='SA', dtype={'street': str, 'house_nummer': str, 'plz': str})\n\nop = r\"../inputs/2.2_urban_data_mining/input_uni.xlsx\"\n\nuni = pd.read_excel(op, sheet_name='Uni', dtype={'adr': str})","key":"pc0XWv0Whv"},{"type":"outputs","id":"8fHUjkPtwJNAXPDa1Rtp4","children":[],"key":"IhLhYXmXof"}],"key":"tUi9IXUMcl"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Geocoding","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"cB1ikNSHTb"}],"identifier":"geocoding","label":"Geocoding","html_id":"geocoding","implicit":true,"key":"Mb1u0dGTTR"}],"key":"ANFIfjEi2J"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"As part of the automated data preparation stage, the addresses of student accommodation and higher education institutions were geocoded to obtain accurate geographical coordinates for each unique address. The data was then converted into a geospatial format (GeoDataFrame) and reprojected into the official Berlin coordinate system (EPSG:25833).","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"nE09DjHec5"}],"key":"TTHkz1QhUC"}],"key":"vpcFH5brTu"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Student Accommodation","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"vLpDyRcVku"}],"key":"COLTsxdj6z"}],"key":"StiJX0lSso"}],"key":"bPFdIthnX4"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"pbsa = geocode_pbsa(pbsa)","visibility":"show","key":"RmdQq2wGgj"},{"type":"outputs","id":"ZC0--85UqOwE8rsgFO7yL","children":[],"visibility":"remove","key":"BKKIMzTtM9"}],"visibility":"show","key":"tlG2sHuvBn"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"pbsa.info()","key":"Di1FRtI0Dg"},{"type":"outputs","id":"eu3Jx-FfWC6TmC0E9C2xd","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"<class 'geopandas.geodataframe.GeoDataFrame'>\nRangeIndex: 171 entries, 0 to 170\nData columns (total 19 columns):\n #   Column           Non-Null Count  Dtype   \n---  ------           --------------  -----   \n 0   name             171 non-null    object  \n 1   street           171 non-null    object  \n 2   house_nummer     171 non-null    object  \n 3   plz              171 non-null    object  \n 4   city             171 non-null    object  \n 5   model            171 non-null    object  \n 6   ownership        171 non-null    object  \n 7   ownership_model  171 non-null    object  \n 8   !units           93 non-null     float64 \n 9   !students        148 non-null    float64 \n 10  units type       168 non-null    object  \n 11  price_min        148 non-null    float64 \n 12  price_max        96 non-null     float64 \n 13  area_min         154 non-null    float64 \n 14  area_max         144 non-null    float64 \n 15  link             168 non-null    object  \n 16  lat              171 non-null    float64 \n 17  lon              171 non-null    float64 \n 18  geometry         171 non-null    geometry\ndtypes: float64(8), geometry(1), object(10)\nmemory usage: 25.5+ KB\n"},"children":[],"key":"gk1WGnIJ9S"}],"key":"wBh1yr0o7m"}],"key":"OdvNHQHQdA"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Higher Education Universities","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"pqoog52oTo"}],"key":"lbaDqOVMs6"}],"key":"XHrltJqBGy"}],"key":"fbi01mVJRY"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"uni = geocode_uni(uni)","visibility":"show","key":"zaNKNARmXY"},{"type":"outputs","id":"WOxulsNzz31FXc9IQVK8U","children":[],"visibility":"remove","key":"qNKb9B71WN"}],"visibility":"show","key":"FnMFsGVVkO"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"uni_copy = uni.copy()","visibility":"show","key":"auEC20C8jg"},{"type":"outputs","id":"8AtitNqskXJWydZ31ZNWJ","children":[],"visibility":"show","key":"Vv4myRRMPm"}],"visibility":"remove","key":"DdGgajRELf"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"uni.info()","key":"ykD1p4Pey3"},{"type":"outputs","id":"z0T-oDS7gDgCp3u2Vx8Ol","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"<class 'geopandas.geodataframe.GeoDataFrame'>\nRangeIndex: 357 entries, 0 to 356\nData columns (total 14 columns):\n #   Column    Non-Null Count  Dtype   \n---  ------    --------------  -----   \n 0   code      357 non-null    object  \n 1   abr       70 non-null     object  \n 2   name      70 non-null     object  \n 3   fname     70 non-null     object  \n 4   adr       357 non-null    object  \n 5   own       70 non-null     object  \n 6   stud      71 non-null     object  \n 7   !s_de     53 non-null     float64 \n 8   !s_aus    52 non-null     float64 \n 9   !s_all    54 non-null     float64 \n 10  url       42 non-null     object  \n 11  lat       357 non-null    float64 \n 12  lon       357 non-null    float64 \n 13  geometry  357 non-null    geometry\ndtypes: float64(5), geometry(1), object(8)\nmemory usage: 39.2+ KB\n"},"children":[],"key":"W26VIEC4ZG"}],"key":"mS2hK8rUh5"}],"key":"XsGFYDtseF"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"This results in a shift from tabular data to geospatial data with a new attribute ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ZttY5K5Q3q"},{"type":"inlineCode","value":"geometry","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"sZPKBljYtd"},{"type":"text","value":".","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"RIzRx7OTwC"}],"key":"EuqhV1xUL9"}],"key":"yWSQcDWFK4"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Data Cleaning","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"QLd1uSFNTt"}],"identifier":"data-cleaning","label":"Data Cleaning","html_id":"data-cleaning","implicit":true,"key":"T6enMhrLw1"}],"key":"impM8z06rR"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Student Accommodation","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"LQAdOt1I6x"}],"key":"fV4pYn8nUG"}],"key":"KoE6DR1vym"}],"key":"YxNeuP7Qdt"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Student Housing capacity is calculated as a single capacity indicator (","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"H42SCEuJnD"},{"type":"inlineCode","value":"!cap","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"qnWIJ5uVBr"},{"type":"text","value":") according to the following rule: if the number of students living in student accommodation (","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"eztfv1FW9o"},{"type":"inlineCode","value":"students","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"DVwFVhXW9Q"},{"type":"text","value":") is known, it is taken; if not, the number of housing units (","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"EqR21dirOF"},{"type":"inlineCode","value":"units","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"aeEfReQSUC"},{"type":"text","value":") is taken, while purposed build student accommodation, where both values are unknown, is excluded.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"UmWk4BW6cJ"}],"key":"HXTVpdYVOD"}],"key":"m24RPMSe6j"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"pbsa['!cap'] = pbsa['!students'].where(\n    pbsa['!students'].notnull(),\n    pbsa['!units']\n)\n\npbsa = pbsa.dropna(subset=['!cap'])","key":"pyT2T1aGrf"},{"type":"outputs","id":"AejHvpj2bKugR8Vw6rBNq","children":[],"key":"a6L47szgP6"}],"key":"tZvVAAPBlm"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"After that, there is a transition from unique addresses to centroids or geographical centers (Figure XX), for which grouping by name is performed (","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"cNrfADlpho"},{"type":"inlineCode","value":"pbsa.groupby(“name”)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"pb50WdjPZO"},{"type":"text","value":"). Thus, student dormitories with more than one building are assigned a single point, and the capacity of all buildings is summed (","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"iltHsH4CMn"},{"type":"inlineCode","value":"!cap': “sum”","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"wq03vySJxZ"},{"type":"text","value":").","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"D2tmRYYvlB"}],"key":"kNrDQypAEc"}],"key":"zQHLVMs26N"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"pbsa_c = (\n    pbsa.groupby('name')\n    .agg({\n        'geometry': lambda x: MultiPoint([pt for pt in x]).centroid,\n        'plz': 'first',\n        'city': 'first',\n        'model': 'first',\n        'ownership': 'first',\n        'ownership_model': 'first',\n        '!cap': 'sum',\n        'units type': 'first',\n        'price_min': 'first',\n        'price_max': 'first',\n        'area_min': 'first',\n        'area_max': 'first',\n        'link': 'first'\n    })\n    .reset_index()\n)\n\npbsa_c = gpd.GeoDataFrame(pbsa_c, geometry='geometry', crs=pbsa.crs)","key":"uPqZx7gKIz"},{"type":"outputs","id":"hfPT7NGMJEM32w9rJv-Uz","children":[],"key":"GG7K7pI3L0"}],"key":"ZZEeLIPsRK"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"This results in a transition from 168 points to 88 centroids, which simplifies and speeds up further use of data in the data analysis.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"gWG12QGGgC"}],"key":"o6kv7Sk9nr"}],"key":"OV2KCFyMSt"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"fig, axs  = plt.subplots(1, 2, figsize=(36, 12))\n\npgr.plot(ax=axs[0], facecolor='none', edgecolor='#cccccc', linewidth=0.5, linestyle=\"--\")\nbz.plot(ax=axs[0], facecolor='none', edgecolor='#999999', linewidth=0.75)\nout.plot(ax=axs[0], facecolor='none', edgecolor='#666666', linewidth=1)\npbsa.plot(ax=axs[0],\n          column='!cap',\n          cmap=cmap_or,\n          markersize = 35,  # Scale marker size\n          alpha=0.9,\n          edgecolor='white',\n          linewidth=0.3,\n          legend=True,\n          legend_kwds={'shrink': 0.6, 'label': \"capacity\"},\n          vmin=0,\n          vmax=pbsa_c['!cap'].quantile(0.95))  # Cap extremes\naxs[0].set_title(f'a. Student Accommodation\\n({len(pbsa)} points)', fontsize=28, pad=15, fontweight='bold')\naxs[0].set_axis_off()\nplt.tight_layout()\n\npgr.plot(ax=axs[1], facecolor='none', edgecolor='#cccccc', linewidth=0.5, linestyle=\"--\")\nbz.plot(ax=axs[1], facecolor='none', edgecolor='#999999', linewidth=0.75)\nout.plot(ax=axs[1], facecolor='none', edgecolor='#666666', linewidth=1)\npbsa_c.plot(ax=axs[1],\n          column='!cap',\n          cmap=cmap_or,\n          markersize = 35,\n          alpha=0.9,\n          edgecolor='white',\n          linewidth=0.3,\n          legend=True,\n          legend_kwds={'shrink': 0.6, 'label': \"capacity\"},\n          vmin=0,\n          vmax=pbsa_c['!cap'].quantile(0.95)) # Matching Previous plott\naxs[1].set_title(f\"b. Student Accommodation Centroids\\n({len(pbsa_c)} points)\", fontsize=28, pad=15, fontweight='bold')\naxs[1].set_axis_off()\n\nsave_path = os.path.join(hf, \"Student Accommodation.png\")\nplt.savefig(save_path, dpi=300, bbox_inches=\"tight\")\n\nplt.tight_layout()\nplt.show()","visibility":"remove","key":"dwN5XAUE9l"},{"type":"outputs","id":"QhO5qZh9QTPSivCcyah8i","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"0ed34ab1d63d93fa135303bc37401bbd","path":"/rethinking_student_housing/build/0ed34ab1d63d93fa135303bc37401bbd.png"},"text/plain":{"content":"<Figure size 3600x1200 with 4 Axes>","content_type":"text/plain"}}},"children":[],"key":"W9uR46rueP"}],"visibility":"show","key":"VLz8nGh3IT"}],"visibility":"show","key":"wXwoowwK6Y"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"emphasis","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Figure XX. Visual Comparison Initial Unique Student Accommodation Addresses with Final Centroids","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"BpkheaKlZn"}],"key":"igI64PmDZf"}],"key":"usm3wBUmBy"}],"key":"ywkC4cvTjs"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"It should be noted that unique addresses were collected specifically for the correct calculation of centroids. Meanwhile, for student communities, the calculation of centroids is relatively simple due to the unique names for each community and the proximity of its buildings. For universities, however, the task is not so straightforward, as grouping by name will not give the desired result, since a university with the same name may be located in different parts of the city, for example, Humboldt-Universität, which has three campuses: Campus Mitte, Campus Adlershof, and Campus Nord.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"YYuwcgPrju"}],"key":"GJJakSskfq"}],"key":"jSy6EG8SKa"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Higher Education Universities","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Q5o9a0xIMP"}],"key":"gGcVu4epuN"}],"key":"MlElFImjZX"}],"key":"Nythw9uc8A"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Higher Education Universities’ demand for each educational institution is calculated as the number of international students enrolled in it. Universities for which there is no data on students are excluded.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"wQSsjLSnS0"}],"key":"D7xX5kwTPU"}],"key":"jSgqhtjHma"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"uni = uni.dropna(subset=['!s_all'])","key":"IysLBqlfQD"},{"type":"outputs","id":"ojoNpMgKM7jHsUn_8OOfy","children":[],"key":"oEFeRDj17U"}],"key":"imcVIfbhFq"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Afterwards, there is a transition from unique addresses to centroids (Figure XX). For this purpose, grouping by code (","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"WI5JMOpvbR"},{"type":"inlineCode","value":"uni[“code”]","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"mFUwyOScWh"},{"type":"text","value":") is performed, while demand indicators: the number of German students (","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"lNoqvJlj1o"},{"type":"inlineCode","value":"!s_de","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"JCo90oHfnv"},{"type":"text","value":"), the number of foreign students (","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"pHpiPGiu0v"},{"type":"inlineCode","value":"!s_aus","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"oKkRJp7XLM"},{"type":"text","value":") and the total number of students (","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Fsw45jVRmu"},{"type":"inlineCode","value":"!s_all","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"RtUBYXac8t"},{"type":"text","value":") are distributed evenly among unique addresses — buildings — with a single unique code (","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"PQdUuzB0wy"},{"type":"inlineCode","value":"for code in uni[“code”].unique()","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"SHHq2Zl6ZZ"},{"type":"text","value":"). This allows us to obtain an ‘average’ representation of the demand indicators for each individual building, while these data for different buildings are initially combined.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"aXTLP95G16"}],"key":"CCkMozNVPd"}],"key":"K5EWBkFqZw"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"copy_cols = ['abr', 'name', 'fname', 'own', 'stud', 'url']\nsplit_cols = ['!s_de', '!s_aus', '!s_all']\n\n# Loop over unique codes\nfor code in uni['code'].unique():\n    mask = uni['code'] == code\n    group = uni[mask]\n    \n    # Copy values from first row in group\n    for col in copy_cols:\n        uni.loc[mask, col] = group.iloc[0][col]\n    \n    # Distribute numeric values\n    for col in split_cols:\n        if pd.notnull(group.iloc[0][col]):\n            uni.loc[mask, col] = round(group.iloc[0][col] / len(group), 2)\n        else:\n            uni.loc[mask, col] = pd.NA","key":"grqVi29GrK"},{"type":"outputs","id":"24GHpm23_Xx5bIhKhi-aH","children":[],"key":"JjzRd1tecJ"}],"key":"INcqyfMzdl"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"To further transition from unique addresses to a single address for a complex of university buildings, the data were grouped based on a distance threshold. The threshold parameter was responsible for separating unique addresses belonging to the same university campus based on the spatial factor. The threshold value was obtained through multiple manual tests. At the same time, the demand values for each unique address were summed up.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"seMfPSTtda"}],"key":"TKXKPhnMCP"}],"key":"bSRkTqFond"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"distance_threshold = 650  # in meters\nrecords = []\n\nfor code, group in uni.groupby(\"code\"):\n    coords = np.array([(geom.x, geom.y) for geom in group.geometry])\n    if len(coords) == 0:\n        continue\n    # Cluster points that are close to each other\n    clustering = DBSCAN(eps=distance_threshold, min_samples=1).fit(coords)\n    group = group.copy()\n    group['cluster'] = clustering.labels_\n    for cluster_id, cluster_points in group.groupby('cluster'):\n        mp = MultiPoint(cluster_points.geometry.tolist())\n        # Prepare a record with all columns\n        record = cluster_points.iloc[0].to_dict()\n        record['geometry'] = mp.centroid\n        # Sum the specified columns\n        for col in ['!s_de', '!s_aus', '!s_all']:\n            record[col] = cluster_points[col].sum()\n        record['cluster'] = f\"{code}_{cluster_id+1}\"\n        records.append(record)\n\n# Create the GeoDataFrame\nuni_c = gpd.GeoDataFrame(records, geometry='geometry', crs=uni.crs)","key":"zLMM1Jl0Vq"},{"type":"outputs","id":"lw1i2XtRe4ooTnDeEnsad","children":[],"key":"WayIoImjWd"}],"key":"gPijZr72zK"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Thus, unique addresses for individual buildings were grouped not only by code but also by university campus affiliation. Next, geometric centers (centroids) were calculated for each group. This resulted in a transition from 357 points to 54 centroids.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"i5s1yZthGn"}],"key":"JkpRHB8FpB"}],"key":"WWeYRJVSmL"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"fig, axs  = plt.subplots(1, 2, figsize=(32, 12))\n\npgr.plot(ax=axs[0], facecolor='none', edgecolor='#cccccc', linewidth=0.5, linestyle=\"--\")\nbz.plot(ax=axs[0], facecolor='none', edgecolor='#999999', linewidth=0.75)\nout.plot(ax=axs[0], facecolor='none', edgecolor='#666666', linewidth=1)\nuni.plot(ax=axs[0],\n          column='!s_all',\n          cmap=cmap_pi,\n          markersize = 35,  # Scale marker size\n          alpha=0.9,\n          edgecolor='white',\n          linewidth=0.3,\n          legend=True,\n          legend_kwds={'shrink': 0.6, 'label': \"demand\"},\n          vmin=0,\n          vmax=uni_c['!s_all'].quantile(0.85))  # Cap extremes\naxs[0].set_title(f'a. Higher Education Universities\\n({len(uni_copy)} points)', fontsize=28, pad=15, fontweight='bold')\naxs[0].set_axis_off()\nplt.tight_layout()\n\npgr.plot(ax=axs[1], facecolor='none', edgecolor='#cccccc', linewidth=0.5, linestyle=\"--\")\nbz.plot(ax=axs[1], facecolor='none', edgecolor='#999999', linewidth=0.75)\nout.plot(ax=axs[1], facecolor='none', edgecolor='#666666', linewidth=1)\nuni_c.plot(ax=axs[1],\n          column='!s_all',\n          cmap=cmap_pi,\n          markersize = 35,\n          alpha=0.9,\n          edgecolor='white',\n          linewidth=0.3,\n          legend=True,\n          legend_kwds={'shrink': 0.6, 'label': \"demand\"},\n          vmin=0,\n          vmax=uni_c['!s_all'].quantile(0.85)) # Matching Previous plott\naxs[1].set_title(f\"b. Higher Education Universities Centroids\\n({len(uni_c)} points)\", fontsize=28, pad=15, fontweight='bold')\naxs[1].set_axis_off()\n\nsave_path = os.path.join(hf, \"Higher Education Universities.png\")\nplt.savefig(save_path, dpi=300, bbox_inches=\"tight\")\n\nplt.tight_layout()\nplt.show()","visibility":"remove","key":"t61QywUI8U"},{"type":"outputs","id":"4K5QD5QArd2lU3rG9UFIa","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"67b8908e33a617a4db50461fa7152c88","path":"/rethinking_student_housing/build/67b8908e33a617a4db50461fa7152c88.png"},"text/plain":{"content":"<Figure size 3200x1200 with 4 Axes>","content_type":"text/plain"}}},"children":[],"key":"zYCeTfTvFA"}],"visibility":"show","key":"rbvjGaxYBm"}],"visibility":"show","key":"YfnqVHiUuf"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"emphasis","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Figure XX. Visual Comparison Initial Unique Higher Education Universities Addresses with Final Centroids","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"PhCmG7K3LX"}],"key":"N3zaijPgkU"}],"key":"imR6fvuM8p"}],"key":"PPJrVBrSRe"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The verification method was a manual visual comparison of the final centroids with the original unique addresses in QGIS using the Measure Tool.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"BsQxrmkjlY"}],"key":"kqGUngjCcj"}],"key":"UbxnmkaYXJ"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Data Export","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"WLMxBvVZH9"}],"identifier":"data-export","label":"Data Export","html_id":"data-export","implicit":true,"key":"Bu6wRIor2d"}],"key":"sv6ihCVirk"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The processed data for analysing the capacity and demand for student housing is stored in geographic packages (","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"BnZUI9i3Xo"},{"type":"inlineCode","value":".gpkg","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"JsT4DJucXp"},{"type":"text","value":") — an open format for storing geospatial data, which differs from the tabular format (","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Ifpz1HD8RE"},{"type":"inlineCode","value":".exel","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"uHpxTzNhC9"},{"type":"text","value":") in that it contains coordinates.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"OiAlHkvTUy"}],"key":"kEUjTFjGmL"}],"key":"z2GscTxWJ3"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"ef = r\"../outputs/2.2_urban_data_mining/pbsa.gpkg\"\npbsa.to_file(ef, driver=\"GPKG\")\n\nef = r\"../outputs/2.2_urban_data_mining/pbsa_c.gpkg\"\npbsa_c.to_file(ef, driver=\"GPKG\")\n\nef = r\"../outputs/2.2_urban_data_mining/uni.gpkg\"\nuni_copy.to_file(ef, driver=\"GPKG\")\n\ncf = r\"../outputs/2.2_urban_data_mining/uni_c.gpkg\"\nuni_c.to_file(cf, driver=\"GPKG\")","key":"OVg5m7bGf1"},{"type":"outputs","id":"-bJrsxC3-3rhWRhUwBJPN","children":[],"key":"eL3OKQkwoI"}],"key":"QNogy08N7Y"}],"key":"k6EXeWlqyt"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"2.1 Overview","url":"/notebooks/overview","group":"2. Capacities, Demand & Spatial Distribution"},"next":{"title":"2.3 Descriptive Market Statistics","url":"/notebooks/descriptive-market-statistics","group":"2. Capacities, Demand & Spatial Distribution"}}},"domain":"http://localhost:3000"}