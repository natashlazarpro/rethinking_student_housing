{"version":"1","records":[{"hierarchy":{"lvl1":"To do"},"type":"lvl1","url":"/","position":0},{"hierarchy":{"lvl1":"To do"},"content":"This is a to do list before publication","type":"content","url":"/","position":1},{"hierarchy":{"lvl1":"To do","lvl3":"Fragen"},"type":"lvl3","url":"/#fragen","position":2},{"hierarchy":{"lvl1":"To do","lvl3":"Fragen"},"content":"! ask Andreas about prologing study in TUB to save the place in student Wohnweim !\n\nShould I explain all metodology in Persise? Or just interpretete the findings?\n\nHow to export this piece of art? When i export pdf is not right numeration and also soma tables dont fit the boundaties\n\nDo i need chapter with Gravity Modeling? NO","type":"content","url":"/#fragen","position":3},{"hierarchy":{"lvl1":"To do","lvl3":"general"},"type":"lvl3","url":"/#general","position":4},{"hierarchy":{"lvl1":"To do","lvl3":"general"},"content":"change the font of hole notebook (EV)\n\nMake a nice Table of Contencs (EV)\n\nTable XX. bla bla bla\n\nFigure XX. bla bla bla\n\nwork with inputs/output\n\nCheck all the statictics tables, do we gain insides from tables/statistics?\n\nnumerate the tables and figires, have a list of figures and list if tables\n\nsave figures to output\n\ncell tags\n\ndelete pior from every notebook since it not passing the test\n\nchange data paths  search for /Users/natashlaz/\n\nTODO: add 1.2, 3,4 , 5.6 to headings in every notobook in the end\n\nTODO: deside where is low case where is up case\n\nTODO: accomodation , capasity search - grammar check !!!!\n\nTODO: следелать компактные таблицы\n\nTODO: отследить импорт по главам чтобы без жестких переносов страницы на новую страницу\n\ncentral_places[[\n“code”,\n“abr”,\n“name”,\n“fname”,\n“own”,\n“cluster”,\n“!s_aus”\n]].to_markdown(index=False)\n\nTODO: wrap code so it fits the html layout\n\nTODO: давать ссылки на главы с номерами, проверить ссылки между главами","type":"content","url":"/#general","position":5},{"hierarchy":{"lvl1":"To do","lvl4":"calendar","lvl3":"general"},"type":"lvl4","url":"/#calendar","position":6},{"hierarchy":{"lvl1":"To do","lvl4":"calendar","lvl3":"general"},"content":"отправить вторую главу в качесве примера\n\ninstall something to chack gramatics in markdown - idelly withb translator and ect\n\npip everything to environment geodatascience2.0\n\nliterature review\n\ndissolve chapter 1 und 2 into separate notobooks\n\nhow chapter 3 shoud ends (maybe ask prof Suwala)\n\ndissolve chapter 3, clean the liraries in chapter 3\n\nclean the messs with notobook naming in 3, come up with new naming of files for notebooks\n\nwrite the code for and 3.5","type":"content","url":"/#calendar","position":7},{"hierarchy":{"lvl1":"To do","lvl2":"Suwala"},"type":"lvl2","url":"/#suwala","position":8},{"hierarchy":{"lvl1":"To do","lvl2":"Suwala"},"content":"are students interested in living near university\n\ndo individual market areas proovide evidence of it ?\nlink to behavioral study ?do we need to plan student pbsa near university\n\ndo berlin need uNI Campuses ?\n\nGRAVIATION CORRISODS\nISOCHRONIC TABLES\n\nGRAVITATIONAL ISOHRONES\nIF IT POSSIBLE TO INCLUDE THE PUBLIC TRANSPORTATION IN GRAVITY CORRIDOS\n\nJUSTIFICATION OF methodology","type":"content","url":"/#suwala","position":9},{"hierarchy":{"lvl1":"0.2 Table of Contents"},"type":"lvl1","url":"/markdowns/table-of-contens","position":0},{"hierarchy":{"lvl1":"0.2 Table of Contents"},"content":"","type":"content","url":"/markdowns/table-of-contens","position":1},{"hierarchy":{"lvl1":"0.2 Table of Contents","lvl2":"0. Prelimitary Pages"},"type":"lvl2","url":"/markdowns/table-of-contens#id-0-prelimitary-pages","position":2},{"hierarchy":{"lvl1":"0.2 Table of Contents","lvl2":"0. Prelimitary Pages"},"content":"0.1 Title Page\n\n0.2 Table Of Contens\n\n0.3 List Of Figures\n\n0.4 List Of Tables","type":"content","url":"/markdowns/table-of-contens#id-0-prelimitary-pages","position":3},{"hierarchy":{"lvl1":"0.2 Table of Contents","lvl2":"1. Introduction"},"type":"lvl2","url":"/markdowns/table-of-contens#id-1-introduction","position":4},{"hierarchy":{"lvl1":"0.2 Table of Contents","lvl2":"1. Introduction"},"content":"1.1 European Student Accommodation Crisis\n\n1.2 Berlin Housing Crisis History\n\n1.3 Theoretical Framework\n\n1.4 Rethinking Student Housing","type":"content","url":"/markdowns/table-of-contens#id-1-introduction","position":5},{"hierarchy":{"lvl1":"0.2 Table of Contents","lvl2":"2. Capacities, Demand & Spatial Distribution"},"type":"lvl2","url":"/markdowns/table-of-contens#id-2-capacities-demand-spatial-distribution","position":6},{"hierarchy":{"lvl1":"0.2 Table of Contents","lvl2":"2. Capacities, Demand & Spatial Distribution"},"content":"2.1 Overview\n\n2.2 Urban Data Mining\n\n2.3 Descriptive Market Statistics\n\n2.4 Global Spatial Autocorrelation","type":"content","url":"/markdowns/table-of-contens#id-2-capacities-demand-spatial-distribution","position":7},{"hierarchy":{"lvl1":"0.2 Table of Contents","lvl2":"3. Student Housing Market Imbalance"},"type":"lvl2","url":"/markdowns/table-of-contens#id-3-student-housing-market-imbalance","position":8},{"hierarchy":{"lvl1":"0.2 Table of Contents","lvl2":"3. Student Housing Market Imbalance"},"content":"3.1 Overview\n\n3.2 Central Place Analysis\n\n3.3 Market Pressure Analysis","type":"content","url":"/markdowns/table-of-contens#id-3-student-housing-market-imbalance","position":9},{"hierarchy":{"lvl1":"0.2 Table of Contents","lvl2":"4. Students Behind the Numbers"},"type":"lvl2","url":"/markdowns/table-of-contens#id-4-students-behind-the-numbers","position":10},{"hierarchy":{"lvl1":"0.2 Table of Contents","lvl2":"4. Students Behind the Numbers"},"content":"4.1 Overview\n\n4.2 Students Needs And Preferences\n\n4.3 Students Experiences","type":"content","url":"/markdowns/table-of-contens#id-4-students-behind-the-numbers","position":11},{"hierarchy":{"lvl1":"0.2 Table of Contents","lvl2":"5. Data-Driven Decisions"},"type":"lvl2","url":"/markdowns/table-of-contens#id-5-data-driven-decisions","position":12},{"hierarchy":{"lvl1":"0.2 Table of Contents","lvl2":"5. Data-Driven Decisions"},"content":"5.1 Conclusion\n\n5.2 Reflection\n\n5.3 Future Research","type":"content","url":"/markdowns/table-of-contens#id-5-data-driven-decisions","position":13},{"hierarchy":{"lvl1":"0.2 Table of Contents","lvl2":"6. Appendix"},"type":"lvl2","url":"/markdowns/table-of-contens#id-6-appendix","position":14},{"hierarchy":{"lvl1":"0.2 Table of Contents","lvl2":"6. Appendix"},"content":"6.1 References\n\nXx Materials And Data\n\nXx Behavioral Study\n\nXx Color Palettes","type":"content","url":"/markdowns/table-of-contens#id-6-appendix","position":15},{"hierarchy":{"lvl1":"0.1 Title Page"},"type":"lvl1","url":"/notebooks/title-page","position":0},{"hierarchy":{"lvl1":"0.1 Title Page"},"content":"","type":"content","url":"/notebooks/title-page","position":1},{"hierarchy":{"lvl1":"0.1 Title Page","lvl2":"Technical University of Berlin"},"type":"lvl2","url":"/notebooks/title-page#technical-university-of-berlin","position":2},{"hierarchy":{"lvl1":"0.1 Title Page","lvl2":"Technical University of Berlin"},"content":"","type":"content","url":"/notebooks/title-page#technical-university-of-berlin","position":3},{"hierarchy":{"lvl1":"0.1 Title Page","lvl3":"Rethinking Student Housing in Berlin: Data‑Driven Approach","lvl2":"Technical University of Berlin"},"type":"lvl3","url":"/notebooks/title-page#rethinking-student-housing-in-berlin-data-driven-approach","position":4},{"hierarchy":{"lvl1":"0.1 Title Page","lvl3":"Rethinking Student Housing in Berlin: Data‑Driven Approach","lvl2":"Technical University of Berlin"},"content":"Author:         Nataliia LazarevaSupervisors:    Prof. Dr. Lech SuwalaDr. Ing. Andreas Brück","type":"content","url":"/notebooks/title-page#rethinking-student-housing-in-berlin-data-driven-approach","position":5},{"hierarchy":{"lvl1":"0.1 Title Page","lvl4":"Abstract","lvl3":"Rethinking Student Housing in Berlin: Data‑Driven Approach","lvl2":"Technical University of Berlin"},"type":"lvl4","url":"/notebooks/title-page#abstract","position":6},{"hierarchy":{"lvl1":"0.1 Title Page","lvl4":"Abstract","lvl3":"Rethinking Student Housing in Berlin: Data‑Driven Approach","lvl2":"Technical University of Berlin"},"content":"Placeholder text is often used in design to indicate where content will eventually be placed. It serves as a visual guide for designers and developers, enabling them to lay out pages and adjust typography, spacing, and color schemes before the final content is inserted. An example of filler text is provided below for the purpose of demonstrating layout elements in a generic layout scenario. This filler content is intentionally devoid of specific meaning, meaning it contains no hidden or actionable messages, and is instead built from commonly used words and phrases to provide a textured baseline for creative exploration. It can also aid in streamlining editorial workflows, especially when translation or localization teams must preview how copy will appear in a finished design. Typical placeholder narratives may include references to common design practices, UI components, grammar conventions, and visual hierarchy principles all brought together in a fluid tone <h3 align=\"center\"> Master Thesis </h3>      \n\nMaster Thesis\n\n2026","type":"content","url":"/notebooks/title-page#abstract","position":7},{"hierarchy":{"lvl1":"0.3 List of Figures"},"type":"lvl1","url":"/notebooks/list-of-figures","position":0},{"hierarchy":{"lvl1":"0.3 List of Figures"},"content":"Figure\n\nTitle\n\nPage\n\nXX\n\nPublication Year Time Series\n\n1\n\nXX\n\nPublication Type Distribution\n\n1\n\nXX\n\nMethod of Study Distribution\n\n1\n\nXX\n\nData Source Distribution\n\n1\n\nXX\n\nSpatial Distribution of Case Studies Across Europe\n\n1\n\nXX\n\nSpatial Distribution of Case Studies Across Germany\n\n1\n\nXX\n\nTime Overlay Network Visualisation\n\n1\n\nXX\n\nVisual Comparison Initial Unique Student Accommodation Addresses with Final Centroids\n\n1\n\nXX\n\nVisual Comparison Initial Unique Higher Education Universities Addresses with Final Centroids\n\n1\n\nXX\n\nStudent Accommodation Capacity Distribution\n\n1\n\nXX\n\nStudent Accommodation Capacity Normal Distribution Histogram\n\n1\n\nXX\n\nStudent Accommodation Price Distribution\n\n1\n\nXX\n\nStudent Accommodation Living Area Distribution\n\n1\n\nXX\n\nStudent Accommodation Capacity Distribution by Ownership Model\n\n1\n\nXX\n\nAccommodation Spatial Distribution by Ownership Model\n\n1\n\nXX\n\nState and Private Owned Student Accommodation Normal Capacity Distribution Comparison\n\n1\n\nXX\n\nHigher Education Universities Students Demand Normal Distribution Histogram\n\n1\n\nXX\n\nHigher Education Universities Demand Distribution by Ownership Model\n\n1\n\nXX\n\nHigher Education Universities Spatial Distribution by Ownership Model\n\n1\n\nXX\n\nPublic and Private Owned Higher Education Universities International Student Demand Distribution Comparison\n\n1\n\nXX\n\nStudent Accommodation Capacity Moran’s I Scatterplots for Different Number of Neighbours (k)\n\n1\n\nXX\n\nStudent Accommodation Capacity Moran’s I index and P-value for Different Number of Neighbours (k)\n\n1\n\nXX\n\nStages of Preparing Student Accommodation Capacity Data\n\n1\n\nXX\n\nStudent Accommodation Capacity Moran Scatterplot\n\n1\n\nXX\n\nStudent Accommodation Capacity Clusters in Berlin\n\n1\n\nXX\n\nHigher Education Universities International Students Demand Moran’s I Scatterplots for Different Number of Neighbours (k)\n\n1\n\nXX\n\nHigher Education Universities International Students Demand Moran’s I index and P-value for Different Number of Neighbours (k)\n\n1\n\nXX\n\nStages of Preparing Higher Education Universities International Students Demand Data\n\n1\n\nXX\n\nHigher Education Universities International Students Demand Moran Scatterplot\n\n1\n\nXX\n\nHigher Education Universities International Demand Dispersion in Berlin\n\n1\n\nXX\n\nTravel-Time API Test\n\n1\n\nXX\n\nMarket Areas Demand-Capacity Coverage by Travel Time\n\n1\n\nXX\n\nMarket Areas Capacity Demand Balance\n\n1\n\nXX\n\nPrimary Central Places\n\n1\n\nXX\n\nSecondary Central Places\n\n1\n\nXX\n\nTertiary Central Places\n\n1\n\nXX\n\nLocal Central Places\n\n1\n\nXX\n\nBasic Service Area\n\n1\n\nXX\n\nMarket Areas Demand Capacity Pressure Rank\n\n1\n\nXX\n\nMarket Areas Local Demand Capacity Pressure\n\n1\n\nXX\n\nStudent Accommodation Demand Capacity Pressure ?\n\n1\n\nXX\n\nStudent Status Distribution\n\n1\n\nXX\n\nAge Distribution\n\n1\n\nXX\n\nOrigin Distribution\n\n1\n\nXX\n\nHousing Model Distribution\n\n1\n\nXX\n\nSources of Financing Distribution\n\n1\n\nXX\n\nCorrelation Between Housing Needs and Preferences\n\n1\n\nXX\n\nStudent Needs and Preferences by Origin\n\n1\n\nXX\n\nStress Levels During Housing Search\n\n1\n\nXX\n\nStress Levels During Housing Search by Origin\n\n1\n\nXX\n\nSearching Time Distribution\n\n1\n\nXX\n\nLong Term Agreement Distribution\n\n1\n\nXX\n\nDiscrimination Factors Distribution\n\n1","type":"content","url":"/notebooks/list-of-figures","position":1},{"hierarchy":{"lvl1":"0.4 List of Tables"},"type":"lvl1","url":"/notebooks/list-of-tables","position":0},{"hierarchy":{"lvl1":"0.4 List of Tables"},"content":"Table\n\nTitle\n\nPage\n\nXX\n\nLiterature Review Cities\n\n1\n\nXX\n\nManual Data Collection Sources for Student Accommodation\n\n1\n\nXX\n\nManual Data Collection Sources for Higher Education Universities\n\n1\n\nXX\n\nStudent Accommodation Numeric Fields Summary\n\n1\n\nXX\n\nKey Student Accommodation Ownership Companies\n\n1\n\nXX\n\nStudent Accommodation Ownership Model Numeric Fields Summary\n\n1\n\nXX\n\nHigher Education Universities Numeric Fields Summary\n\n1\n\nXX\n\nHigher Education Universities Ownership Model Numeric Fields Summary\n\n1\n\nXX\n\nStudent Accommodation Capacity Moran’s I index and P-value for Different Number of Neighbors (k)\n\n1\n\nXX\n\nHigher Education Universities International Students Demand Moran’s I index and P-value for Different Number of Neighbors (k)\n\n1\n\nXX\n\nCentral Higher Education Universities.\n\n1\n\nXX\n\nTravel Time Summary Statistics\n\n1\n\nXX\n\nMarket Areas\n\n1\n\nXX\n\nCentrality Central Place Metrics\n\n1\n\nXX\n\nService Range Adequacy Central Place Metrics\n\n1\n\nXX\n\nHierarchy Rank Central Place Metrics\n\n1\n\nXX\n\nPrimary Central Places\n\n1\n\nXX\n\nSecondary Central Places\n\n1\n\nXX\n\nTertiary Central Places\n\n1\n\nXX\n\nLocal Central Places\n\n1\n\nXX\n\nBasic Service Areas\n\n1\n\nXX\n\nLess Pressured Student Accommodations ?\n\n1\n\nXX\n\nMost Pressured Student Accommodations ?\n\n1\n\nXX\n\nStudent Needs and Preferences by Origin\n\n1","type":"content","url":"/notebooks/list-of-tables","position":1},{"hierarchy":{"lvl1":"1.1 European Student Accommodation Crisis"},"type":"lvl1","url":"/notebooks/european-student-accommodation-crisis","position":0},{"hierarchy":{"lvl1":"1.1 European Student Accommodation Crisis"},"content":"import warnings\n\nwarnings.filterwarnings(\"ignore\")\n\nimport os\nhf = r'../outputs/1.1_european_student_accommodation_crisis/'\nos.makedirs(hf, exist_ok=True)\n\n\n\nResearch aimed to explore the topic, identifying major trends, challenges, and research gaps, in order to form scientific objectives and relevance of research for Berlin Case Study.\n\n","type":"content","url":"/notebooks/european-student-accommodation-crisis","position":1},{"hierarchy":{"lvl1":"1.1 European Student Accommodation Crisis"},"type":"lvl1","url":"/notebooks/european-student-accommodation-crisis#id-1-1-european-student-accommodation-crisis","position":2},{"hierarchy":{"lvl1":"1.1 European Student Accommodation Crisis"},"content":"\n\nIn order to better understand the current state of research on European Student Accommodation Crisis topic, a comprehensive literature research was conducted. Research aimed to explore the topic, identifying major trends, challenges, and research gaps, in order to form scientific objectives and relevance of research for Berlin Case Study.\n\nType of Literature Research: Bibliographical Mapping\n\nTools: Zotero, Python, VOSviewer\n\nTopic: European Student Accommodation Crisis\n\nPeriod of the search: 2010-2025\n\nArea of search: European Union\n\nAcademic Database: Scopus, Emerald, Google Scholar, TU Berlin Library\n\nLanguage: English\n\n","type":"content","url":"/notebooks/european-student-accommodation-crisis#id-1-1-european-student-accommodation-crisis","position":3},{"hierarchy":{"lvl1":"1.1 European Student Accommodation Crisis","lvl2":"Literature Review Type"},"type":"lvl2","url":"/notebooks/european-student-accommodation-crisis#literature-review-type","position":4},{"hierarchy":{"lvl1":"1.1 European Student Accommodation Crisis","lvl2":"Literature Review Type"},"content":"Bibliometric analysis is defined as “a part of scientometrics for utilising mathematical and statistical methods to analyse scientific activities in a research field” (Louarn et al., 2025). Thus, bibliographical mapping can be seen as a structured, data-driven approach for organising exciting knowledge regarding the selected topic. It can be applied to vast interdisciplinary literature, developing structured networks determined by keywords, co-citations, bibliometrics coupling, and direct citation analysis. This kind of approach matches with the overall aim to introduce innovative and structured analytical methods in urban design research. The methodology followed in review type comprises four stages: data collection, eligibility analysis, general descriptive and content analysis. (Louarn et al., 2025).\n\n","type":"content","url":"/notebooks/european-student-accommodation-crisis#literature-review-type","position":5},{"hierarchy":{"lvl1":"1.1 European Student Accommodation Crisis","lvl2":"Limitations"},"type":"lvl2","url":"/notebooks/european-student-accommodation-crisis#limitations","position":6},{"hierarchy":{"lvl1":"1.1 European Student Accommodation Crisis","lvl2":"Limitations"},"content":"In the bibliometric analyses, certain limitations were set, which should be taken into account when interpreting the results. Firstly, document type was limited to ‘journal article’ and ‘book section’ to avoid the double-collecting of similar research papers. However, during the collecting process ‘reports’ were added as a grey literature sources. Secondly, the search was limited to articles written in English. Thirdly, the search area was initially limited to Germany, which was considered an especially narrow approach. Subsequently, the search area was extended to the European Union, which provided a more comprehensive view of the problem. Last but not least, the period of search was limited to 2010-2025 years, during which the governmental student accommodation availability rate in Germany was no more than 10% (Student Housing in Germany Statistical Overview, 2023). Those limitations assist in focusing on research that is immediately connected with the Student Housing Crisis in Berlin and retain only relevant information.\n\n","type":"content","url":"/notebooks/european-student-accommodation-crisis#limitations","position":7},{"hierarchy":{"lvl1":"1.1 European Student Accommodation Crisis","lvl2":"Set Up"},"type":"lvl2","url":"/notebooks/european-student-accommodation-crisis#set-up","position":8},{"hierarchy":{"lvl1":"1.1 European Student Accommodation Crisis","lvl2":"Set Up"},"content":"\n\nImport Libraries\n\nimport json\nimport pandas as pd\nimport geopandas as gpd\nimport matplotlib.pyplot as plt\nimport numpy as np\nfrom shapely.geometry import Point\n\n\n\nColors\n\ncolors = [\"#FAE1DD\", \"#FCD5CE\", \"#FEC5BB\", \"#F8AD9D\", \"#F4978E\", \"#F08080\"]\n\n\n\nFont\n\nplt.rcParams[\"font.family\"] = \"Helvetica\"\n\n\n\n","type":"content","url":"/notebooks/european-student-accommodation-crisis#set-up","position":9},{"hierarchy":{"lvl1":"1.1 European Student Accommodation Crisis","lvl2":"Data Mining"},"type":"lvl2","url":"/notebooks/european-student-accommodation-crisis#data-mining","position":10},{"hierarchy":{"lvl1":"1.1 European Student Accommodation Crisis","lvl2":"Data Mining"},"content":"The literature collection was conducted in June 2025 using three academic databases: Scopus, Emerald, Google Scholar and TU Berlin Library as a grey literature source. The search terms was organised in five preliminary clusters:\n\nStudent Housing Market Terms: student housing OR student accommodation OR dormitory OR Wohnheim OR affordable housing\n\nPolicy: housing crisis OR rental market OR real estate investment OR financialization of housing\n\nUrban Design Terms: urban displacement OR studentification OR gentrification OR social housing OR urban periphery\n\nGeographic Terms: Berlin OR Germany OR EU OR European Union\n\nDemographic Terms: international students OR Erasmus students OR student mobility\n\nThe search resulted in a total of 50 articles from the four data sources, which serve as an initial orientation and provide a conceptual foundation for European Student Accommodation Crisis topic.\n\nfile_path = '../inputs/1.1_european_student_accommodation_crisis/literature_review_list.json'\n\n# Load the JSON data\nwith open(file_path) as file:\n    data = json.load(file)\n\n# Extract items (journal articles and attachments) from the JSON\nitems = data.get('items', [])\n\n# Convert the items into a DataFrame\ndf = pd.json_normalize(items)\n\n\n\ncolumns_to_drop = ['version', 'language', 'libraryCatalog', 'accessDate', 'callNumber', 'shortTitle', 'publisher', 'ISBN', 'edition', 'institution', 'bookTitle', 'place', 'numPages', 'series', 'seriesNumber', 'seriesTitle', 'issue', 'dateAdded', 'dateModified', 'uri', 'attachments', 'notes', 'citationKey', 'itemID', 'itemKey', 'libraryID', 'select', 'abstractNote' ]\n\n# Drop the columns (inplace=True modifies the original DataFrame)\ndf.drop(columns=columns_to_drop, inplace=True)\n\n\n\ndf = df.rename(columns={\n    'archiveLocation': 'study_area',\n    'rights': 'data_source', \n    'extra': 'method_of_study'\n})\n\ndf['itemType'] = df['itemType'].replace({\n    'bookSection': 'book section',\n    'journalArticle': 'journal article',\n    'book': 'book section',\n})\n\ndf['method_of_study'] = df['method_of_study'].replace({\n    'quantitative study': 'Quantitative Study',\n    'qualitative study': 'Qualitative Study',\n    'mixed-methods study': 'Mixed-Methods Study'\n})\n\n\n\n","type":"content","url":"/notebooks/european-student-accommodation-crisis#data-mining","position":11},{"hierarchy":{"lvl1":"1.1 European Student Accommodation Crisis","lvl2":"General Descriptive Analysis"},"type":"lvl2","url":"/notebooks/european-student-accommodation-crisis#general-descriptive-analysis","position":12},{"hierarchy":{"lvl1":"1.1 European Student Accommodation Crisis","lvl2":"General Descriptive Analysis"},"content":"\n\nTime Series\n\nThe Study Period (2010-2025) has seen steady growth in publication trends (Figure XX). Between 2012 and 2021, the average annual number of publications was 2. In comparison, between 2021 and 2025 average publications number of per ear was 4 times higher - approximately 8 publications per year. In 2024, the number of annual publications was eight times as many as those published in 2014. The regular growth in the number of publications could be explained by the increasing acknowledgment of the importance of student housing crisis. Moreover, the number of articles related to student housing market regulations increased over the past 5 years. This could be seen as a part of the solution to the student housing crisis. Thus, providing new approaches to student housing, regulating the market, and recognising the right of students to social housing be taken into account in forming a theoretical framework.\n\n# Convert the 'date' column to datetime\ndf['date'] = pd.to_datetime(df['date'], errors='coerce')  # 'coerce' will set invalid dates to NaT\n\n# Set 'date' as the index\ndf.set_index('date', inplace=True)\n\n# Sort by the date index\ndf = df.sort_index()\n\npublication_counts = df.resample('Y').size() \n\n\n\nfig, ax = plt.subplots(figsize=(14, 7)) \nplt.plot(publication_counts.index, publication_counts.values, marker='o', linestyle='-', color=(255/255, 181/255, 167/255), label='publications')\n\n# Add a main trend line\nz = np.polyfit(range(len(publication_counts)), publication_counts.values, 1)\np = np.poly1d(z)\nplt.plot(publication_counts.index, p(range(len(publication_counts))), linestyle='--', color='gray', label='trend')\n\n# Labels and title\nplt.xlabel(\"publication year\")\nplt.ylabel(\"number of publications\")\nplt.title(\"Publication Year Time Series\", fontsize=14, pad=15, fontweight='bold')\nplt.grid(True, color='#cccccc', linestyle='--', alpha=0.5)\n\n# Set x-axis labels from 2012 to 2025\nplt.xticks(pd.date_range(start='2012', end='2026', freq='Y'), [str(year) for year in range(2012, 2026)])\n\n# Add legend\nplt.legend(loc='upper left', frameon=False)\n\nsave_path = os.path.join(hf, \"Publication Year Time Series.png\")\nplt.savefig(save_path, dpi=300, bbox_inches=\"tight\")\n\nplt.show()\n\n\n\nFigure XX. Publication Year Time Series\n\nPublication Type Distribution\n\nPublication Type analysis depicts the dominance of peer-reviewed journal articles (74%) and book chapters (16%) with the strong academic foundation of the research field on student housing market and urban design. In contrast, the reports (10%), representing grey literature, offer valuable insights from policy institutions and housing organisations. Although non-academic, these sources provide empirical evidence and real-world perspectives that bridge the gap between theory and practice. The combination of academic and grey literature thus ensures a balanced and multidimensional understanding of the student housing crisis, where data-driven analysis is informed both by academic research and applied policy contexts.\n\nimport matplotlib.pyplot as plt\nimport numpy as np\n\n# Sample data (replace with your actual data)\nvalue_counts = df['itemType'].value_counts().sort_values(ascending=True)  # Sort by decreasing value counts\ntotal = value_counts.sum() \n\n# Plot the horizontal bar chart\nfig, ax = plt.subplots(figsize=(12, 6)) \nbars = plt.barh(value_counts.index,\n                value_counts.values,\n                color=colors[:len(value_counts)])\n\n# Add 15 % breathing room to the right of the longest bar\nplt.xlim(0, value_counts.max() * 1.15)\n\n# Set custom x-axis labels (0, 5, 10, 15, 20)\nx_ticks = np.arange(0, 40.5, 5)  # Generate ticks from 0 to 20 with step 5\nplt.xticks(x_ticks)\n\n# Annotate bars\nfor bar, value in zip(bars, value_counts.values):\n    pct = 100 * value / total\n    # Count to the right of the bar\n    plt.text(bar.get_width() + value_counts.max() * 0.02,  # A little to the right of the bar\n             bar.get_y() + bar.get_height() / 2,          # Center of the bar\n             f\"[{value}]\",\n             ha='left', va='center', fontsize=10, color='black')\n    # Percentage inside the bar\n    plt.text(bar.get_width() / 2,  # Inside the bar\n             bar.get_y() + bar.get_height() / 2,\n             f\"{pct:.1f}%\",\n             ha='center', va='center', fontsize=10, color='black')\n\n# Add title and labels\ntitle = \"Publication Type Distribution\"\nplt.title(title, fontsize=14, pad=15, weight='bold')\nplt.xlabel(\"number of articles\")\nplt.ylabel(\"publication type\")\n\nsave_path = os.path.join(hf, \"Publication Type Distribution.png\")\nplt.savefig(save_path, dpi=300, bbox_inches=\"tight\")\n\n# Display the plot\nplt.tight_layout()\nplt.show()\n\n\n\nFigure XX. Publication Type Distribution\n\nMethod of Study Distribution\n\nMethods of Study (Figure XX) refer to the techniques and tools used in research to collect, analyse, and interpret data. Such methods can be broadly categorised into qualitative, quantitative, and mixed-method approaches. Qualitative study methods (29.2%) have a strong emphasis on understanding the social dynamics and subjective experiences, highlighting topics such as cultural diversity, moving abroad, and community living. Quantitative studies (33.3%) indicate a desire for evidence-based insights related to housing costs, student satisfaction, or demographic trends. However, the majority of studies are using mixed-method approaches with an emphasis on understanding the social processes within the data-driven framework. Thus, merging qualitative methods with quantitative ones is the most relevant approach to acsess the Student Hosing Crisis topic.\n\nvalue_counts = df['method_of_study'].value_counts()\ntotal = value_counts.sum()\n\nlabels = ['mixed-methods study', 'quantitative study', 'qualitative study']\n\ndef make_autopct(values):\n    def my_autopct(pct):\n        count = int(round(pct * total / 100.0))\n        return f\"{pct:.1f}%\\n[{count}]\"\n    return my_autopct\n\n# Create pie chart\nfig, ax = plt.subplots(figsize=(8, 8)) \npatches, texts, autotexts = plt.pie(\n    value_counts,\n    labels=labels,\n    colors=colors[:len(value_counts)],\n    autopct=make_autopct(value_counts),\n    startangle=90\n)\n\n# Equal aspect ratio ensures pie is drawn as circle\nplt.axis('equal')\n\nplt.title(\"Method of Study Distribution\",  fontsize=14, fontweight='bold')\n\nsave_path = os.path.join(hf, \"Method of Study Distribution.png\")\nplt.savefig(save_path, dpi=300, bbox_inches=\"tight\")\n\nplt.tight_layout()\nplt.show()\n\n\n\nFigure XX. Method of Study Distribution\n\nData Source Distribution\n\nDuring the data sourse distribution analysis (Figure XX), four primary data source categories were identified: numerical data (30.3%), social data (27.5%), literature review (25.7%), and other data (16.5%). The balance between four categories reflects the interdisciplinary nature of the Student Crisis topic. Statistics, institutional records, market data provide measurable insights into housing, while social data (surveys, interviews, case studies, street observations) capture students’ lived experiences and perceptions. The strong representation of literature sources ensures theoretical grounding in urban design, economics and sociology.\n\n# Normalize the 'Data Source Distribution' column using get_dummies\nnormalized_data = df['data_source'].str.get_dummies(sep=', ')\n\n# Ensure all required columns are present (even if they don't exist in the data)\ncategories = ['literature review', 'social data', 'numerical data', 'other data']\nfor category in categories:\n    if category not in normalized_data.columns:\n        normalized_data[category] = 0  # Add missing columns with default value 0\n\n# Concatenate the normalized data with the original DataFrame\ndf = pd.concat([df, normalized_data[categories]], axis=1)\n\nsource_distribution = df[['literature review', 'social data', 'numerical data', 'other data']].sum()\n\nlabels = ['literature review', 'social data', 'numerical data', 'other data']\n\ndef make_autopct(values):\n    def my_autopct(pct):\n        count = int(round(pct * total / 100.0))\n        return f\"{pct:.1f}%\\n[{count}]\"\n    return my_autopct\n\n# Create pie chart\nfig, ax = plt.subplots(figsize=(8, 8)) \npatches, texts, autotexts = plt.pie(\n    source_distribution,\n    labels=labels,\n    colors=colors[:len(source_distribution)],\n    autopct=make_autopct(source_distribution),\n    startangle=90\n)\n\n# Equal aspect ratio ensures pie is drawn as circle\nplt.axis('equal')\n\nplt.title(\"Data Source Distribution\", fontsize=14, weight='bold')\n\nsave_path = os.path.join(hf, \"Data Source Distribution.png\")\nplt.savefig(save_path, dpi=300, bbox_inches=\"tight\")\n\n# Display the plot\nplt.tight_layout()\nplt.show()\n\n\n\nFigure XX. Data Source Distribution\n\nStudies Areas\n\nIn selected literature, 46 cities were mentioned as case studies (Table XX). The most frequently mentioned cities are Berlin, Hamburg, Stockholm and Vienna, all of which have populations of over 1.5 million. This can be explained by the fact that the more people live in a city, the easier it is to obtain a representative sample for social research. Large cities also tend to have more open statistics and data.\n\ndata = [\n    \"Berlin\", \"Berlin\", \"Berlin, Hamburg, Stuttgart, Stockholm\", \"EU\", \"Ghana\", \"Lombardy, Sicily\",\n    \"Berlin, Tehran, Sydney, Louvain La Neuve\", \"Berlin, London\", \"Berlin\", \"Berlin\",\n    \"Berlin, Prague, Stockholm, Amsterdam\", \"Berlin, New York\", \"Vienna\", \"NaN\", \"EU\",\n    \"Berlin, Hamburg, Stockholm, Gothenburg\", \"EU\", \"Berlin, Brandenburg\", \"EU\", \"EU\",\n    \"Berlin\", \"Groningen, Rottleberode\", \"Berlin, Vienna\", \"Barcelona, Paris, Montréal, Beja\",\n    \"Berlin, Podsdam, Brandenburg\", \"EU\", \"Berlin\", \"Aachen\", \"Goettingen\",\n    \"Berlin, Munich, Hamburg, Stuttgart, Hanover, Wiesbaden, Saarbrücken\", \"Berlin\", \"EU\",\n    \"Moscow, Berlin\", \"Berlin, Munich, Hamburg, Oldenburg, Bremen\", \"Hanover, Brighton, Phoenix\",\n    \"UK\", \"Berlin, Barcelona, Vienna\", \"Groningen\", \"Berlin\", \"Aachen\",\n    \"Berlin, Dresden, Leipzig, Rostock, Magdeburg, Trier, Frankfurt Munich, Hamburg, Cologne, Düsseldorf, Stuttgart\",\n    \"Berlin, Hamburg\", \"Konstanz\", \"Berlin, Como, Newcastle upon Tyne\"\n]\n\n# Combine all text into a single string and split into individual cities\ncities = [city.strip() for location in data for city in str(location).split(',')]\n\n# Remove 'EU' and 'UK' and convert to lowercase (optional)\ncities = [city for city in cities if city not in ['EU', 'UK']]\n\n# Count unique cities\ncity_counts = pd.Series(cities).value_counts().reset_index()\ncity_counts.columns = ['city_name', 'count']\n\n# Add longitude and latitude for each city (in EPSG:25833 CRS)\ncity_coords = {\n    'Berlin': (13.404954, 52.520008),\n    'Hamburg': (9.993682, 53.551086),\n    'Stuttgart': (9.164927, 48.779349),\n    'Stockholm': (18.068581, 59.329323),\n    'Ghana': (-0.186964, 5.794722),\n    'Lombardy': (9.845243, 45.586711),\n    'Sicily': (13.726664, 37.599669),\n    'Tehran': (51.387832, 35.689198),\n    'Sydney': (151.209344, -33.917347),\n    'Louvain La Neuve': (4.617157, 50.669791),\n    'London': (-0.127758, 51.507351),\n    'Prague': (14.437800, 50.075538),\n    'Amsterdam': (4.904139, 52.367573),\n    'New York': (-74.005974, 40.714268),\n    'Vienna': (16.373819, 48.208174),\n    'Gothenburg': (11.974560, 57.708874),\n    'Brandenburg': (13.406675, 52.411068),\n    'Groningen': (6.566502, 53.219383),\n    'Rottleberode': (10.937416, 51.516919),\n    'Barcelona': (2.158990, 41.385064),\n    'Paris': (2.352222, 48.856614),\n    'Montréal': (-73.567256, 45.501689),\n    'Beja': (-7.843390, 38.018283),\n    'Podsdam': (13.058500, 52.401499),\n    'Aachen': (6.083887, 50.775346),\n    'Goettingen': (9.932258, 51.533461),\n    'Munich': (11.581981, 48.135125),\n    'Hanover': (9.732010, 52.375892),\n    'Wiesbaden': (8.242082, 50.078218),\n    'Saarbrücken': (6.996932, 49.240157),\n    'Moscow': (37.617300, 55.755826),\n    'Oldenburg': (8.213511, 53.142368),\n    'Bremen': (8.801694, 53.079296),\n    'Brighton': (-0.137163, 50.822529),\n    'Phoenix': (-112.074036, 33.448376),\n    'Konstanz': (9.177020, 47.663743),\n    'Como': (9.083333, 45.809098),\n    'Newcastle upon Tyne': (-1.617780, 54.978252),\n    'Dresden': (13.737262, 51.050409),\n    'Leipzig': (12.373075, 51.339695),\n    'Rostock': (12.134415, 54.092440),\n    'Magdeburg': (11.626562, 52.131589),\n    'Trier': (6.633333, 49.750000),\n    'Frankfurt': (8.682127, 50.110924),\n    'Cologne': (6.960279, 50.937531),\n    'Düsseldorf': (6.773456, 51.227741),\n    'Stuttgart': (9.180013, 48.785079)\n}\n\n# Add coordinates to the DataFrame\ncity_counts['longitude'] = city_counts['city_name'].map(lambda x: city_coords.get(x, (None, None))[0])\ncity_counts['latitude'] = city_counts['city_name'].map(lambda x: city_coords.get(x, (None, None))[1])\n\n# Remove cities with no coordinates (optional)\ncity_counts = city_counts.dropna(subset=['longitude', 'latitude'])\n\n# Create Point geometry\ncity_counts['geometry'] = city_counts.apply(lambda row: Point(row['longitude'], row['latitude']), axis=1)\n\n# Convert to GeoDataFrame\ncity = gpd.GeoDataFrame(city_counts, crs='EPSG:4326')  # Convert to EPSG:4326 first\ncity = city.to_crs('EPSG:25833')  # Reproject to EPSG:25833\n\n\n\ncity.head(4)\n\n\n\nTable XX. Literature Review Cities\n\n# Define output directory\nod = r'../outputs/1.1_european_student_accommodation_crisis/city.gpkg'\n\ncity.to_file(od, driver=\"GPKG\")  \n\n\n\nSpatial Distribution of Case Studies (Figure XX) shows geographical origin of the academic and empirical datasets used in the literature, highlighting that topic of European Student Accommodation Crisis is researched mainly in Western Europe (e.g., Germany, Austria, Netherlands) and Northern Europe (e.g., the UK, Scandinavia), while East Europe (e.g., Poland, Slovakia, Hungary) remains relatively under-researched. It is important to note that, since geographic search terms include “Germany”, the highest data density correlates with the frequency of mentions of Germany in search terms.\n\nIn the context of the student housing crisis, Germany serves not only as a subject of analysis, but also as a model for comparative European studies. For example, Berlin is compared with Vienna (Holm, Andrej et al., 2024), Prague, Stockholm, and Amsterdam (Wijburg and Aalbers, 2017), as well as other German cities such as Munich, Hamburg, Stuttgart, Hanover, Wiesbaden, and Saarbrücken (Mitze et al., 2015).\n\n\n\nFigure XX. Spatial Distribution of Case Studies Across Europe\n\nThis spatial distribution of Case Studies across Germany (Figure XX) underlines that Berlin’s housing challenge is embedded in broader German dynamics of socio-economic crisis. By choosing Berlin as a case study, research will not only analyse local challenges, but also contributes to the German discourse on urban housing justice.\n\n\n\nFigure XX. Spatial Distribution of Case Studies Across Germany\n\nKey Words Analysis\n\nNetwork analysis, created using VOSviewer, visualises the bibliographic relationships between recurring keywords in the student housing literature from 2010 to 2025. The central cluster — formed by searching keyswords student housing, students, housing and Germany — anchors the field. Peripheral nodes such as gentrification, financialisation, studentification, displacment show the expanding theoretical dimensions. In the same time social dimensions represented by international students, discrimination, student needs, affordable housing, keywords, highlighting the importance of students experience. Last but not least, student market represented by urban housing policy, strategy, rent, housing prices, rent control, subsidised housing keywords, emphasising that student housing is a trade objective.\n\nThe colour gradient indicates the temporal evolution of the literature: earlier studies (2010–2015) focused on affordability and social equity, while more recent works (2020–2025) increasingly address financialisation, rent control, urban mobility and housing satisfaction in relation to international students.\n\n\n\nFigure XX. Time Overlay Network Visualisation\n\nBibliographic mapping demonstrates that the research area has evolved from descriptive housing studies toward data-driven, policy-oriented analyses. It situates your work within an emerging scholarly effort to link spatial analytics, social data, and governance in tackling urban housing challenges.\n\n","type":"content","url":"/notebooks/european-student-accommodation-crisis#general-descriptive-analysis","position":13},{"hierarchy":{"lvl1":"1.1 European Student Accommodation Crisis","lvl2":"Trends"},"type":"lvl2","url":"/notebooks/european-student-accommodation-crisis#trends","position":14},{"hierarchy":{"lvl1":"1.1 European Student Accommodation Crisis","lvl2":"Trends"},"content":"Contemporary literature agrees that the housing affordability crisis in Europe is linked not only to demographic growth, but also to the financialisation of the housing sector and the declining role of the public sector.\n\nIn the case of Germany, it has been shown conclusively that, despite the myth of a ‘stable, non-financialised’ market, the country has followed its own path of financialisation through the privatisation of social housing and the growth of listed real estate investment trusts (Wijburg & Aalbers, 2017). The authors describe three waves of financialisation: from the failed liberalisation of housing loans to the mass transfer of municipal housing stock to private equity funds and the subsequent concentration of stock in the hands of large privat corporations (Vonovia, Deutsche Wohnen, etc.) (Wijburg & Aalbers, 2017). As a result, the German market has become the next frontline for global investment.\n\nThese trends are particularly noticeable in Berlin. According to the IBB Wohnungsmarktbericht 2024, the average cold rent offered in the city in 2024 reached EUR 15/m2, which is more than double the comparative rent according to Mietspiegel (EUR 7.21/m2) and represents a gap of around 118% — the largest among major German cities (Investitionsbank Berlin, 2024). At the same time, the rate of new housing construction is falling behind population growth, and the shortage is particularly severe in central areas.\n\nIn this context, students, young adults and migrants are the least protected. Student halls of residence cover only about 8% of students in Germany (Deutsches Studierendenwerk, 2024). European-wide data shows that one in four students spends more than 40% of their budget on housing (EUROSTUDENT, 2024).\n\nThus, international students are most vulnerable to the housing crisis: they are being pushed out of central areas, concentrated in the most marginal segments of the market (shared flats with 6-8 people per room, short-term contracts, illegal or semi-legal rentals) and have a disproportionately high rental burden.\n\n","type":"content","url":"/notebooks/european-student-accommodation-crisis#trends","position":15},{"hierarchy":{"lvl1":"1.1 European Student Accommodation Crisis","lvl2":"Challenges"},"type":"lvl2","url":"/notebooks/european-student-accommodation-crisis#challenges","position":16},{"hierarchy":{"lvl1":"1.1 European Student Accommodation Crisis","lvl2":"Challenges"},"content":"Despite notable progress, the literature faces a number of limitations.\n\nFirst, there is a lack of data and weak integration of sources. Many studies rely on local or one-off cases (Miessner, 2021; von Wittenhorst zu Sonsfeld & Beusker, 2024). Nationwide and Europe-wide studies (EUROSTUDENT, 2024) provide a valuable overview (e.g., the proportion of students spending >40% of their budget on housing), but rarely differentiate data by type of housing (dormitories vs. WGs vs. private rentals) and status (international vs. local students).\n\nSecondly, a significant portion of the studies provide qualitative assessments without quantitative verification. For example, the housing affordability crisis is described through an array of questionnaire complaints and narratives (stress, fraud, language barriers), but is rarely accompanied by spatial modelling or econometric estimates of the impact on mobility participation. Even where quantitative analysis is available, patterns are not always systematised. Miessner (2021) and Avogo et al. (2022) identify important behavioural patterns (private landlords’ focus on students), but do not link them to urban structure or patterns of student housing distribution.\n\nFinally, most studies highlight the role of private actors (investors, landlords, platforms), but provide much less analysis of how the state and universities reproduce or moderate inequality through their decisions.\n\n","type":"content","url":"/notebooks/european-student-accommodation-crisis#challenges","position":17},{"hierarchy":{"lvl1":"1.1 European Student Accommodation Crisis","lvl2":"Gaps"},"type":"lvl2","url":"/notebooks/european-student-accommodation-crisis#gaps","position":18},{"hierarchy":{"lvl1":"1.1 European Student Accommodation Crisis","lvl2":"Gaps"},"content":"Based on the literature reviewed, several key gaps can be identified:\n\nLack of a comprehensive approach to universities and student housing.\nUniversities and Studentenwerke (student unions) are often viewed merely as background players (providers of dormitories) rather than active actors in the housing field. For example, the IBB report analyses the Berlin market in detail, but hardly highlights universities as a separate policy area (Investitionsbank Berlin, 2024).\n\nInsufficient consideration of the role of the public sector in the current housing crisis for students and migrants. Although some authors emphasise that the abandonment of housing subsidies and the privatisation of municipal housing were key triggers of the crisis (Wijburg & Aalbers, 2017), there are still few studies that directly link the reduction in student accommodation/state programmes with the increased vulnerability of the student group in particular. Paradoxically, even in the discussion of social commons (Stoll, 2022), student housing is hardly mentioned, although logically it is a classic candidate for public ownership and democratic governance.\n\nMost studies are either macro-level (national/European surveys) or micro-cases of individual student cities and campuses. There are no studies that systematically examine the spatial distribution of student and migrant housing in large cities (e.g., Berlin) at the planning district level.\n\nThese gaps justify the need for research that examines student housing in conjunction with university structures and urban housing policy, uses spatial analysis (at the city and district level), and assesses how different management models (state/municipal, university, private, cooperative) affect the daily lives of students in different ways.","type":"content","url":"/notebooks/european-student-accommodation-crisis#gaps","position":19},{"hierarchy":{"lvl1":"1.2 Berlin Housing Crisis History"},"type":"lvl1","url":"/notebooks/berlin-housing-crisis-history","position":0},{"hierarchy":{"lvl1":"1.2 Berlin Housing Crisis History"},"content":"The history of housing in Berlin is a story of constant crisis and adaptation. Throughout its history, the city has undergone a series of cycles of destruction, reconstruction and transformation. This chapter tells the recent history of Berlin from the post-war period to the present day.","type":"content","url":"/notebooks/berlin-housing-crisis-history","position":1},{"hierarchy":{"lvl1":"1.2 Berlin Housing Crisis History","lvl2":"1945-1989. Post-World War II Developments"},"type":"lvl2","url":"/notebooks/berlin-housing-crisis-history#id-1945-1989-post-world-war-ii-developments","position":2},{"hierarchy":{"lvl1":"1.2 Berlin Housing Crisis History","lvl2":"1945-1989. Post-World War II Developments"},"content":"When World War II ended, Berlin was heavily damaged and destroyed. All political parties perceived the housing shortage as the most pressing problem of the time and supported state investment into housing and strong regulation of the market. In this respect, estates built under socialism in East Berlin and under capitalism in West Berlin share many commonalities, despite the political differences of their respective regimes during the division (1949–1990) and particularly during the times of the Berlin Wall (1961–1989)(Urban, 2018). During this period, the authorities in East and West Berlin viewed housing construction as a key instrument of social policy.\n\nWest Berlin HousingIn the West, most multifamily buildings—both small and large estates—were built by state-sponsored institutions, owned by municipalities or sometimes other public bodies such as trade unions (Urban, 2018). Between 1952 and 1970, over 85% of new housing construction was publicly subsidized, and frequently constructed by state-owned housing companies operating under the principle of common public interest (Fields & Uffer, 2016)\n\nInterventionist housing policy, which funneled large amounts of public disproportionate funding into housing, was set up in the early 1950s, and at the time approved by the West German Federal Government, ultimately aimed at sustaining the city’s population levels (Lindenthal and Eichholtz, 2012). Despite government support, by the 1970s these neighbourhoods were criticised for their social isolation and standardised architecture, becoming a symbol of the bureaucratic approach to housing.\n\nEast Berlin HousingIn East Germany, the paradigm change towards large estates was far more comprehensive (Urban, 2018). After the Building Conference in 1955, the GDR began the ‘industrialisation of the construction industry’, which led to the mass construction of houses from pre-fabricated reinforced concrete panels (Plattenbau). Private landownership was almost entirely abandoned and state-led housing associations provided mass housing, becoming the most conspicuous urban form (Fields and Uffer, 2016). Although the new mass construction embodied the idea of socialist equality, over time it became associated with uniformity and social control by the state.","type":"content","url":"/notebooks/berlin-housing-crisis-history#id-1945-1989-post-world-war-ii-developments","position":3},{"hierarchy":{"lvl1":"1.2 Berlin Housing Crisis History","lvl2":"1989‑1991. Political and Spatial Reunion"},"type":"lvl2","url":"/notebooks/berlin-housing-crisis-history#id-1989-1991-political-and-spatial-reunion","position":4},{"hierarchy":{"lvl1":"1.2 Berlin Housing Crisis History","lvl2":"1989‑1991. Political and Spatial Reunion"},"content":"The fall of the Berlin Wall meant not only political but also spatial unification of two separate housing systems. The unification of the city provided for a massive shock to housing supply.\n\nAfter the opening up of the East, households could live in East Berlin or in surrounding Brandenburg instead of West Berlin. This increased competition is hypothesized to lower prices in peripheral locations of West Berlin. In the same time, the central quarters became “more central”, since they are now in the middle of an overall larger metropolitan area (Lindenthal and Eichholtz, 2012).\n\nMunicipal policy towards Berlin’s housing estates was somewhat contradictory. On the one hand, in the early 1990s, both the local authority and the national government poured generous subsidies into the housing stock supporting renovation. On the other hand, along with increasing international popularity of market-centred ideas, market was turning against social housing, and thus against the every institution from which these estates derived (Urban, 2018).","type":"content","url":"/notebooks/berlin-housing-crisis-history#id-1989-1991-political-and-spatial-reunion","position":5},{"hierarchy":{"lvl1":"1.2 Berlin Housing Crisis History","lvl2":"1992-2012. Privatisation, Financialisation and Gentrification"},"type":"lvl2","url":"/notebooks/berlin-housing-crisis-history#id-1992-2012-privatisation-financialisation-and-gentrification","position":6},{"hierarchy":{"lvl1":"1.2 Berlin Housing Crisis History","lvl2":"1992-2012. Privatisation, Financialisation and Gentrification"},"content":"Berlin’s fiscal instability motivated privatisation of its state-owned housing stock and  abandonment of social housing subsidies. In 1991, the city owned approximately 480,000 housing units (28% of the entire housing stock), but by the early 2000s, most of this housing had been sold to private and institutional investors (Fields and Uffer, 2016). While privatisation created expectations that private investors would contribute their financial resources to modernize the housing stock, Berlin’s housing demand was low.\n\nBetween 2000 and 2006, Berlin sold 100,000 dwelling units to international investors, thus sacrificing a system working with long-term success for short-term profit (Fields and Uffer, 2016). Private investors were speculating on a rising market seeing an opportunity to increase rents through modernisation and luxurious upgrading (Urban, 2018).\n\nResearch by Fields and Uffer (2016) shows that private investment has exacerbated inequality in access to housing, and global financialisation mechanisms have come to determine urban policy more strongly than social priorities. High-yield investors have renovated residential buildings, increased rents and removed flats from the social rental system. This process has been accompanied by the gentrification of central areas and the social displacement of low-income residents to the periphery.","type":"content","url":"/notebooks/berlin-housing-crisis-history#id-1992-2012-privatisation-financialisation-and-gentrification","position":7},{"hierarchy":{"lvl1":"1.2 Berlin Housing Crisis History","lvl2":"2012 - 2024. New Actors, Old Problems"},"type":"lvl2","url":"/notebooks/berlin-housing-crisis-history#id-2012-2024-new-actors-old-problems","position":8},{"hierarchy":{"lvl1":"1.2 Berlin Housing Crisis History","lvl2":"2012 - 2024. New Actors, Old Problems"},"content":"Since the early 2010s, Berlin has been experiencing a new wave of housing crisis.\n\nCompared to other major German cities, Berlin still has potential for land use both in the city and in the surrounding area (Berlin Strategy, 2018). Which makes it unique for urban planning research.\n\nAt the same time, a variety of challenges are already looming that the city will have to overcome in the coming years. Above all, these include tasks associated with urban growth. According to the Senate Department for Urban Development, Building and Housing (2022), Berlin already reached a population of 3.75 million. The population forecast assumes that the number of residents will rise to around 3.93 million by 2030. The growth is primarily driven by immigration from abroad (CBRE GmbH, 2025). Such residents accounted for 24.4 percent of Berlin’s population in 2024. The number of newcomers who moved to Berlin from abroad was twice as high as the number of people who moved to the capital from other parts of Germany.\n\nOpportunities accompanying this growth include the potential for more affordable housing. However, these developments often come with specific spatial requirements and property policies (Berlin Strategy, 2018). Moreover, the application of planning law become particularly challenging in light of rising costs, inflation, and high interest rates, which carry the risk of social inequality, spatial\npolarisation, and housing crisis.","type":"content","url":"/notebooks/berlin-housing-crisis-history#id-2012-2024-new-actors-old-problems","position":9},{"hierarchy":{"lvl1":"1.2 Berlin Housing Crisis History","lvl2":"Conclusion"},"type":"lvl2","url":"/notebooks/berlin-housing-crisis-history#conclusion","position":10},{"hierarchy":{"lvl1":"1.2 Berlin Housing Crisis History","lvl2":"Conclusion"},"content":"Berlin Housing History is a story of recurring crises and compromises. The contradiction between housing as a social right and housing as a market commodity remains unresolved.","type":"content","url":"/notebooks/berlin-housing-crisis-history#conclusion","position":11},{"hierarchy":{"lvl1":"1.3 Theoretical Framework"},"type":"lvl1","url":"/notebooks/theoretical-framework","position":0},{"hierarchy":{"lvl1":"1.3 Theoretical Framework"},"content":"Theoretical framework can be seen as a point of view of to research question. In order to make research interdisciplinary it is a need to consider urban and social theories. While there are many theories that could help to solve the student housing crisis in Berlin, this chapter examines only three main theories that respond to literature gaps and influenced the forming of research interest.","type":"content","url":"/notebooks/theoretical-framework","position":1},{"hierarchy":{"lvl1":"1.3 Theoretical Framework","lvl2":"Urban Theories"},"type":"lvl2","url":"/notebooks/theoretical-framework#urban-theories","position":2},{"hierarchy":{"lvl1":"1.3 Theoretical Framework","lvl2":"Urban Theories"},"content":"Central Place Theory\n\nCentral Place Theory helps to construct spatial research at the level of a large city such as Berlin, as well as at the level of its planning districts, defining urban centrality:\n\nFor many economic activities located in a city it is important that they be central to some larger market area that extends beyond the boundaries of the urban place itself. This is especially so for activities that serve the community surrounding the urban place (King, 1986).\n\nThis theory can be adapted to the student housing crisis by considering universities as central points that establish spatial economic relations in the student housing market.\n\nCentral Place Theory, considering universities as central places, helps to unite the existing Berlin student real estate market and the universities that form the demand for this market. Depending on the ownership of student accommodation, the theory helps to define the roles of both the private and public construction sectors.\n\nThus, the economic interrelationships between higher education universities and student accommodation come sharply into focus when, for example, policy issues concerning metropolitan and regional government reorganisation are raised.","type":"content","url":"/notebooks/theoretical-framework#urban-theories","position":3},{"hierarchy":{"lvl1":"1.3 Theoretical Framework","lvl2":"Social Theories"},"type":"lvl2","url":"/notebooks/theoretical-framework#social-theories","position":4},{"hierarchy":{"lvl1":"1.3 Theoretical Framework","lvl2":"Social Theories"},"content":"Right to the City Theory\n\nRight to the City Theory is a necessary response to the financialisation that has taken place in Berlin over the past decades.\n\nThe concept of Right to the City, developed by French philosopher and sociologist Henri Lefebvre, is a critical approach to understanding social relations in the modern city (Lefebvre, 1996). Lefebvre argues that the city is not just a physical space, but a product of social relations where residents have an unconditional collective right to urban life. Lefebvre’s concept allows us to rethink the student housing crisis from the perspective of social justice, accessibility, and commercialisation.\n\nThe future of the city must be shaped by its inhabitants, not by the interests of capital. (Lefebvre, 1968).\n\nBerlin’s urban environment must take into account the needs of all inhabitants, not just the economically privileged groups. Students are an important part of the urban population, providing a driver of change in the city. Every student has the right to social justice. Factors influencing students’ housing choices should be taken into account in Berlin’s long-term urban planning.\n\nThe city is an oeuvre, closer to a work of art than a simple material product. (Lefebvre, 1968).\n\nThe housing market in Berlin should be shaped by social demands and not by commercial interests. The city is not an object of speculation. Prioritising private development over the creation\nof new affordable housing contradicts the student’s right to the city.\n\nIn Berlin, this theory is particularly relevant and has actually been written into the city constitution:\n\nEveryone has the right to adequate housing. The state promotes the creation and provision of adequate housing, especially for people on low incomes, and the cultivation of condominium ownership – Article 28 (1) of the \n\nBerlin Constitution.\n\nThis theory aims to protect students’ rights to affordable housing, counteract the displacement of students from the central urban fabric, and halt the privatisation of social housing.\n\nAffordability Theory\nAffordability Theory complements spatial and social analysis with an economic dimension of housing affordability. The main problem with student housing in Berlin is not only a shortage of supply, but also the fact that prices are out of line with students’ actual financial capabilities.\n\nThe Affordability Theory in Housing, developed by Michael Stone (2006), defines affordability beyond rental prices, incorporating income, basic needs expenses, transport costs, and structural limitations of the housing market. Stone’s theory allows us to define affordable housing in a broader economic and social context.\n\nHousing affordability is not just about the cost of housing, but about the balance between housing costs and the ability to meet other basic needs. (Stone, 2006).\n\nThe assessment of housing affordability for students should include not only the cost of housing itself and its proportion in relation to the student’s income but also the cost of studying at Berlin’s universities, as well as basic financial needs such as transport, student insurance, and groceries. In addition to basic financial needs, the term affordability also includes basic social needs such as the quality of housing, the state of the infrastructure, and the possibility for students to participate in urban life. Student housing affordability is the ability to cover housing costs without compromising basic financial and social needs.\n\nAffordability Theory serves as a conceptual basis for analysing student housing needs and preferences and requires a behavioural and qualitative approach. Thus, it complements the quantitative spatial research of Central Place Theory with a qualitative assessment of the actual living conditions of students, revealing the gap between formal housing supply and actual affordability.\n\nTogether, Central Place Theory, Right to the City Theory, and Affordability Theory form a comprehensive analytical framework that allows us to view the student housing crisis in Berlin as a spatial, social, and economic problem simultaneously. These theories provide a theoretical basis for data-driven analysis aimed at reducing the gap between the opportunities offered by the student housing market and the real needs of students in the context of the ongoing housing crisis.","type":"content","url":"/notebooks/theoretical-framework#social-theories","position":5},{"hierarchy":{"lvl1":"1.4 Rethinking Student Housing in Berlin"},"type":"lvl1","url":"/notebooks/rethinking-student-housing","position":0},{"hierarchy":{"lvl1":"1.4 Rethinking Student Housing in Berlin"},"content":"","type":"content","url":"/notebooks/rethinking-student-housing","position":1},{"hierarchy":{"lvl1":"1.4 Rethinking Student Housing in Berlin","lvl2":"Problem Statement"},"type":"lvl2","url":"/notebooks/rethinking-student-housing#problem-statement","position":2},{"hierarchy":{"lvl1":"1.4 Rethinking Student Housing in Berlin","lvl2":"Problem Statement"},"content":"Housing is a basic human need and a fundamental right, comparable in importance to access to water or clean air (Lefebvre, 1968). Stable, affordable and safe housing is a necessary condition for a dignified life, social integration and full participation in urban and educational spaces. In this context, housing should be viewed not only as physical infrastructure, but also as a socio-political tool that shapes access to opportunities, resources and rights.\n\nAs Roberta Burghardt (2025) notes, architects, urban planners and designers can influence not only the form of living spaces, but also models of ownership, participation schemes, and mechanisms for managing and allocating housing. Thus, the issue of student housing goes beyond the design of buildings and becomes part of a broader discussion about urban justice and governance.","type":"content","url":"/notebooks/rethinking-student-housing#problem-statement","position":3},{"hierarchy":{"lvl1":"1.4 Rethinking Student Housing in Berlin","lvl2":"Context"},"type":"lvl2","url":"/notebooks/rethinking-student-housing#context","position":4},{"hierarchy":{"lvl1":"1.4 Rethinking Student Housing in Berlin","lvl2":"Context"},"content":"Historically, in the post-war period, students in Berlin mainly lived in shared rental accommodation. However, over the last few decades, the structure of student housing has changed significantly. Purpose-Built Student Accommodations (PBSA) — specially built and managed residential complexes for students — have begun to play a special role, which is particularly noticeable in the international student segment.\n\nNevertheless, despite the growth in the number of such facilities, only about 8% of students in Berlin live in PBSA (Deutsches Studierendenwerk, 2024). Most students are still forced to look for accommodation on the general rental market — in shared flats, sublets or corporate models — due to the general rental pattern of the German housing market. As a result, students compete with other population groups for a limited number of available flats, leading to rising prices, housing instability and housing vulnerability.\n\nThe process of financialisation of student housing reinforces this imbalance: PBSAs are viewed by investors as stable investment products with high returns, due to the lack of sufficient alternatives in the public sector. As a result, the social function of student housing is taking a step back, making way for market logic (Annas Ejaz, Anika Gercke, 2025).","type":"content","url":"/notebooks/rethinking-student-housing#context","position":5},{"hierarchy":{"lvl1":"1.4 Rethinking Student Housing in Berlin","lvl2":"Limitations"},"type":"lvl2","url":"/notebooks/rethinking-student-housing#limitations","position":6},{"hierarchy":{"lvl1":"1.4 Rethinking Student Housing in Berlin","lvl2":"Limitations"},"content":"At the same time, a variety of challenges are already looming that the city will have to overcome in the coming years. Above all, these include tasks associated with urban growth. According to the Senate Department for Urban Development, Building and Housing (2022), Berlin already reached a population of 3.75 million. The population forecast assumes that the number of residents will rise to around 3.93 million by 2030. The growth is primarily driven by immigration from abroad (Housing Market Report, 2024). Such residents accounted for 24.4 percent of Berlin’s population in 2024. The number of newcomers who moved to Berlin from abroad was twice as high as the number of people who moved to the capital from other parts of Germany.\n\nBerlin’s housing policy stipulates that at least 30% of new housing must be social housing, with the aim of preserving social diversity and housing affordability in all areas of the city (Senate Department for Urban Development, Building and Housing, 2023). However, this target has not yet been sufficiently achieved in the area of student housing.\n\nAs ESN and ESU (2023) emphasise, expanding public student housing should be a priority across Europe, especially in countries and cities where it is underdeveloped. Such housing plays a key role not only in ensuring affordability, but also in supporting the internationalisation and mobility of students. Higher education institutions, as important urban actors, should engage more actively with local authorities and the private sector, as many of the challenges faced by students are not only market-related but also involve contractual and administrative barriers, where the public sector can play a decisive role.\n\nThe study focuses exclusively on international students and purpose-built student accommodation, which allows for a deeper understanding of the current structural vulnerabilities of this model, but limits the ability to generalise the results to the entire student population.","type":"content","url":"/notebooks/rethinking-student-housing#limitations","position":7},{"hierarchy":{"lvl1":"1.4 Rethinking Student Housing in Berlin","lvl2":"Research Question"},"type":"lvl2","url":"/notebooks/rethinking-student-housing#research-question","position":8},{"hierarchy":{"lvl1":"1.4 Rethinking Student Housing in Berlin","lvl2":"Research Question"},"content":"How can data-driven decision-making reshape Berlin’s student housing, to bridge the gaps between student housing market capacities and students demands, addressing basic financial and social needs, during the city’s ongoing housing crisis?","type":"content","url":"/notebooks/rethinking-student-housing#research-question","position":9},{"hierarchy":{"lvl1":"1.4 Rethinking Student Housing in Berlin","lvl2":"Scientific Objectives"},"type":"lvl2","url":"/notebooks/rethinking-student-housing#scientific-objectives","position":10},{"hierarchy":{"lvl1":"1.4 Rethinking Student Housing in Berlin","lvl2":"Scientific Objectives"},"content":"In accordance with the question posed, the study has the following scientific objectives:\n\nStudent Housing Market: Capacities, Demand, and Spatial Distribution\nWhere are student accommodations and universities located?\n\nHow are they spatially distributed across the city?\n\nStudent Housing Market Imbalance\nHow do student university demand compare to student housing market housing capacities?\n\nWhere do spatial patterns of demand and supply generate elevated market pressure?\n\nStudents Behind the Numbers\nWho are the users of student accommodations?\n\nWhat experience they have in ongoing housing crisis? What are common needs, preferences, difficulties and problems?\n\nThe study aims to combine spatial, quantitative and qualitative analysis to go beyond abstract market indicators. The use of geodata and statistics allows us to identify areas of increased pressure and structural imbalances, while surveys and interviews reveal the everyday experiences of students that are hidden behind aggregated data. This combined approach not only identifies housing shortages, but also understands how they translate into stress, unstable housing strategies, discriminatory practices and social vulnerability, especially among international students. Ultimately, the goal of the study is to form a basis for more equitable and informed decisions in the field of student housing, taking into account the real needs of users and the constraints of the urban context.","type":"content","url":"/notebooks/rethinking-student-housing#scientific-objectives","position":11},{"hierarchy":{"lvl1":"2.1 Overview"},"type":"lvl1","url":"/notebooks/overview","position":0},{"hierarchy":{"lvl1":"2.1 Overview"},"content":"Chapter Capacities, Demand & Spatial Distribution gives an overview of Berlin’s student housing market. It focuses on evaluation of initial market capacities and demand and how they spread across the city.","type":"content","url":"/notebooks/overview","position":1},{"hierarchy":{"lvl1":"2.1 Overview","lvl2":"What? Student Housing Market: Capacities, Demand, and Spatial Distribution"},"type":"lvl2","url":"/notebooks/overview#what-student-housing-market-capacities-demand-and-spatial-distribution","position":2},{"hierarchy":{"lvl1":"2.1 Overview","lvl2":"What? Student Housing Market: Capacities, Demand, and Spatial Distribution"},"content":"The student housing market can be understood as the intersection between demand — represented by the number of international students and their housing needs — and capacity, defined by the number of available purpose build student accommodations.\n\nBy definition given in MLP Studentenwohnreport (2024):\n\nDemand - mainly depends on the number of students, which often changes by location. Students also compete with young workers, trainees, or commuters, so student numbers only partly show demand. For this research, the target group is international students enrolled in Berlin’s higher education, at any level, regardless of current residency.\n\nCapacity- is determined by the number of advertised apartments in the corresponding segments. Alternative housing options, such as student union dormitories, are also available. During the research process, all categories will be merged in a broader term - purpose-built student accommodation, categorised by type of ownership.\n\nFor the simplicity of data collection, student housing market will be understood as the intersection between demand — represented by the number of international students and their housing needs — and capacity, defined by the number of available purpose build student accommodations.\n\nIn a broader perspective, both demand and capacity are dynamic parameters influenced by university services, urban policy and social drivers. A more detailed discussion of their interrelation will be presented in the Discussion Chapter.","type":"content","url":"/notebooks/overview#what-student-housing-market-capacities-demand-and-spatial-distribution","position":3},{"hierarchy":{"lvl1":"2.1 Overview","lvl2":"Why? Initial Student Housing Market Description"},"type":"lvl2","url":"/notebooks/overview#why-initial-student-housing-market-description","position":4},{"hierarchy":{"lvl1":"2.1 Overview","lvl2":"Why? Initial Student Housing Market Description"},"content":"The aim of this chapter is to describe the current state of Berlin’s student housing market by answering the following research questions:\n\nWhere are student accommodations and universities located?\n\nHow are they spatially distributed across the city?","type":"content","url":"/notebooks/overview#why-initial-student-housing-market-description","position":5},{"hierarchy":{"lvl1":"2.1 Overview","lvl2":"How? Spatial Data Analysis and Spatial Econometrics"},"type":"lvl2","url":"/notebooks/overview#how-spatial-data-analysis-and-spatial-econometrics","position":6},{"hierarchy":{"lvl1":"2.1 Overview","lvl2":"How? Spatial Data Analysis and Spatial Econometrics"},"content":"The descriptive process combines Urban Data Mining, Statistical Analysis, and Spatial Autocorrelation to examine market characteristics and explore spatial relationships.\n\nUrban Data MiningUrban Data Mining is a data collection method that aims to gain new insights by identifying patterns, exceptions, and anomalies in the data (Giseke et al., 2021). It involves selecting, exploring, cleaning, interpreting, and visualising datasets. Data Mining also involves transforming data from non-spatial to spatial. Therefore, it can be seen as the first step of Spatial Data Analysis (SDA). Due to the need to work with large amounts of data. Data Mining is primarily achieved through software, with Python Programming and Artificial Intelligence methods used to further develop urban environments and improve residents’ daily lives (Giseke et al., 2021).\n\nUrban Data Mining is used - one of the most time-consuming stages. Since there is no pre-made data set that combines data on all student dormitories and educational institutions in Berlin. Therefore, the data had to be collected in two stages: first manually, then automatical preparation. The quality of manual collection depends directly on the time spent on it and carries the risk of incomplete data, as different data sources indicate different sets of attributes. Meanwhile, automatic data preparation allows you to identify inaccuracies in the data and fill in missing attributes.\n\nDescriptive StaticticsDescriptive Statistics is a set of statistical procedures that summarize the essential characteristics of a distribution through calculating and plotting. Statistical methods are employed to analyse spatial data, quantify a spatial process, discover hidden patterns or unexpected trends and model these data in a geographic context(Giseke et al., 2021).\n\nDescriptive statistics in the context of this work is considered as the initial stage of data analysis, which allows a quantitative assessment of the characteristics of student housing and higher educational institutions, as well as the identification of initial quantitative patterns.\n\nSpatial AutocorrelationSpatial Autocorrelation is the degree of spatial dependency, association, or correlation between the value of an observation of a spatial entity and the values of neighboring observations of the same variable. It is unlikely that the spatial distribution of Student Accommodations and Higher Education Universities will be homogeneous in the entire Berlin due to the nonuniformity and noncontinuity of space. The magnitude of spatial autocorrelation may vary from one neighborhood to another due to spatial heterogeneity. To estimate spatial autocorrelation at the local level, the is a need to use local measures of spatial autocorrelation, like Local Moran’s I index (Grekousis, 2020).\n\nUnlike Urban Data Mining and Descriptive Statistics, Spatial Autocorrelation works directly with spatial dimensions and allows you to identify patterns in the spatial distribution of student accommodations and higher education institutions, as well as evaluate the spatial differences between them.\n\nThrough the combination of quantitative, spatial, and computational approaches, this chapter establishes a foundation for the empirical analysis of Berlin’s student housing system. It links theoretical concepts of demand and capacity with practical spatial evidence, creating a bridge between urban data science and housing policy research.","type":"content","url":"/notebooks/overview#how-spatial-data-analysis-and-spatial-econometrics","position":7},{"hierarchy":{"lvl1":"2.2 Urban Data Mining"},"type":"lvl1","url":"/notebooks/urban-data-mining","position":0},{"hierarchy":{"lvl1":"2.2 Urban Data Mining"},"content":"import warnings\n\nwarnings.filterwarnings(\"ignore\")\n\nimport pandas as pd\nimport os\nhf = r'../outputs/2.2_urban_data_mining/'\nos.makedirs(hf, exist_ok=True)\n\n\n\n","type":"content","url":"/notebooks/urban-data-mining","position":1},{"hierarchy":{"lvl1":"2.2 Urban Data Mining"},"type":"lvl1","url":"/notebooks/urban-data-mining#id-2-2-urban-data-mining","position":2},{"hierarchy":{"lvl1":"2.2 Urban Data Mining"},"content":"\n\nUrban Data Mining, or the process of collecting and preparing data for analysis, consisted of two stages, which can be divided into manual collection and automated data preparation. The purpose of the manual stage was to collect data and convert it into tabular form, while the automated process was aimed to convert the tabular data into geospatial data.\n\n","type":"content","url":"/notebooks/urban-data-mining#id-2-2-urban-data-mining","position":3},{"hierarchy":{"lvl1":"Manual Data Collection"},"type":"lvl1","url":"/notebooks/urban-data-mining#manual-data-collection","position":4},{"hierarchy":{"lvl1":"Manual Data Collection"},"content":"The main task of manual data collection is searching purpose-built student accommodation and higher education universities in Berlin and collecting capacity and demand data, respectively.\n\n","type":"content","url":"/notebooks/urban-data-mining#manual-data-collection","position":5},{"hierarchy":{"lvl1":"Manual Data Collection","lvl2":"Student Accommodation"},"type":"lvl2","url":"/notebooks/urban-data-mining#student-accommodation","position":6},{"hierarchy":{"lvl1":"Manual Data Collection","lvl2":"Student Accommodation"},"content":"The Studentenwerk (StW, 2025) website was used as the initial source of data for the purpose of building student accommodation. StW is a public, non-profit organisation that provides essential services to students in Germany, including affordable housing, operating student dormitories in collaboration with universities. The StW website provides not only detailed information about addresses, prices, accommodation types, and living space in student accommodation, but also references to other publicly funded companies that provide social housing for students, such as Howoge, Gewobag, Berlinvo, and others. Data on the capacity of public student dormitories was collected from the Study in Germany website, which is supported by the Federal Ministry of Education and Research (BMBF, 2025) and is part of the ‘Germany – Land of Ideas’ campaign.\n\nThe missing addresses of private companies were collected from online platforms of companies specialising in student housing and property rental in Berlin. While public companies publish data openly, private companies have less transparent policy, which limits the research process and complicates the manual data mining process.\n\nA complete list of online sources used for manual data collection on student accommodation is presented in Table XX.\n\nsp = r\"../inputs/2.2_urban_data_mining/urban_data_mining_sourses.xlsx\"\n\nsourses = pd.read_excel(sp)\nsourses[[\n    \"sourse\",\n    \"comment¹\",\n    \"link\",\n]].head(23)\n\n\n\nTable XX. Manual Data Collection Sources for Student Accommodation\n\nThe address is a critical parameter for conducting spatial econometric analysis. However, many student accommodations have more than one building. For example, WH Spandauer Damm comprises five buildings located at Spandauer Damm 134–142 (Studierendenwerk Berlin, 2025). During manual data collection, one of the tasks was to collect unique addresses related to the student housing market in order to calculate centroids afterwards, during automated data preparetion.\n\nFor student housing, the data collected included the address (street, house_nummer, plz, city), the name of the building complex (name), the ownership company name (ownership), the ownership model (ownership model), number of residential units (!units), their capacity (!students) and type (units type), maximum and minimum price (price_min, price_max), maximum and minimum living space (area_min, area_max), link to the source (link).\n\nAs a result of manual data collection, data was collected on 94 proposed student accommodation buildings located at 171 unique addresses.\n\nfp = r\"../inputs/2.2_urban_data_mining/input_pbsa.xlsx\"\n\npbsa = pd.read_excel(fp, sheet_name='SA', dtype={'street': str, 'house_nummer': str, 'plz': str})\n\n\n\npbsa.info()\n\n\n\n","type":"content","url":"/notebooks/urban-data-mining#student-accommodation","position":7},{"hierarchy":{"lvl1":"Manual Data Collection","lvl2":"Higher Education Universities"},"type":"lvl2","url":"/notebooks/urban-data-mining#higher-education-universities","position":8},{"hierarchy":{"lvl1":"Manual Data Collection","lvl2":"Higher Education Universities"},"content":"In order to indicate Berlin’s student demand, it was necessary to collect data on all of Berlin’s higher education institutions and the number of students enrolled in them. Although the initial plan was to limit the search to public educational institutions only. Nevertheless during the data collection process it became evident that the list and statistics for private universities were also publicly available.\n\nThe dataset provided by the Statistisches Bundesamt (DESTATIS, 2025) serves as the most comprehensive source, capturing detailed information on student enrollments, origin, and gender at public and private German higher education institutions. The data provided was so detailed that it included information about branches of Berlin universities in other regions of the country. For example, Media Design School Berlin also has a campus in Munich. These universities  were excluded from the statistics as they do not put pressure on the Berlin Student Housing Market.\n\nAfter cleaning, the Higher Education Institution list from the Federal Statistical Office was double-checked with the official Berlin city directory of higher education institutions (Berlin City Portal, 2025) and the official registry maintained by the German Rectors’ Conference (Hochschul Kompass, 2025).\n\nA complete list of online sources used for manual data collection on higher education institutions is provided in Table XX.\n\nsourses[[\n    \"sourse\",\n    \"comment¹\",\n    \"link\",\n]].iloc[23:] \n\n\n\nTable XX. Manual Data Collection Sources for Higher Education Universities\n\nAfter secondary verification of the list of educational institutions, the next task was to collect unique addresses, as large universities have more than one campus. For example, Charité - Universitätsmedizin Berlin has four campuses in Berlin, which are located at a total of 41 unique addresses. The manual search for addresses was carried out using two services: Open Street Map and Google Maps.\n\nFor Higher Education Universities, the data collected included the code according to the Federal Statistical Office, the abbreviation (abr), the name (name) and the full name (fname), the address (adr), the ownership model (own), type of educational institution (stud), number of German students (!s_de), number of foreign students (!s_aus) and total number of students (!s_all).\n\nAs a result of manual data collection, data was collected on 70 higher education institutions in Berlin, located at 357 unique addresses.\n\nop = r\"../inputs/2.2_urban_data_mining/input_uni.xlsx\"\n\nuni = pd.read_excel(op, sheet_name='Uni', dtype={'adr': str})\n\n\n\nuni.info()\n\n\n\n","type":"content","url":"/notebooks/urban-data-mining#higher-education-universities","position":9},{"hierarchy":{"lvl1":"Automated Data Preparation"},"type":"lvl1","url":"/notebooks/urban-data-mining#automated-data-preparation","position":10},{"hierarchy":{"lvl1":"Automated Data Preparation"},"content":"During Manual Data Collection, one of the biggest challenges of data-driven research - finding and selecting data - was successfully overcome.The next challenge within Urban Data Mining is data cleaning, formatting, and standartalising. Data preparation using the Python programming language not only allows you to identify errors in manual input data, but also automates problem-solving during data import, cleaning, and export, as well as during geocoding.\n\n","type":"content","url":"/notebooks/urban-data-mining#automated-data-preparation","position":11},{"hierarchy":{"lvl1":"Automated Data Preparation","lvl2":"Set Up"},"type":"lvl2","url":"/notebooks/urban-data-mining#set-up","position":12},{"hierarchy":{"lvl1":"Automated Data Preparation","lvl2":"Set Up"},"content":"\n\nImport Libraries\n\nimport pandas as pd \nimport numpy as np \nfrom tqdm import tqdm  \nimport geopandas as gpd \nfrom geopy.geocoders import Nominatim, Photon \nfrom geopy.extra.rate_limiter import RateLimiter \nimport matplotlib.pyplot as plt \nfrom matplotlib.colors import LinearSegmentedColormap \nfrom shapely.geometry import MultiPoint \nfrom sklearn.cluster import DBSCAN \nimport time  \n\n\n\nScripts\n\nIn order to access spatial analysis and spatial economics methods and Tools, it is necessary to convert addresses to geographical coordinates, which consist of longitude and latitude. Geocoding converts addresses into geographical coordinates to be placed on a map.\n\nTwo services, Nominatim and Photon, were used for geocoding. Despite the use of several services, about 10% of addresses were not recognised or were misinterpreted, indicating errors in the manually collected data.\n\nTo improve the accuracy of the coordinate search, the names of the city (Berlin) and country (Germany) were added to each address, which made it possible to uniquely identify objects in the German capital. In addition, to account for the particularities of the German language and possible spelling errors, an alternative spelling mechanism was implemented: special characters such as ‘ß’ were automatically replaced with ‘ss’, which increased the likelihood of successfully matching the address with the geographic database.\n\nSince the addresses for student accommodation and higher education universities were collected in different formats, two different scripts were also used for geocoding, which differed from each other in their query (df[“query”]). At the same time, it would be advisable to avoid writing two scripts by collecting data on student accommodation and higher education universities in a single format (for example, df['query'] = df['street'] + ' ' + df['house_nummer'] + ', ' + df['plz'] + ', ' + df['city'] + ', Germany').\n\ndef geocode_pbsa(df):\n    # Initialize geocoders\n    nom = RateLimiter(Nominatim(user_agent=\"berlin_housing\", timeout=10).geocode, \n                     min_delay_seconds=1)\n    photon = RateLimiter(Photon(user_agent=\"berlin_housing\", timeout=10).geocode,\n                        min_delay_seconds=0.5)\n    \n    # Create address strings\n    #df['query'] = df['adr'] + ', Germany'   \n    df['query'] = df['street'] + ' ' + df['house_nummer'] + ', ' + df['plz'] + ', ' + df['city'] + ', Germany'                 \n    df['query_alt'] = df['query'].str.replace('ß', 'ss')  # Alternative spelling\n    \n    # Geocoding function with retries\n    def geocode(address, geocoder, retries=2):\n        for _ in range(retries):\n            try:\n                loc = geocoder(address)\n                return (loc.latitude, loc.longitude) if loc else (None, None)\n            except:\n                time.sleep(1)\n        return (None, None)\n    \n    # Primary geocoding (Nominatim)\n    tqdm.pandas(desc=\"Primary geocoding\", disable=True)\n    df[['lat', 'lon']] = df['query'].progress_apply(\n        lambda x: pd.Series(geocode(x, nom))\n    )\n    \n    # Fallback (Photon for failed addresses)\n    missing = df[df['lat'].isna()]\n    if not missing.empty:\n        tqdm.pandas(desc=\"Fallback geocoding\", disable=True)\n        missing[['lat', 'lon']] = missing['query_alt'].progress_apply(\n            lambda x: pd.Series(geocode(x, photon)))\n        df.update(missing)\n    \n    # Convert to GeoDataFrame (Berlin CRS)\n    return gpd.GeoDataFrame(\n        df.drop(['query', 'query_alt'], axis=1, errors='ignore'),\n        geometry=gpd.points_from_xy(df['lon'], df['lat']),\n        crs=\"EPSG:4326\"\n    ).to_crs(\"EPSG:25833\")\n\n\n\ndef geocode_uni(df):\n    # Initialize geocoders\n    nom = RateLimiter(Nominatim(user_agent=\"berlin_housing\", timeout=10).geocode, \n                     min_delay_seconds=1)\n    photon = RateLimiter(Photon(user_agent=\"berlin_housing\", timeout=10).geocode,\n                        min_delay_seconds=0.5)\n    \n    # Create address strings\n    df['query'] = df['adr'] + ', Germany'   \n    df['query_alt'] = df['query'].str.replace('ß', 'ss')  # Alternative spelling\n    \n    # Geocoding function with retries\n    def geocode(address, geocoder, retries=2):\n        for _ in range(retries):\n            try:\n                loc = geocoder(address)\n                return (loc.latitude, loc.longitude) if loc else (None, None)\n            except:\n                time.sleep(1)\n        return (None, None)\n    \n    # Primary geocoding (Nominatim)\n    tqdm.pandas(desc=\"Primary geocoding\", disable=True)\n    df[['lat', 'lon']] = df['query'].progress_apply(\n        lambda x: pd.Series(geocode(x, nom))\n    )\n    \n    # Fallback (Photon for failed addresses)\n    missing = df[df['lat'].isna()]\n    if not missing.empty:\n        tqdm.pandas(desc=\"Fallback geocoding\", disable=True)\n        missing[['lat', 'lon']] = missing['query_alt'].progress_apply(\n            lambda x: pd.Series(geocode(x, photon)))\n        df.update(missing)\n    \n    # Convert to GeoDataFrame (Berlin CRS)\n    return gpd.GeoDataFrame(\n        df.drop(['query', 'query_alt'], axis=1, errors='ignore'),\n        geometry=gpd.points_from_xy(df['lon'], df['lat']),\n        crs=\"EPSG:4326\"\n    ).to_crs(\"EPSG:25833\")\n\n\n\nColors\n\ncolor_palettes = {\n    \"Pi\": [\"#F8EDEB\", \"#FAE1DD\", \"#FCD5CE\", \"#FEC5BB\", \"#F8AD9D\", \"#F4978E\", \"#F08080\"],\n    \"Or\": [\"#FFE5D9\", \"#FFD7BA\", \"#FEC89A\", \"#FFB78F\", \"#F49F7D\", \"#F28B6D\"],\n    \"GrSc\":  [\"#434343\", \"#666666\", \"#999999\", \"#b7b7b7\", \"#cccccc\", \"#d9d9d9\", \"#efefef\", \"#f3f3f3\", \"#ffffff\"]\n}\n\ncmap_pi = LinearSegmentedColormap.from_list(\"Pi\", color_palettes[\"Pi\"])\ncmap_or = LinearSegmentedColormap.from_list(\"Or\", color_palettes[\"Or\"])\ncmap_grsc = LinearSegmentedColormap.from_list(\"GrSc\", color_palettes[\"GrSc\"])\n\n\n\nFont\n\nplt.rcParams[\"font.family\"] = \"Helvetica\"\n\n\n\nBerlin Spatial Boundaries\n\npf = r\"../inputs/2.2_urban_data_mining/lor_pgr.gpkg\"\npgr = gpd.read_file(pf)\npgr.replace({'-': np.nan, 0: np.nan, '': np.nan}, inplace=True)\n\nbf = r\"../inputs/2.2_urban_data_mining/adm_bz.gpkg\"\nbz = gpd.read_file(bf)\nbz.replace({'-': np.nan, 0: np.nan, '': np.nan}, inplace=True)\n\nof = r\"../inputs/2.2_urban_data_mining/adm_out.gpkg\"\nout = gpd.read_file(of)\nout.replace({'-': np.nan, 0: np.nan, '': np.nan}, inplace=True)\n\n\n\n","type":"content","url":"/notebooks/urban-data-mining#set-up","position":13},{"hierarchy":{"lvl1":"Automated Data Preparation","lvl2":"Data Import"},"type":"lvl2","url":"/notebooks/urban-data-mining#data-import","position":14},{"hierarchy":{"lvl1":"Automated Data Preparation","lvl2":"Data Import"},"content":"\n\nThe data obtained as a result of manual data collection served as input data for the automated stage.\n\nfp = r\"../inputs/2.2_urban_data_mining/input_pbsa.xlsx\"\n\npbsa = pd.read_excel(fp, sheet_name='SA', dtype={'street': str, 'house_nummer': str, 'plz': str})\n\nop = r\"../inputs/2.2_urban_data_mining/input_uni.xlsx\"\n\nuni = pd.read_excel(op, sheet_name='Uni', dtype={'adr': str})\n\n\n\n","type":"content","url":"/notebooks/urban-data-mining#data-import","position":15},{"hierarchy":{"lvl1":"Automated Data Preparation","lvl2":"Geocoding"},"type":"lvl2","url":"/notebooks/urban-data-mining#geocoding","position":16},{"hierarchy":{"lvl1":"Automated Data Preparation","lvl2":"Geocoding"},"content":"\n\nAs part of the automated data preparation stage, the addresses of student accommodation and higher education institutions were geocoded to obtain accurate geographical coordinates for each unique address. The data was then converted into a geospatial format (GeoDataFrame) and reprojected into the official Berlin coordinate system (EPSG:25833).\n\nStudent Accommodation\n\npbsa = geocode_pbsa(pbsa)\n\n\n\npbsa.info()\n\n\n\nHigher Education Universities\n\nuni = geocode_uni(uni)\n\n\n\nuni_copy = uni.copy()\n\n\n\nuni.info()\n\n\n\nThis results in a shift from tabular data to geospatial data with a new attribute geometry.\n\n","type":"content","url":"/notebooks/urban-data-mining#geocoding","position":17},{"hierarchy":{"lvl1":"Automated Data Preparation","lvl2":"Data Cleaning"},"type":"lvl2","url":"/notebooks/urban-data-mining#data-cleaning","position":18},{"hierarchy":{"lvl1":"Automated Data Preparation","lvl2":"Data Cleaning"},"content":"\n\nStudent Accommodation\n\nStudent Housing capacity is calculated as a single capacity indicator (!cap) according to the following rule: if the number of students living in student accommodation (students) is known, it is taken; if not, the number of housing units (units) is taken, while purposed build student accommodation, where both values are unknown, is excluded.\n\npbsa['!cap'] = pbsa['!students'].where(\n    pbsa['!students'].notnull(),\n    pbsa['!units']\n)\n\npbsa = pbsa.dropna(subset=['!cap'])\n\n\n\nAfter that, there is a transition from unique addresses to centroids or geographical centers (Figure XX), for which grouping by name is performed (pbsa.groupby(“name”)). Thus, student dormitories with more than one building are assigned a single point, and the capacity of all buildings is summed (!cap': “sum”).\n\npbsa_c = (\n    pbsa.groupby('name')\n    .agg({\n        'geometry': lambda x: MultiPoint([pt for pt in x]).centroid,\n        'plz': 'first',\n        'city': 'first',\n        'model': 'first',\n        'ownership': 'first',\n        'ownership_model': 'first',\n        '!cap': 'sum',\n        'units type': 'first',\n        'price_min': 'first',\n        'price_max': 'first',\n        'area_min': 'first',\n        'area_max': 'first',\n        'link': 'first'\n    })\n    .reset_index()\n)\n\npbsa_c = gpd.GeoDataFrame(pbsa_c, geometry='geometry', crs=pbsa.crs)\n\n\n\nThis results in a transition from 168 points to 88 centroids, which simplifies and speeds up further use of data in the data analysis.\n\nfig, axs  = plt.subplots(1, 2, figsize=(36, 12))\n\npgr.plot(ax=axs[0], facecolor='none', edgecolor='#cccccc', linewidth=0.5, linestyle=\"--\")\nbz.plot(ax=axs[0], facecolor='none', edgecolor='#999999', linewidth=0.75)\nout.plot(ax=axs[0], facecolor='none', edgecolor='#666666', linewidth=1)\npbsa.plot(ax=axs[0],\n          column='!cap',\n          cmap=cmap_or,\n          markersize = 35,  # Scale marker size\n          alpha=0.9,\n          edgecolor='white',\n          linewidth=0.3,\n          legend=True,\n          legend_kwds={'shrink': 0.6, 'label': \"capacity\"},\n          vmin=0,\n          vmax=pbsa_c['!cap'].quantile(0.95))  # Cap extremes\naxs[0].set_title(f'a. Student Accommodation\\n({len(pbsa)} points)', fontsize=28, pad=15, fontweight='bold')\naxs[0].set_axis_off()\nplt.tight_layout()\n\npgr.plot(ax=axs[1], facecolor='none', edgecolor='#cccccc', linewidth=0.5, linestyle=\"--\")\nbz.plot(ax=axs[1], facecolor='none', edgecolor='#999999', linewidth=0.75)\nout.plot(ax=axs[1], facecolor='none', edgecolor='#666666', linewidth=1)\npbsa_c.plot(ax=axs[1],\n          column='!cap',\n          cmap=cmap_or,\n          markersize = 35,\n          alpha=0.9,\n          edgecolor='white',\n          linewidth=0.3,\n          legend=True,\n          legend_kwds={'shrink': 0.6, 'label': \"capacity\"},\n          vmin=0,\n          vmax=pbsa_c['!cap'].quantile(0.95)) # Matching Previous plott\naxs[1].set_title(f\"b. Student Accommodation Centroids\\n({len(pbsa_c)} points)\", fontsize=28, pad=15, fontweight='bold')\naxs[1].set_axis_off()\n\nsave_path = os.path.join(hf, \"Student Accommodation.png\")\nplt.savefig(save_path, dpi=300, bbox_inches=\"tight\")\n\nplt.tight_layout()\nplt.show()\n\n\n\nFigure XX. Visual Comparison Initial Unique Student Accommodation Addresses with Final Centroids\n\nIt should be noted that unique addresses were collected specifically for the correct calculation of centroids. Meanwhile, for student communities, the calculation of centroids is relatively simple due to the unique names for each community and the proximity of its buildings. For universities, however, the task is not so straightforward, as grouping by name will not give the desired result, since a university with the same name may be located in different parts of the city, for example, Humboldt-Universität, which has three campuses: Campus Mitte, Campus Adlershof, and Campus Nord.\n\nHigher Education Universities\n\nHigher Education Universities’ demand for each educational institution is calculated as the number of international students enrolled in it. Universities for which there is no data on students are excluded.\n\nuni = uni.dropna(subset=['!s_all'])\n\n\n\nAfterwards, there is a transition from unique addresses to centroids (Figure XX). For this purpose, grouping by code (uni[“code”]) is performed, while demand indicators: the number of German students (!s_de), the number of foreign students (!s_aus) and the total number of students (!s_all) are distributed evenly among unique addresses — buildings — with a single unique code (for code in uni[“code”].unique()). This allows us to obtain an ‘average’ representation of the demand indicators for each individual building, while these data for different buildings are initially combined.\n\ncopy_cols = ['abr', 'name', 'fname', 'own', 'stud', 'url']\nsplit_cols = ['!s_de', '!s_aus', '!s_all']\n\n# Loop over unique codes\nfor code in uni['code'].unique():\n    mask = uni['code'] == code\n    group = uni[mask]\n    \n    # Copy values from first row in group\n    for col in copy_cols:\n        uni.loc[mask, col] = group.iloc[0][col]\n    \n    # Distribute numeric values\n    for col in split_cols:\n        if pd.notnull(group.iloc[0][col]):\n            uni.loc[mask, col] = round(group.iloc[0][col] / len(group), 2)\n        else:\n            uni.loc[mask, col] = pd.NA\n\n\n\nTo further transition from unique addresses to a single address for a complex of university buildings, the data were grouped based on a distance threshold. The threshold parameter was responsible for separating unique addresses belonging to the same university campus based on the spatial factor. The threshold value was obtained through multiple manual tests. At the same time, the demand values for each unique address were summed up.\n\ndistance_threshold = 650  # in meters\nrecords = []\n\nfor code, group in uni.groupby(\"code\"):\n    coords = np.array([(geom.x, geom.y) for geom in group.geometry])\n    if len(coords) == 0:\n        continue\n    # Cluster points that are close to each other\n    clustering = DBSCAN(eps=distance_threshold, min_samples=1).fit(coords)\n    group = group.copy()\n    group['cluster'] = clustering.labels_\n    for cluster_id, cluster_points in group.groupby('cluster'):\n        mp = MultiPoint(cluster_points.geometry.tolist())\n        # Prepare a record with all columns\n        record = cluster_points.iloc[0].to_dict()\n        record['geometry'] = mp.centroid\n        # Sum the specified columns\n        for col in ['!s_de', '!s_aus', '!s_all']:\n            record[col] = cluster_points[col].sum()\n        record['cluster'] = f\"{code}_{cluster_id+1}\"\n        records.append(record)\n\n# Create the GeoDataFrame\nuni_c = gpd.GeoDataFrame(records, geometry='geometry', crs=uni.crs)\n\n\n\nThus, unique addresses for individual buildings were grouped not only by code but also by university campus affiliation. Next, geometric centers (centroids) were calculated for each group. This resulted in a transition from 357 points to 54 centroids.\n\nfig, axs  = plt.subplots(1, 2, figsize=(32, 12))\n\npgr.plot(ax=axs[0], facecolor='none', edgecolor='#cccccc', linewidth=0.5, linestyle=\"--\")\nbz.plot(ax=axs[0], facecolor='none', edgecolor='#999999', linewidth=0.75)\nout.plot(ax=axs[0], facecolor='none', edgecolor='#666666', linewidth=1)\nuni.plot(ax=axs[0],\n          column='!s_all',\n          cmap=cmap_pi,\n          markersize = 35,  # Scale marker size\n          alpha=0.9,\n          edgecolor='white',\n          linewidth=0.3,\n          legend=True,\n          legend_kwds={'shrink': 0.6, 'label': \"demand\"},\n          vmin=0,\n          vmax=uni_c['!s_all'].quantile(0.85))  # Cap extremes\naxs[0].set_title(f'a. Higher Education Universities\\n({len(uni_copy)} points)', fontsize=28, pad=15, fontweight='bold')\naxs[0].set_axis_off()\nplt.tight_layout()\n\npgr.plot(ax=axs[1], facecolor='none', edgecolor='#cccccc', linewidth=0.5, linestyle=\"--\")\nbz.plot(ax=axs[1], facecolor='none', edgecolor='#999999', linewidth=0.75)\nout.plot(ax=axs[1], facecolor='none', edgecolor='#666666', linewidth=1)\nuni_c.plot(ax=axs[1],\n          column='!s_all',\n          cmap=cmap_pi,\n          markersize = 35,\n          alpha=0.9,\n          edgecolor='white',\n          linewidth=0.3,\n          legend=True,\n          legend_kwds={'shrink': 0.6, 'label': \"demand\"},\n          vmin=0,\n          vmax=uni_c['!s_all'].quantile(0.85)) # Matching Previous plott\naxs[1].set_title(f\"b. Higher Education Universities Centroids\\n({len(uni_c)} points)\", fontsize=28, pad=15, fontweight='bold')\naxs[1].set_axis_off()\n\nsave_path = os.path.join(hf, \"Higher Education Universities.png\")\nplt.savefig(save_path, dpi=300, bbox_inches=\"tight\")\n\nplt.tight_layout()\nplt.show()\n\n\n\nFigure XX. Visual Comparison Initial Unique Higher Education Universities Addresses with Final Centroids\n\nThe verification method was a manual visual comparison of the final centroids with the original unique addresses in QGIS using the Measure Tool.\n\n","type":"content","url":"/notebooks/urban-data-mining#data-cleaning","position":19},{"hierarchy":{"lvl1":"Automated Data Preparation","lvl2":"Data Export"},"type":"lvl2","url":"/notebooks/urban-data-mining#data-export","position":20},{"hierarchy":{"lvl1":"Automated Data Preparation","lvl2":"Data Export"},"content":"\n\nThe processed data for analysing the capacity and demand for student housing is stored in geographic packages (.gpkg) — an open format for storing geospatial data, which differs from the tabular format (.exel) in that it contains coordinates.\n\nef = r\"../outputs/2.2_urban_data_mining/pbsa.gpkg\"\npbsa.to_file(ef, driver=\"GPKG\")\n\nef = r\"../outputs/2.2_urban_data_mining/pbsa_c.gpkg\"\npbsa_c.to_file(ef, driver=\"GPKG\")\n\nef = r\"../outputs/2.2_urban_data_mining/uni.gpkg\"\nuni_copy.to_file(ef, driver=\"GPKG\")\n\ncf = r\"../outputs/2.2_urban_data_mining/uni_c.gpkg\"\nuni_c.to_file(cf, driver=\"GPKG\")\n\n","type":"content","url":"/notebooks/urban-data-mining#data-export","position":21},{"hierarchy":{"lvl1":"2.3 Descriptive Market Statistics"},"type":"lvl1","url":"/notebooks/descriptive-market-statistics","position":0},{"hierarchy":{"lvl1":"2.3 Descriptive Market Statistics"},"content":"import warnings\n\nwarnings.filterwarnings(\"ignore\")\n\nimport pandas as pd\nimport os\nhf = r'../outputs/2.3_descriptive_market_statistics/'\nos.makedirs(hf, exist_ok=True)\n\n\n\n","type":"content","url":"/notebooks/descriptive-market-statistics","position":1},{"hierarchy":{"lvl1":"2.3 Descriptive Market Statistics"},"type":"lvl1","url":"/notebooks/descriptive-market-statistics#id-2-3-descriptive-market-statistics","position":2},{"hierarchy":{"lvl1":"2.3 Descriptive Market Statistics"},"content":"\n\nIn the 2024/25 winter semester, a total of 49,801 students with non-German citizenship were enrolled. This is more than in the previous winter semester (+1,439). The proportion of international students thus increased from 24.1% to 24.8% (Statistik Berlin Brandenburg, 2025). According to data collected in the Urban Data Mining chapter, the total capacity of planned student accommodation is 25,817 students. In other words, only 51.8% of international students can be accommodated in halls of residence if there is no competition from local German students.\n\nWhile describing a dataset is usually the first task in any analysis, in order to rethink the student housing crisis, it is necessary to use descriptive statistics (also called ‘summary statistics’). Descriptive statistics quickly provide an understanding of data variability and allow for the identification of possible patterns (Grekousis, 2020).\n\n","type":"content","url":"/notebooks/descriptive-market-statistics#id-2-3-descriptive-market-statistics","position":3},{"hierarchy":{"lvl1":"2.3 Descriptive Market Statistics","lvl2":"Set Up"},"type":"lvl2","url":"/notebooks/descriptive-market-statistics#set-up","position":4},{"hierarchy":{"lvl1":"2.3 Descriptive Market Statistics","lvl2":"Set Up"},"content":"\n\nImport Libraries\n\nimport os  \nimport numpy as np \nimport pandas as pd \nimport matplotlib.pyplot as plt \nimport seaborn as sns \nimport matplotlib.patheffects as path_effects \nimport geopandas as gpd \nfrom shapely.geometry import Point, MultiPoint \nfrom pyproj import CRS  \nfrom scipy.stats import norm \n\n\n\nColors\n\ncolor_palettes = {\n    \"Mint\": [\"#EAF4E8\", \"#C8E0D4\", \"#A9CCC1\", \"#8FB9AE\", \"#76A79D\", \"#5F968E\", \"#498581\"], \n    \"Pi\": [\"#F8EDEB\", \"#FAE1DD\", \"#FCD5CE\", \"#FEC5BB\", \"#F8AD9D\", \"#F4978E\", \"#F08080\"],\n    \"Or\": [\"#FFE5D9\", \"#FFD7BA\", \"#FEC89A\", \"#FFB78F\", \"#F49F7D\", \"#F28B6D\", \"#E1755CFF\"],\n    \"GrSc\":  ['#EFEFEF', '#D9D9D9', '#CCCCCC', '#B7B7B7', '#999999', '#666666', '#434343'],\n    \"MintPi\": [\"#76A79D\", \"#8FB9AE\", \"#A9CCC1\", \"#C8E0D4\", \"#FBF0EA\", \"#FCD5CE\", \"#FEC5BB\", \"#F8AD9D\", \"#F4978E\"],\n    \"MintOr\": [\"#76A79D\", \"#8FB9AE\", \"#A9CCC1\", \"#C8E0D4\", \"#FBF0EA\", \"#FFD7BA\", \"#FEC89A\", \"#FFB78F\", \"#F28B6D\"],\n    \"MiPiOr\": ['#EAF4E8', '#FAE1DD', '#C8E0D4', '#FFD7BA', '#F8EDEB', '#FCD5CE', '#FFE5D9']\n} \n\nfrom matplotlib.colors import LinearSegmentedColormap\n\ncmap_mint = LinearSegmentedColormap.from_list(\"Mint\", color_palettes[\"Mint\"])\ncmap_pi = LinearSegmentedColormap.from_list(\"Pi\", color_palettes[\"Pi\"])\ncmap_or = LinearSegmentedColormap.from_list(\"Or\", color_palettes[\"Or\"])\ncmap_mintpi = LinearSegmentedColormap.from_list(\"MintPi\", color_palettes[\"MintPi\"])\ncmap_mintor = LinearSegmentedColormap.from_list(\"MintOr\", color_palettes[\"MintOr\"])\ncmap_grsc = LinearSegmentedColormap.from_list(\"GrSc\", color_palettes[\"GrSc\"])\ncmap_mipior = LinearSegmentedColormap.from_list(\"MiPiOr\", color_palettes[\"MiPiOr\"])\n\n\n\nFont\n\nplt.rcParams[\"font.family\"] = \"Helvetica\"\n\n\n\nBerlin Spatial Boundaries\n\npf = r\"../inputs/2.3_descriptive_market_statistics/lor_pgr.gpkg\"\npgr = gpd.read_file(pf)\npgr.replace({'-': np.nan, 0: np.nan, '': np.nan}, inplace=True)\n\nbf = r\"../inputs/2.3_descriptive_market_statistics/adm_bz.gpkg\"\nbz = gpd.read_file(bf)\nbz.replace({'-': np.nan, 0: np.nan, '': np.nan}, inplace=True)\n\nof = r\"../inputs/2.3_descriptive_market_statistics/adm_out.gpkg\"\nout = gpd.read_file(of)\nout.replace({'-': np.nan, 0: np.nan, '': np.nan}, inplace=True)\n\n\n\n","type":"content","url":"/notebooks/descriptive-market-statistics#set-up","position":5},{"hierarchy":{"lvl1":"Student Accommodation Capacity"},"type":"lvl1","url":"/notebooks/descriptive-market-statistics#student-accommodation-capacity","position":6},{"hierarchy":{"lvl1":"Student Accommodation Capacity"},"content":"\n\nThe geospatial student accommodation data, obtained as a result of Urban Data Mining, served as a base for statistical research.\n\nef = r\"../inputs/2.3_descriptive_market_statistics/pbsa_c.gpkg\"\npbsa_c = gpd.read_file(ef)\n\n\n\n","type":"content","url":"/notebooks/descriptive-market-statistics#student-accommodation-capacity","position":7},{"hierarchy":{"lvl1":"Student Accommodation Capacity","lvl2":"Common Statictics"},"type":"lvl2","url":"/notebooks/descriptive-market-statistics#common-statictics","position":8},{"hierarchy":{"lvl1":"Student Accommodation Capacity","lvl2":"Common Statictics"},"content":"\n\n_s = (\n    pbsa_c['units type']\n        .astype(str)\n        .str.lower()\n        .str.strip()\n)\n\n# Prepare masks without defining functions (future-proof via keyword/regex detection)\nis_single = (\n    _s.str.contains(r\"\\b(single|studio|private|1-bed|one)\\b\", regex=True)\n)\n\nis_double = (\n    _s.str.contains(r\"\\b(double|twin|2-bed|two)\\b\", regex=True)\n)\n\n# Shared: explicit keywords or 3+ bed counts imply shared occupancy\nis_shared = (\n    _s.str.contains(r\"\\b(shared|wg|dorm|multi|[3-9]-bed)\\b\", regex=True)\n    | _s.str.contains(r\"\\b(3|4|5|6|7|8|9)\\b\", regex=True)\n)\n\npbsa_c['unit_type_norm'] = 'other'\npbsa_c.loc[is_shared, 'unit_type_norm'] = 'shared apartment'\npbsa_c.loc[is_double, 'unit_type_norm'] = 'double apartment'\npbsa_c.loc[is_single, 'unit_type_norm'] = 'single apartment'\n\npbsa_c['unit_type_norm'] = pd.Categorical(\n    pbsa_c['unit_type_norm'],\n    categories=['single apartment', 'double apartment', 'shared apartment', 'other'],\n    ordered=True\n)\n\n# Cleanup temporary variables\ndel _s, is_single, is_double, is_shared\n\n\n\nThe numeric fields are the basis for collecting statistics, for which it is possible to calculate the sum (sum), mean (mean), median (median) and standard deviation (std), minimum (min) and maximum (max). In the case of Student Accommodation, such data includes: capacity (!cap) maximum and minimum price (price_min, price_max), maximum and minimum living space (area_min, area_max).\n\ncols_numeric = ['!cap', 'price_min', 'price_max', 'area_min', 'area_max']\n\n\n\nSummary Statistics (Table XX) shows considerable diversity in student accommodation data, as evidenced by significant deviations from the mean value for the main numeric fields (std).\n\nsummary = pbsa_c[cols_numeric].agg(['mean', 'median', 'std', 'min', 'max'])\nsummary = summary.T.round(2)\n\n\nsummary\n\n\n\nTable XX. Student Accommodation Numeric Fields Summary\n\nCapacity indicators (!cap) show significant dispersion (Figure XX), where the median value is equal to the standard deviation (mean ≈ std), reflecting the polarised nature of housing supply — from small private dormitories, for example, Reichsstrasse Dormitory designed for 61 students, to large public-owned residential complexes, such as WH Siegmunds Hof from Studierendenwerk Berlin with more than 500 places.\n\nplt.figure(figsize=(4, 6))\nsns.boxplot(\n    data=pbsa_c,\n    y='!cap',\n    color= '#FEC89A',\n    showmeans=True,\n    meanprops={\n        'marker': 'o',\n        'markerfacecolor': 'white',\n        'markeredgecolor': 'black',\n        'markersize': '8'\n    }\n)\nplt.title('Student Accommodation Capacity Distribution', fontsize=10, weight='bold')\nplt.ylabel('сapacity (!cap)')\nplt.grid(axis='y', linestyle='--', alpha=0.4)\n\nsave_path = os.path.join(hf, \"Student Accommodation Capacity Distribution.png\")\nplt.savefig(save_path, dpi=300, bbox_inches=\"tight\")\n\nplt.tight_layout()\nplt.show()\n\n\n\nFigure XX. Student Accommodation Capacity Distribution\n\nThe Student Accommodation Capacity Normal Distribution Histogram (Figure XX) shows that student accommodation consists of small halls of residence with fewer than 300 students, indicating fragmentation and a small scale of supply within Berlin’s existing urban structure.\n\nOnly a few large complexes exceed 600–800 places, reflecting isolated high-density developments, often located on the periphery or on redeveloped sites.\n\nf, axs = plt.subplots(figsize=(6, 6)) \n\n#---------------------------------------- 1 ------------------------------------------------------------\nx_min = pbsa_c['!cap'].min()\nx_max = pbsa_c['!cap'].max()\n\nbins = len(pbsa_c) // 5  # Number of bins based on data size\nax = axs  # First subplot: axs[0]\n\nmu, std = norm.fit(pbsa_c['!cap'])\nx = np.linspace(x_min, x_max, 100)\np = norm.pdf(x, mu, std)\nnd_pbsa_c = mu-2*std\nhist_area = len(pbsa_c['!cap']) * (x_max - x_min) / bins\nscaled_p = p * hist_area\n\n# Plot histogram\nax.hist(pbsa_c['!cap'], bins=bins, color='#FEC89A', alpha=0.7, density=False)\n\n# Plot normal distribution curve\nax.plot(x, scaled_p, color='#cccccc')\nax.axvline(mu, color='#F28B6D', linestyle='--', label=f'mean: {mu:.1f}')\nax.axvline(mu + 2*std, color='#cccccc', linestyle='--', alpha=0.5, label=f'+2σ: {mu+2*std:.1f}')\nax.axvline(mu - 2*std, color='#cccccc', linestyle='--', alpha=0.5, label=f'-2σ: {mu-2*std:.1f}')\n\nax.set_xlim(x_min, x_max)\nax.set_xlabel('capasity (!cap)', fontsize=10)\nax.set_ylabel('frequency', fontsize=10)\nax.set_title('Student Accommodation Capacity Normal Distribution Histogram', fontsize=12, pad=8, fontweight='bold')\nax.legend(loc='best', frameon=False)\n\nsave_path = os.path.join(hf, \"Student Accommodation Capacity Normal Distribution.png\")\nplt.savefig(save_path, dpi=300, bbox_inches=\"tight\")\n\nplt.tight_layout()\nplt.show()\n\n\n\nFigure XX. Student Accommodation Capacity Normal Distribution Histogram\n\nPrice Distribution (Figure XX) shows a clear disparity between minimum and maximum student accommodation prices in Berlin, illustrating both baseline affordability constraints and significant upper-end price volatility. Minimum prices on average are 447€ ± 136€, which aligns with Berlin’s Mietspiegel, suggesting a relatively narrow—but still high—cost floor for most students. In contrast, maximum prices have multiple high-value outliers, reaching above 1,400€, indicating the presence of hight-cost or highly commodified units within the market.\n\nWhen discussing student housing prices, it is important to remember that housing is a human right. (Lefebvre, 1968), not an object of trade. The Berlin Constitution clearly state: Everyone has the right to adequate housing. The state promotes the creation and provision of adequate housing, especially for people on low incomes, and the cultivation of condominium ownership. Students can be seen as people of low income, who can not afford such hight-cost options.\n\nfig, axs = plt.subplots(1, 2, figsize=(8, 6))   # 1 row, 2 columns\n\nsns.boxplot(\n    ax=axs[0],                          # <-- *zero‑based* index\n    data=pbsa_c,\n    y='price_min',\n    color='#FFD7BA',\n    showmeans=True,\n    meanprops={\n        'marker': 'o',\n        'markerfacecolor': 'white',\n        'markeredgecolor': 'black',\n        'markersize': 8\n    }\n)\naxs[0].set_title('Student Accommodation\\nMinimum Price Distribution',\n                 fontsize=10, fontweight='bold')\naxs[0].set_ylabel('minimum price (price_min)')\naxs[0].grid(axis='y', linestyle='--', alpha=0.4)\n\nsns.boxplot(\n    ax=axs[1],                          # <-- second subplot\n    data=pbsa_c,\n    y='price_max',\n    color='#FFB78F',\n    showmeans=True,\n    meanprops={\n        'marker': 'o',\n        'markerfacecolor': 'white',\n        'markeredgecolor': 'black',\n        'markersize': 8\n    }\n)\naxs[1].set_title('Student Accommodation\\nMaximum Price Distribution',\n                 fontsize=10, fontweight='bold')\naxs[1].set_ylabel('maximum price (price_max)')\naxs[1].grid(axis='y', linestyle='--', alpha=0.4)\n\nsave_path = os.path.join(hf, \"Student Accommodation Maximum Price Distribution.png\")\nplt.savefig(save_path, dpi=300, bbox_inches=\"tight\")\n\nfig.tight_layout()  \nplt.show()\n\n\n\nFigure XX. Student Accommodation Price Distribution\n\nSpatial characteristics (area_min, area_max) demonstrate additional heterogeneity — living spaces range from compact studios (<12 m², σ=±4.7) to spacious shared flats (>40 m², σ=±11.2), illustrating differences in the morphology of student housing.\n\nfig, axs = plt.subplots(1, 2, figsize=(8, 6))   # 1 row, 2 columns\n\nsns.boxplot(\n    ax=axs[0],                          # <-- *zero‑based* index\n    data=pbsa_c,\n    y='area_min',\n    color='#FFD7BA',\n    showmeans=True,\n    meanprops={\n        'marker': 'o',\n        'markerfacecolor': 'white',\n        'markeredgecolor': 'black',\n        'markersize': 8\n    }\n)\naxs[0].set_title('Student Accommodation\\nLiving Area Minimum Distribution',\n                 fontsize=10, fontweight='bold')\naxs[0].set_ylabel('living area minimum (area_min)')\naxs[0].grid(axis='y', linestyle='--', alpha=0.4)\n\nsns.boxplot(\n    ax=axs[1],                          # <-- second subplot\n    data=pbsa_c,\n    y='area_max',\n    color='#FFB78F',\n    showmeans=True,\n    meanprops={\n        'marker': 'o',\n        'markerfacecolor': 'white',\n        'markeredgecolor': 'black',\n        'markersize': 8\n    }\n)\naxs[1].set_title('Student Accommodation\\nLiving Area Maximum Distribution',\n                 fontsize=10, fontweight='bold')\naxs[1].set_ylabel('living area maximum (area_max)')\naxs[1].grid(axis='y', linestyle='--', alpha=0.4)\n\nsave_path = os.path.join(hf, \"Student Accommodation Area Distribution.png\")\nplt.savefig(save_path, dpi=300, bbox_inches=\"tight\")\n\nfig.tight_layout()  \nplt.show()\n\n\n\nFigure XX. Student Accommodation Living Area Distribution\n\nThe significant variability (Table XX) identified at the beginning of the chapter requires additional statistical processing. The heterogeneity essentially reflects the fragmented housing market in Berlin, where supply imbalances lead to differences in housing typology across different urban areas.\n\nFor a more detailed analysis of the housing market and evaluation of numeric data, student accommodations were divided into groups according to ownership model (own).\n\n","type":"content","url":"/notebooks/descriptive-market-statistics#common-statictics","position":9},{"hierarchy":{"lvl1":"Student Accommodation Capacity","lvl2":"Ownership Model"},"type":"lvl2","url":"/notebooks/descriptive-market-statistics#ownership-model","position":10},{"hierarchy":{"lvl1":"Student Accommodation Capacity","lvl2":"Ownership Model"},"content":"\n\nKey Student Accommodation Ownership Companies (Table XX) are the state-owned companies Studierendenwerk Berlin, Berlinovo, Degewo and the private companies Home in Berlin GmbH and Campus Viva GmbH. Together, these five companies own 68.9% of the student accommodation market.\n\nsummary_ownership = (pbsa_c.groupby('ownership', dropna=False)[cols_numeric].agg(['sum', 'mean', 'median', 'std']).round(2))\n\nsummary_ownership.sort_values(by=('!cap', 'sum'), ascending=False, inplace=True)\n\nsummary_ownership.head(5)\n\n\n\nTable XX. Key Student Accommodation Ownership Companies\n\nWhen dividing student accommodation into state and privately owned, the gap between the minimum and maximum prices (price_min and price_max) for monthly rent for different ownership models become evident. Table XX analyses the numerical fields for student accommodation according to different ownership types.\n\nThe capacity of state and private accommodation differs slightly. Nevertheless, prices for state-owned accommodation vary from €368 to €439, while privately owned accommodation costs significantly more: from €590 to €968.\n\nAt the same time, the minimum income for students set by the Federal Foreign Office in 2025 for foreign students to obtain a visa is €992 per month. This makes private accommodation unaffordable for most international students.\n\nReducing the price gap between state and private accommodation through price regulation could be part of the solution to the student housing crisis.\n\nsummary_ownership_model = (\n    pbsa_c\n    .groupby('ownership_model', dropna=False)[cols_numeric]\n    .agg(['mean', 'median', 'std']).round(2)\n    .sort_index()\n)\n\nsummary_ownership_model\n\n\n\nTable XX. Student Accommodation Ownership Model Numeric Fields Summary\n\nDespite their inaccessibility in terms of cost, private student accommodation accounts for 34.3% of the market supply (Figure XX). Private accommodation is not uncommon – it houses about one-fifth of all international students. This suggests that the private market should be regulated systematically, rather than on a case-by-case basis.\n\ncap_by_own = pbsa_c.groupby('ownership_model')['!cap'].sum()\n\nfig, ax = plt.subplots(figsize=(6,6))\n\ndef make_autopct(values):\n    \"\"\"Return a function that displays: `perct%  \\n[count]`.\"\"\"\n    total = sum(values)\n\n    def my_autopct(pct):\n        # `pct` is the percent that plt.pie passes to the function\n        count = int(round(pct * total / 100.0))\n        return f\"{pct:.1f}%\\n{count:,}\"      # comma as thousand‑separator\n\n    return my_autopct\n\nax.pie(\n    cap_by_own,\n    labels=cap_by_own.index,   # Private / Public (or whatever you have)\n    autopct=make_autopct(cap_by_own),         # percent to 1 decimal place\n    startangle=90,             # nicer start position\n    colors=['#FEC89A','#A9CCC1']   # mint + orange – change if you prefer\n)\nax.set_title('Student Accommodation Capacity Distribution by Ownership Model', fontsize=10)\nax.axis('equal')                # keep the circle round\n\nsave_path = os.path.join(hf, \"Student Accommodation Capacity Distribution by Ownership Model.png\")\nplt.savefig(save_path, dpi=300, bbox_inches=\"tight\")\n\nplt.tight_layout()\nplt.show()\n\n\n\nFigure XX. Student Accommodation Capacity Distribution by Ownership Model\n\nfrom matplotlib.colors import ListedColormap\n\nmint_colour   = '#A9CCC1'  # light‑mint – for Private\norange_colour = '#FEC89A'\n\nownership_cmap = ListedColormap([ orange_colour, mint_colour])\n\n\n\nThe map (Figure XX) illustrates the spatial distribution of student housing in Berlin by ownership model, revealing clear structural patterns that contribute to the ongoing student housing crisis in the city.\n\nPublic residences are more evenly distributed across the periphery, reflecting their role as affordable, welfare-oriented infrastructure, but their limited density indicates insufficient public capacity relative to demand.\n\nPrivate facilities are more concentrated in central areas and high-demand areas, particularly in Mitte, Friedrichshain-Kreuzberg and Charlottenburg-Wilmersdorf, reflecting market logic that prioritises profitable locations with high rents over equal access.\n\nfig, ax  = plt.subplots(figsize=(18, 12))\n\npgr.plot(ax=ax, facecolor='none', edgecolor='#cccccc', linewidth=0.5, linestyle=\"--\")\nbz.plot(ax=ax, facecolor='none', edgecolor='#999999', linewidth=0.75)\nfor idx, row in bz.iterrows():\n    centroid = row['geometry'].centroid\n    txt = ax.text(\n        centroid.x, centroid.y,\n        str(row['namgem']),\n        fontsize=8, color='#666666', ha='center', va='center'\n    )\n    txt.set_path_effects([\n        path_effects.Stroke(linewidth=2, foreground='white'),\n        path_effects.Normal()\n    ])\nout.plot(ax=ax, facecolor='none', edgecolor='#666666', linewidth=1)\npbsa_c.plot(\n    ax=ax,\n    column='ownership_model',      # <─ this forces colour by group\n    cmap=ownership_cmap,           # <─ two‑colour palette\n    markersize=np.sqrt(pbsa_c['!cap'])*2,   # capacity → point size\n    alpha=0.9,\n    edgecolor='white',\n    linewidth=0.3,\n    legend=True, \n    legend_kwds={'title': 'Ownership model','frameon': False       }         \n    )\n\nax.set_title('Student Accommodation Spatial Distribution by Ownership Model', fontsize=14, pad=15, fontweight='bold')\nax.set_axis_off()\n\nsave_path = os.path.join(hf, \"Student Accommodation Spatial Distribution by Ownership Model.png\")\nplt.savefig(save_path, dpi=300, bbox_inches=\"tight\")\n\nplt.tight_layout()\nplt.show()\n\n\n\nFigure XX. Student Accommodation Spatial Distribution by Ownership Model\n\nTwo histograms (Figure XX) show that public and private student residences in Berlin have almost identical average capacities (≈290–300 places), but their distribution differs in aspects that are relevant to the housing crisis.\n\nPublic facilities have a wider range, including several large complexes with more than 900 places (e.g. WH Coppistraße, Iranische Straße, Ludwig-Renn-Straße Hellersdorf, WH Aristotelessteig), reflecting their role in providing significant long-term public capacity.\n\nIn private student accommodation, by contrast, small and medium-sized facilities predominate, with fewer large complexes, indicating a market that tends to prioritise scattered, small investments over large-scale projects.\n\nThe public sector is at least attempting to implement large projects, while private supply remains fragmented.\n\nf, axs = plt.subplots(1, 2, figsize=(12, 6))\n\npbsa_so = pbsa_c[pbsa_c['ownership_model'] == 'State-Owned']  # Filter out extreme outliers\nx_min = pbsa_so['!cap'].min()\nx_max = pbsa_so['!cap'].max()\n\n# bins = len(pbsa_so)//5\nbins = 20 \n\nax = axs[0]  \n\nmu, std = norm.fit(pbsa_so['!cap'])\nx = np.linspace(x_min, x_max, 100)\np = norm.pdf(x, mu, std)\nnd_pbsa_so = mu-2*std\nhist_area = len(pbsa_so['!cap']) * (x_max - x_min) / bins\nscaled_p = p * hist_area\n\n# Plot histogram\nax.hist(pbsa_so['!cap'], bins=bins, color='#A9CCC1', alpha=0.7, density=False)\n\n# Plot normal distribution curve\nax.plot(x, scaled_p, color='#cccccc')\nax.axvline(mu, color='#76A79D', linestyle='--', label=f'mean: {mu:.1f}')\nax.axvline(mu + 2*std, color='#cccccc', linestyle='--', alpha=0.5, label=f'+2σ: {mu+2*std:.1f}')\nax.axvline(mu - 2*std, color='#cccccc', linestyle='--', alpha=0.5, label=f'-2σ: {mu-2*std:.1f}')\nax.set_xlim(x_min, x_max)\nax.set_ylim(0, 16)\n\nax.set_xlabel('capasity (!cap)', fontsize=10)\nax.set_ylabel('frequency', fontsize=10)\nax.set_title('State Owned Student Accommodation Capacity Distribution', fontsize=12, pad=8, fontweight='bold')\nax.legend(loc='upper right', frameon=False)\nplt.tight_layout()\n\n#----------------------------------------2------------------------------------------------------------\n\npbsa_po = pbsa_c[pbsa_c['ownership_model'] == 'Privat-Owned']  # Filter out extreme outliers\nx_min = pbsa_so['!cap'].min()\nx_max = pbsa_so['!cap'].max()\n\nbins = 20 # Number of bins based on data size\nax = axs[1]  \n\nmu, std = norm.fit(pbsa_po['!cap'])\nx = np.linspace(x_min, x_max, 100)\np = norm.pdf(x, mu, std)\nnd_pbsa_po = mu-2*std\nhist_area = len(pbsa_po['!cap']) * (x_max - x_min) / bins\nscaled_p = p * hist_area\n\n# Plot histogram\nax.hist(pbsa_po['!cap'], bins=bins, color='#FEC89A', alpha=0.7, density=False)\n\n# Plot normal distribution curve\nax.plot(x, scaled_p, color='#cccccc')\nax.axvline(mu, color='#F28B6D', linestyle='--', label=f'mean: {mu:.1f}')\nax.axvline(mu + 2*std, color='#cccccc', linestyle='--', alpha=0.5, label=f'+2σ: {mu+2*std:.1f}')\nax.axvline(mu - 2*std, color='#cccccc', linestyle='--', alpha=0.5, label=f'-2σ: {mu-2*std:.1f}')\n\nax.set_xlim(x_min, x_max)\nax.set_ylim(0, 16)\n\nax.set_xlabel('capasity (!cap)', fontsize=10)\nax.set_ylabel('frequency', fontsize=10)\nax.set_title('Private Owned Student Accommodation Capacity Distribution', fontsize=12, pad=8, fontweight='bold')\nax.legend(loc='upper right', frameon=False)\n\n\nsave_path = os.path.join(hf, \"State and Private Owned Student Accommodation Normal Capacity Distribution Comparison.png\")\nplt.savefig(save_path, dpi=300, bbox_inches=\"tight\")\n\nplt.tight_layout\nplt.show()\n\n\n\n\nFigure XX. State and Private Owned Student Accommodation Normal Capacity Distribution Comparison\n\nThis division highlights a fundamental problem: public student housing is too infrequent and located on the outskirts to offset affordability pressures, while private housing is concentrated in the most expensive areas. As a result, students face geographical and financial mismatches, reinforcing the need for data-driven planning strategies that rebalance supply, expand capacity, and redirect development to underserved areas.\n\n","type":"content","url":"/notebooks/descriptive-market-statistics#ownership-model","position":11},{"hierarchy":{"lvl1":"Student Accommodation Capacity","lvl2":"Housing Unit Type"},"type":"lvl2","url":"/notebooks/descriptive-market-statistics#housing-unit-type","position":12},{"hierarchy":{"lvl1":"Student Accommodation Capacity","lvl2":"Housing Unit Type"},"content":"\n\nsummary_unit_type = (\n    pbsa_c\n    .groupby('unit_type_norm', dropna=False)[cols_numeric]\n    .agg(['mean', 'median', 'std']).round(2)\n    .sort_index()\n)\n\nsummary_unit_type\n\n\n\nFull descriptive statistics on student accommodation are available for review in the Materials & Data chapter.\n\noutput_path = r\"../outputs/2.3_descriptive_market_statistics/student_acomodation_statictics.xlsx\" \n\n# Write DataFrames to separate sheets in one Excel file\nwith pd.ExcelWriter(output_path, engine='openpyxl') as writer:\n    summary.to_excel(writer, sheet_name='common_statistics')\n    summary_ownership.to_excel(writer, sheet_name='by_ownership')\n    summary_ownership_model.to_excel(writer, sheet_name='by_ownership_model')\n    summary_unit_type.to_excel(writer, sheet_name='by_unit_type')\n\n\n\n","type":"content","url":"/notebooks/descriptive-market-statistics#housing-unit-type","position":13},{"hierarchy":{"lvl1":"Higher Education Universities Students Demand"},"type":"lvl1","url":"/notebooks/descriptive-market-statistics#higher-education-universities-students-demand","position":14},{"hierarchy":{"lvl1":"Higher Education Universities Students Demand"},"content":"\n\nThe higher education universities’ geospatial data, obtained as a result of Urban Data Mining, served as a base for statistical research.\n\ncf = r\"../inputs/2.3_descriptive_market_statistics/uni_c.gpkg\"\nuni_c = gpd.read_file(cf)\n\n\n\n","type":"content","url":"/notebooks/descriptive-market-statistics#higher-education-universities-students-demand","position":15},{"hierarchy":{"lvl1":"Higher Education Universities Students Demand","lvl2":"Common Statictics"},"type":"lvl2","url":"/notebooks/descriptive-market-statistics#common-statictics-1","position":16},{"hierarchy":{"lvl1":"Higher Education Universities Students Demand","lvl2":"Common Statictics"},"content":"\n\nIn the case of Higher Education Universities, the numerical data are the number of German students (!s_de), the number of foreign students (!s_aus) and the total number of students (!s_all).\n\ncols_numeric = ['!s_all', '!s_de', '!s_aus']\n\n\n\nHigher Education Universities Data (Table XX) shows a sharp difference in student numbers between universities in Berlin. The average university enrolment is 3,720 students, but a typical university (median 842 places) is 4.4 times smaller. This means that several large universities take on the main part of the load (such as Free University, Humboldt University and Technical University of Berlin).\n\nForeign students make up 24.1% of the total, meaning that one in five students in Berlin is a foreigner. Comparing the standard deviations for German and foreign students, one can see segmentation based on nationality, which manifests itself in a 3.3-times higher dispersion of German students than foreign students, revealing a cluster model of foreign student placement in large state universities. It is noteworthy that Free University (8,280 foreign students), Humboldt University (6,415 foreign students) and Technical University of Berlin (10,262 foreign students) account for 24,957 foreign students, or 51.5% of total international student demand.\n\nsummary = uni_c[cols_numeric].agg(['mean', 'median', 'std', 'sum'])\nsummary = summary.T.round(2)\n\nsummary\n\n\n\nTable XX. Higher Education Universities Numeric Fields Summary\n\nFree University, Humboldt University and Technical University Berlin are exceptions to the rule (or so-called ‘statistical outliers’). Most universities have up to 600 students. Thus, Higher Education Universities Students Demand Distribution (Figure XX) is far from normal.\n\nf, axs = plt.subplots(figsize=(6, 6)) \n\n#---------------------------------------- 1 ------------------------------------------------------------\nx_min = uni_c['!s_aus'].min()\nx_max = uni_c['!s_aus'].max()\n\nbins = len(uni_c) // 5  # Number of bins based on data size\nax = axs  # First subplot: axs[0]\n\nmu, std = norm.fit(uni_c['!s_aus'])\nx = np.linspace(x_min, x_max, 100)\np = norm.pdf(x, mu, std)\nnd_uni_c = mu-2*std\nhist_area = len(uni_c['!s_aus']) * (x_max - x_min) / bins\nscaled_p = p * hist_area\n\n# Plot histogram\nax.hist(uni_c['!s_aus'], bins=bins, color='#FCD5CE', alpha=0.7, density=False)\n\n# Plot normal distribution curve\nax.plot(x, scaled_p, color='#cccccc')\nax.axvline(mu, color='#F8AD9D', linestyle='--', label=f'mean: {mu:.1f}')\nax.axvline(mu + 2*std, color='#cccccc', linestyle='--', alpha=0.5, label=f'+2σ: {mu+2*std:.1f}')\nax.axvline(mu - 2*std, color='#cccccc', linestyle='--', alpha=0.5, label=f'-2σ: {mu-2*std:.1f}')\n\nax.set_xlim(x_min, x_max)\nax.set_xlabel(' demand (!s_aus)', fontsize=10)\nax.set_ylabel('frequency', fontsize=10)\nax.set_title('Higher Education Universities Students Demand Normal Distribution Histogram', fontsize=12, pad=8, fontweight='bold')\nax.legend(loc='best', frameon=False)\n\nsave_path = os.path.join(hf, \"Higher Education Universities Students Demand Normal Distribution Histogram.png\")\nplt.savefig(save_path, dpi=300, bbox_inches=\"tight\")\n\nplt.tight_layout()\nplt.show()\n\n\n\nFigure XX. Higher Education Universities Students Demand Normal Distribution Histogram\n\nIn order to gain a deeper understanding of the imbalance in supply, by analogy with student accommodations, higher education universities can be divided into two groups based on their ownership model (own): Public and Private Universities.\n\n","type":"content","url":"/notebooks/descriptive-market-statistics#common-statictics-1","position":17},{"hierarchy":{"lvl1":"Higher Education Universities Students Demand","lvl2":"Ownership Model"},"type":"lvl2","url":"/notebooks/descriptive-market-statistics#ownership-model-1","position":18},{"hierarchy":{"lvl1":"Higher Education Universities Students Demand","lvl2":"Ownership Model"},"content":"\n\nHigher Education Universities Ownership Model Numeric Fields Summary (Figure XX) shows a dramatic structural difference between public and private higher education institutions in Berlin. Public universities dominate the academic landscape, accepting an average of more than 9,000 students per institution, while private universities accept fewer than 1,000 students. This gap persists among both German and foreign students: public universities enrol the majority of German students (an average of ≈ 7,100) and attract significantly more foreign students (an average of ≈ 2,000) than private institutions.\n\nThe much higher overall figures and variability in the public sector highlight the concentrated demand pressure on public universities, which are the main drivers of the student housing market.\n\nsummary_ownership_model = (\n    uni_c\n    .groupby('own', dropna=False)[cols_numeric]\n    .agg(['mean', 'median', 'std', 'sum']).round(2)\n    .sort_index()\n)\n\nsummary_ownership_model\n\n\n\nTable XX. Higher Education Universities Ownership Model Numeric Fields Summary\n\nPrivate universities contribute less significantly to the total number of students (Figure XX). Nevertheless, 22.1% of foreign students choose private universities for their education. Of all students at private universities, 38% are foreigners (vs. 22% at state universities).\n\nstud_aus_by_own = uni_c.groupby('own')['!s_aus'].sum()\n\nfig, ax = plt.subplots(figsize=(6,6))\n\ndef make_autopct(values):\n    \"\"\"Return a function that displays: `perct%  \\n[count]`.\"\"\"\n    total = sum(values)\n\n    def my_autopct(pct):\n        # `pct` is the percent that plt.pie passes to the function\n        count = int(round(pct * total / 100.0))\n        return f\"{pct:.1f}%\\n{count:,}\"      # comma as thousand‑separator\n\n    return my_autopct\n\nax.pie(\n    stud_aus_by_own,\n    labels=stud_aus_by_own.index,   # Private / Public (or whatever you have)\n    autopct=make_autopct(stud_aus_by_own),         # percent to 1 decimal place\n    startangle=90,             # nicer start position\n    colors=['#FEC5BB','#A9CCC1']   # mint + orange – change if you prefer\n)\nax.set_title('Higher Education Universities Demand Distribution by Ownership Model', fontsize=10)\nax.axis('equal')                # keep the circle round\n\nsave_path = os.path.join(hf, \"Higher Education Universities Demand Distribution by Ownership Model.png\")\nplt.savefig(save_path, dpi=300, bbox_inches=\"tight\")\n\nplt.tight_layout()\nplt.show()\n\n\n\nFigure XX. Higher Education Universities Demand Distribution by Ownership Model\n\nThe spatial distribution of higher education institutions in Berlin (Figure XX) shows a strong central concentration of private universities, in contrast to the more dispersed location of public universities throughout the city.\n\nPrivate universities are mainly concentrated in Mitte, Charlottenburg-Wilmersdorf and Friedrichshain-Kreuzberg – areas that are already characterised by high demand for housing – while public universities occupy both central areas and more peripheral areas such as Lichtenberg, Steglitz-Zehlendorf and Treptow-Köpenick. This uneven geography increases spatial inequality in the demand for student housing: large public universities create high pressure on the housing market across the city, while private universities add local spikes in demand in already highly densely populated central areas.\n\nFor large public universities, state-owned dormitories remain a priority, while the private sector requires integration into the urban housing ecosystem and lower prices as a market driver that is developing faster than the public sector.\n\nThe map highlights a broader structural problem: the spatial logic of Berlin’s university system does not correspond to the distribution of student housing, exacerbating the city’s ongoing student housing crisis.\n\nfrom matplotlib.colors import ListedColormap\n\nmint_colour   = '#A9CCC1'  # light‑mint – for Private\norange_colour = '#FCD5CE'\n\nownership_cmap = ListedColormap([ orange_colour, mint_colour])\n\n\n\nfig, ax  = plt.subplots(figsize=(18, 12))\n\npgr.plot(ax=ax, facecolor='none', edgecolor='#cccccc', linewidth=0.5, linestyle=\"--\")\nbz.plot(ax=ax, facecolor='none', edgecolor='#999999', linewidth=0.75)\nfor idx, row in bz.iterrows():\n    centroid = row['geometry'].centroid\n    txt = ax.text(\n        centroid.x, centroid.y,\n        str(row['namgem']),\n        fontsize=8, color='#666666', ha='center', va='center'\n    )\n    txt.set_path_effects([\n        path_effects.Stroke(linewidth=2, foreground='white'),\n        path_effects.Normal()\n    ])\nout.plot(ax=ax, facecolor='none', edgecolor='#666666', linewidth=1)\nuni_c.plot(\n    ax=ax,\n    column='own',      # <─ this forces colour by group\n    cmap=ownership_cmap,           # <─ two‑colour palette\n    markersize=np.sqrt(pbsa_c['!cap'])*2,   # capacity → point size\n    alpha=0.9,\n    edgecolor='white',\n    linewidth=0.3,\n    legend=True, \n    legend_kwds={'title': 'Ownership model','frameon': False       }         \n    )\n\nax.set_title('Higher Education Universities Spatial Distribution by Ownership Model', fontsize=14, pad=15, fontweight='bold')\nax.set_axis_off()\n\nsave_path = os.path.join(hf, \"Higher Education Universities Spatial Distribution by Ownership Model.png\")\nplt.savefig(save_path, dpi=300, bbox_inches=\"tight\")\n\nplt.tight_layout()\nplt.show()\n\n\n\nFigure XX. Higher Education Universities Spatial Distribution by Ownership Model\n\nTwo histograms (Figure XX) show that public and private universities in Berlin have different demand indicators: 1,986 for public universities and 306 for private universities.\n\nPublic universities have a wider range, including several large complexes with more than 8,000 students. (e.g., Technical University of Berlin and Free University of Berlin), indicating a high concentration of international demand in a limited number of campuses.\n\nIn private halls of residence, on the other hand, the distribution is more compact, but still spread out. The vast majority of private universities have low or medium demand, while large complexes have up to 2,500 international students.\n\nThe contrast between the two distributions confirms that the housing demand of international students in Berlin is unevenly distributed, creating local areas of market overload.\n\nf, axs = plt.subplots(1, 2, figsize=(12, 6))\n\nuni_so = uni_c[uni_c['own'] == 'Public University']  # Filter out extreme outliers\nx_min = uni_so['!s_aus'].min()\nx_max = uni_so['!s_aus'].max()\n\n# bins = len(uni_so)//5\nbins = 20 \n\nax = axs[0]  \n\nmu, std = norm.fit(uni_so['!s_aus'])\nx = np.linspace(x_min, x_max, 100)\np = norm.pdf(x, mu, std)\nnd_uni_so = mu-2*std\nhist_area = len(uni_so['!s_aus']) * (x_max - x_min) / bins\nscaled_p = p * hist_area\n\n# Plot histogram\nax.hist(uni_so['!s_aus'], bins=bins, color='#A9CCC1', alpha=0.7, density=False)\n\n# Plot normal distribution curve\nax.plot(x, scaled_p, color='#cccccc')\nax.axvline(mu, color='#76A79D', linestyle='--', label=f'mean: {mu:.1f}')\nax.axvline(mu + 2*std, color='#cccccc', linestyle='--', alpha=0.5, label=f'+2σ: {mu+2*std:.1f}')\nax.axvline(mu - 2*std, color='#cccccc', linestyle='--', alpha=0.5, label=f'-2σ: {mu-2*std:.1f}')\n\nax.set_xlim(x_min, x_max)\nax.set_ylim(0, 10)\n\nax.set_xlabel('demand (!s_aus)', fontsize=10)\nax.set_ylabel('frequency', fontsize=10)\nax.set_title('Public Higher Education Universities International Student Demand Distribution', fontsize=12, pad=8, fontweight='bold')\nax.legend(loc='upper right', frameon=False)\nplt.tight_layout()\n\n#----------------------------------------2------------------------------------------------------------\n\nuni_po = uni_c[uni_c['own'] == 'Privat University']  # Filter out extreme outliers\nx_min = uni_po['!s_aus'].min()\nx_max = uni_po['!s_aus'].max()\n\nbins = 20 # Number of bins based on data size\nax = axs[1]  \n\nmu, std = norm.fit(uni_po['!s_aus'])\nx = np.linspace(x_min, x_max, 100)\np = norm.pdf(x, mu, std)\nnd_uni_po = mu-2*std\nhist_area = len(uni_po['!s_aus']) * (x_max - x_min) / bins\nscaled_p = p * hist_area\n\n# Plot histogram\nax.hist(uni_po['!s_aus'], bins=bins, color='#FCD5CE', alpha=0.7, density=False)\n\n# Plot normal distribution curve\nax.plot(x, scaled_p, color='#cccccc')\nax.axvline(mu, color='#F8AD9D', linestyle='--', label=f'mean: {mu:.1f}')\nax.axvline(mu + 2*std, color='#cccccc', linestyle='--', alpha=0.5, label=f'+2σ: {mu+2*std:.1f}')\nax.axvline(mu - 2*std, color='#cccccc', linestyle='--', alpha=0.5, label=f'-2σ: {mu-2*std:.1f}')\n\nax.set_xlim(x_min, x_max)\nax.set_ylim(0, 10)\n\nax.set_xlabel('demand (!s_aus)', fontsize=10)\nax.set_ylabel('frequency', fontsize=10)\nax.set_title('Privat Higher Education Universities International Student Demand Distribution', fontsize=12, pad=8, fontweight='bold')\nax.legend(loc='upper right', frameon=False)\n\nsave_path = os.path.join(hf, \"Public and Private Owned Higher Education Universities International Student Demand Distribution Comparison.png\")\nplt.savefig(save_path, dpi=300, bbox_inches=\"tight\")\n\nplt.tight_layout()\nplt.show()\n\n\n\nFigure XX. Public and Private Owned Higher Education Universities International Student Demand Distribution Comparison\n\n","type":"content","url":"/notebooks/descriptive-market-statistics#ownership-model-1","position":19},{"hierarchy":{"lvl1":"Higher Education Universities Students Demand","lvl2":"University Type"},"type":"lvl2","url":"/notebooks/descriptive-market-statistics#university-type","position":20},{"hierarchy":{"lvl1":"Higher Education Universities Students Demand","lvl2":"University Type"},"content":"\n\nsummary_uni_type = (\n    uni_c\n    .groupby('stud', dropna=False)[cols_numeric]\n    .agg(['mean', 'median', 'std', 'sum'\n          ]).round(2)\n    .sort_index()\n)\n\nsummary_uni_type\n\n\n\nFull descriptive statistics on student accommodation are available for review in the Materials and Data Chapter.\n\noutput_path = r\"../outputs/2.3_descriptive_market_statistics/higher_education_universities.xlsx\" \n\n# Write DataFrames to separate sheets in one Excel file\nwith pd.ExcelWriter(output_path, engine='openpyxl') as writer:\n    summary.to_excel(writer, sheet_name='common_statistics')\n    summary_ownership_model.to_excel(writer, sheet_name='by_ownership_model')\n    summary_uni_type.to_excel(writer, sheet_name='by_uni_type')\n\n","type":"content","url":"/notebooks/descriptive-market-statistics#university-type","position":21},{"hierarchy":{"lvl1":"2.4 Global Spatial Autocorrelation"},"type":"lvl1","url":"/notebooks/global-spatial-autocorrelation","position":0},{"hierarchy":{"lvl1":"2.4 Global Spatial Autocorrelation"},"content":"import warnings\n\nwarnings.filterwarnings(\"ignore\")\n\nimport os\nhf = r'../outputs/2.4_global_spatial_autocorrelation/'\nos.makedirs(hf, exist_ok=True)\n\n\n\n","type":"content","url":"/notebooks/global-spatial-autocorrelation","position":1},{"hierarchy":{"lvl1":"2.4 Global Spatial Autocorrelation"},"type":"lvl1","url":"/notebooks/global-spatial-autocorrelation#id-2-4-global-spatial-autocorrelation","position":2},{"hierarchy":{"lvl1":"2.4 Global Spatial Autocorrelation"},"content":"\n\nIn the Descriptive Market Statistics Chapter, a descriptive analysis of two datasets was conducted: student accommodations and higher education universities. However, in order to access spatial distribution across cities, it is necessary to measure spatial dependency.\n\nSpatial autocorrelation measures spatial dependency. In other words, how much the value of a variable in a specific location is related to the values of the same variable at neighboring locations. Spatial autocorrelation (either positive or negative) is a key concept in geographic analysis. Spatial autocorrelation can be explained by the first law of geography. According to the law, objects in a neighborhood tend to have more similarities and interactions than those lying further away (Grekousis, 2020).\n\n","type":"content","url":"/notebooks/global-spatial-autocorrelation#id-2-4-global-spatial-autocorrelation","position":3},{"hierarchy":{"lvl1":"2.4 Global Spatial Autocorrelation","lvl3":"Set Up"},"type":"lvl3","url":"/notebooks/global-spatial-autocorrelation#set-up","position":4},{"hierarchy":{"lvl1":"2.4 Global Spatial Autocorrelation","lvl3":"Set Up"},"content":"\n\nImport Libraries\n\nimport os\nimport numpy as np  \nimport pandas as pd \nimport matplotlib.pyplot as plt  \nimport matplotlib as mpl \nimport seaborn as sns \nfrom matplotlib.colors import LinearSegmentedColormap  \nimport matplotlib.patches as mpatches  \nimport matplotlib.patheffects as path_effects  \nimport geopandas as gpd  \nfrom shapely.geometry import Point, MultiPoint  \nfrom pyproj import CRS  \nfrom scipy.stats import norm \nimport libpysal  \nfrom esda import Moran \nfrom libpysal.weights.spatial_lag import lag_spatial \nfrom libpysal.weights import KNN \nfrom libpysal.weights import weights\n\n\n\nColors\n\ncolor_palettes = {\n    \"Mint\": [\"#EAF4E8\", \"#C8E0D4\", \"#A9CCC1\", \"#8FB9AE\", \"#76A79D\", \"#5F968E\", \"#498581\"], \n    \"Pi\": [\"#F8EDEB\", \"#FAE1DD\", \"#FCD5CE\", \"#FEC5BB\", \"#F8AD9D\", \"#F4978E\", \"#F08080\"],\n    \"Or\": [\"#FFE5D9\", \"#FFD7BA\", \"#FEC89A\", \"#FFB78F\", \"#F49F7D\", \"#F28B6D\", \"#E1755CFF\"],\n    \"GrSc\":  ['#EFEFEF', '#D9D9D9', '#CCCCCC', '#B7B7B7', '#999999', '#666666', '#434343'],\n    \"MintPi\": [\"#76A79D\", \"#8FB9AE\", \"#A9CCC1\", \"#C8E0D4\", \"#FBF0EA\", \"#FCD5CE\", \"#FEC5BB\", \"#F8AD9D\", \"#F4978E\"],\n    \"MintOr\": [\"#76A79D\", \"#8FB9AE\", \"#A9CCC1\", \"#C8E0D4\", \"#FBF0EA\", \"#FFD7BA\", \"#FEC89A\", \"#FFB78F\", \"#F28B6D\"],\n    \"MiPiOr\": ['#EAF4E8', '#FAE1DD', '#C8E0D4', '#FFD7BA', '#F8EDEB', '#FCD5CE', '#FFE5D9']\n} \n\nfrom matplotlib.colors import LinearSegmentedColormap\n\ncmap_mint = LinearSegmentedColormap.from_list(\"Mint\", color_palettes[\"Mint\"])\ncmap_pi = LinearSegmentedColormap.from_list(\"Pi\", color_palettes[\"Pi\"])\ncmap_or = LinearSegmentedColormap.from_list(\"Or\", color_palettes[\"Or\"])\ncmap_mintpi = LinearSegmentedColormap.from_list(\"MintPi\", color_palettes[\"MintPi\"])\ncmap_mintor = LinearSegmentedColormap.from_list(\"MintOr\", color_palettes[\"MintOr\"])\ncmap_grsc = LinearSegmentedColormap.from_list(\"GrSc\", color_palettes[\"GrSc\"])\ncmap_mipior = LinearSegmentedColormap.from_list(\"MiPiOr\", color_palettes[\"MiPiOr\"])\n\n\n\nFont\n\nplt.rcParams[\"font.family\"] = \"Helvetica\"\n\n\n\nBerlin Spatial Boundaries\n\npf = r\"../inputs/2.4_global_spatial_autocorrelation/lor_pgr.gpkg\"\npgr = gpd.read_file(pf)\npgr.replace({'-': np.nan, 0: np.nan, '': np.nan}, inplace=True)\n\nbf = r\"../inputs/2.4_global_spatial_autocorrelation/adm_bz.gpkg\"\nbz = gpd.read_file(bf)\nbz.replace({'-': np.nan, 0: np.nan, '': np.nan}, inplace=True)\n\nof = r\"../inputs/2.4_global_spatial_autocorrelation/adm_out.gpkg\"\nout = gpd.read_file(of)\nout.replace({'-': np.nan, 0: np.nan, '': np.nan}, inplace=True)\n\nmf = r\"../inputs/2.4_global_spatial_autocorrelation/berlin_mauer.gpkg\"\nmauer = gpd.read_file(mf)\nmauer.replace({'-': np.nan, 0: np.nan, '': np.nan}, inplace=True)\n\n\n\n","type":"content","url":"/notebooks/global-spatial-autocorrelation#set-up","position":5},{"hierarchy":{"lvl1":"Student Accommodation Capacity"},"type":"lvl1","url":"/notebooks/global-spatial-autocorrelation#student-accommodation-capacity","position":6},{"hierarchy":{"lvl1":"Student Accommodation Capacity"},"content":"\n\n","type":"content","url":"/notebooks/global-spatial-autocorrelation#student-accommodation-capacity","position":7},{"hierarchy":{"lvl1":"Student Accommodation Capacity","lvl2":"Data Import"},"type":"lvl2","url":"/notebooks/global-spatial-autocorrelation#data-import","position":8},{"hierarchy":{"lvl1":"Student Accommodation Capacity","lvl2":"Data Import"},"content":"\n\nThe data obtained as a result of Urban Data Mining was used as input data for the analysis (since no changes were made to the data during Descriptive Market Statistics).\n\npf = r\"../inputs/2.4_global_spatial_autocorrelation/pbsa_c.gpkg\"\npbsa_c = gpd.read_file(pf)\n\n\n\nBefore calculating global spatial autocorrelation, it is also necessary to perform tests: Moran’s I Scatterplots Test and K-Nearest Neighbor Test, as well as calculate the Significance Threshold test.\n\nSince the research focused on market parameters, global autocorrelation will focus on capacity, which measures the market supply.\n\n","type":"content","url":"/notebooks/global-spatial-autocorrelation#data-import","position":9},{"hierarchy":{"lvl1":"Student Accommodation Capacity","lvl2":"Standartalisation"},"type":"lvl2","url":"/notebooks/global-spatial-autocorrelation#standartalisation","position":10},{"hierarchy":{"lvl1":"Student Accommodation Capacity","lvl2":"Standartalisation"},"content":"Data standardisation is used to assess the correlation of neighbouring values relative to the overall average and to eliminate the outliers identified in the previous chapter. Standardisation converts data into dimensionless values, which allows for accurate comparison of clustering for different student accommodations. Positive standardised capacity values (!cap_std) indicate above-average objects, while negative values indicate below-average objects. This will help to clearly identify student accommodation clusters in the future.\n\npbsa_c[\"!cap_std\"] = pbsa_c[\"!cap\"] - pbsa_c[\"!cap\"].mean()\n\n\n\n","type":"content","url":"/notebooks/global-spatial-autocorrelation#standartalisation","position":11},{"hierarchy":{"lvl1":"Student Accommodation Capacity","lvl2":"Moran’s I Scatterplots Test & K-Nearest Neighbor Test"},"type":"lvl2","url":"/notebooks/global-spatial-autocorrelation#morans-i-scatterplots-test-k-nearest-neighbor-test","position":12},{"hierarchy":{"lvl1":"Student Accommodation Capacity","lvl2":"Moran’s I Scatterplots Test & K-Nearest Neighbor Test"},"content":"Several diagnostic measures can be used to identify spatial autocorrelation. Those that estimate spatial autocorrelation by a single value for the entire study area are named global spatial autocorrelation measures. The most commonly used is Moran’s I (Grekousis, 2020).\n\nMoran’s I computes global spatial autocorrelation by taking into accountfeature locations and attribute values (of a single attribute) simultaneously.\nIt is calculated by the following formula:I = \\frac{n}{\\sum_i \\sum_j w_{ij}} \\cdot \n\\frac{\\sum_i \\sum_j w_{ij}(x_i - \\bar{x})(x_j - \\bar{x})}\n{\\sum_i (x_i - \\bar{x})^2}\n\nwhere:\n\nn — number of spatial featuresxᵢ — attribute value of feature i (a variable in a spatial analysis context)xⱼ — attribute value of feature jx̄ — mean of this attributewᵢⱼ — spatial weight between feature i and j∑ᵢ∑ⱼ wᵢⱼ — aggregation of all spatial weights\n\nIn order to calculate spatial weights between features, K-nearest neighbor weights are used. K-nearest neighbor weights are distance-based weights defines the neighbor set of a particular observation as containing its nearest observations, where the user specifies the number of nearest neighbors (k). If we do not test k, Moran’s I Index might have values beyond the [-1,1] boundaries (Grekousis, 2020).\n\nTo understand the intuition behind its math, it is useful to begin with a graphical interpretation: the Moran Plot for different numbers of neighbors (Figure XX). The Moran Plot is a way of visualizing a spatial dataset to explore the nature and strength of spatial autocorrelation. It is essentially a traditional scatter plot in which the variable of interest is displayed against its spatial lag (Rey et al., 2023).\n\nThe Moran’s I scatterplots (Figure XX) across increasing k-values (k_values = list(range(1, 21))) reveal that student accommodation capacity in Berlin exhibits a weak but consistently positive spatial autocorrelation, which strengthens as the neighborhood definition expands. Each point represents a student accommodation and its relationship to the capacities of its surrounding neighbors. The four quadrants provide insight into the spatial logic of student housing distribution:\n\nQ1 – High–High (HH)These locations have high student accommodation capacity and are surrounded by other areas with similarly high capacities. These clusters signal where the market has already developed a strong supply.\n\nQ2 – Low–High (LH)These student accommodations have low capacity themselves, but are neighboring high-capacity ones. They often represent transition zones—places that have the potential to absorb future student housing development because they border well-served districts. These locations highlight opportunity areas where relatively small additions could significantly improve spatial balance.\n\nQ3 – Low–Low (LL)These locations exhibit low capacity and are surrounded by other low-capacity areas, marking systemic undersupply zones. For policy-making, these locations indicate structurally disadvantaged parts of the city, where students face limited options.\n\nQ4 – High–Low (HL)These student accommodations have high capacity but are surrounded by low-capacity neighbors. Such areas represent isolated clusters—individual dorms or private student residences located in otherwise undersupplied districts. They highlight mismatches where supply exists but lacks integration into broader student housing networks, potentially limiting accessibility.\n\nIn conclusion, the Moran’s I scatterplots illustrate that Berlin’s student housing supply is spatially uneven, featuring concentrated high-capacity cores, isolated developments, transitional opportunity zones, and persistent undersupply areas.\n\nnp.random.seed(55)\n\npbsa_c[\"!cap_std\"] = pbsa_c[\"!cap\"] - pbsa_c[\"!cap\"].mean()\n\n# Define k values and threshold\nk_values = list(range(1, 21))\nthreshold = 1.0  # Customize this if needed\n\n# Subplot grid\nn_cols = 5\nn_rows = (len(k_values) + n_cols - 1) // n_cols\nn_plots = len(k_values)\n\nfig, axes = plt.subplots(n_rows, n_cols, figsize=(20, 4 * n_rows))\naxes = axes.flatten()\n\n# Generate plots\ndef new_func(k, ax, moran_i, p_val):\n    #ax.set_title(f'k={k}\\nMoran\\'s I = {moran_i:.3f}, P-value = {p_val:.3f}', fontsize=9)\n    ax.set_title(f'k={k}', fontsize=12)\n\nfor i, k in enumerate(k_values):\n    ax = axes[i]\n    \n    # Create spatial weights matrix\n    w_k = libpysal.weights.KNN.from_dataframe(pbsa_c, k=k)\n    w_k.transform = \"R\"\n    \n    # Compute spatial lag for this k\n    slag_col = f'!cap_slag_std_k{k}'\n    pbsa_c[slag_col] = lag_spatial(w_k, pbsa_c[\"!cap_std\"])\n\n    # Generate quadrant-based colors\n    colors = []\n    clusters = []\n    for x, y in zip(pbsa_c['!cap_std'], pbsa_c[slag_col]):\n        if abs(x) <= threshold and abs(y) <= threshold:\n            colors.append('#FBF0EA')  # Cream = Not Significant\n            clusters.append('NS')\n        elif x > 0 and y > 0:\n            colors.append('#F28B6D')  # Coral = High-High\n            clusters.append('HH')\n        elif x > 0 and y < 0:\n            colors.append('#C8E0D4')  # Light teal = Low-High\n            clusters.append('LH')\n        elif x < 0 and y < 0:\n            colors.append('#5F968E')  # Dark teal = Low-Low\n            clusters.append('LL')\n        elif x < 0 and y > 0:\n            colors.append('#FEC89A')  # Peach = High-Low\n            clusters.append('HL')\n    \n    # Scatter plot\n    ax.scatter(\n        pbsa_c['!cap_std'], pbsa_c[slag_col],\n        c=colors, s=np.random.seed(55), edgecolor='white', linewidth=0.3, alpha=0.8\n    )\n\n    # Add regression line\n    sns.regplot(\n        x='!cap_std', y=slag_col, data=pbsa_c,\n        scatter=False, ci=None, line_kws={\"color\": '#999999', \"linewidth\": 1.2}, ax=ax\n    )\n\n    # Axes\n    ax.axvline(0, color='#aaaaaa', linestyle='--', linewidth=0.8)\n    ax.axhline(0, color='#aaaaaa', linestyle='--', linewidth=0.8)\n\n    # Moran calculation\n    moran_k = Moran(pbsa_c['!cap'], w_k)\n    moran_i = moran_k.I\n    p_val = moran_k.p_sim\n\n    # Title\n    new_func(k, ax, moran_i, p_val)\n\n    # Axis labels (only for edges)\n    if i % n_cols == 0:\n        ax.set_ylabel('spatial lag of standardised capacity (!cap_slag_std)', fontsize=9)\n    if i >= n_plots - n_cols:\n        ax.set_xlabel('standardised capacity (!cap_std)', fontsize=12)\n    if i % n_cols != 0:\n        ax.set_ylabel('')\n    if i < n_plots - n_cols:\n        ax.set_xlabel('')\n\n    # Tight axes\n    ax.set_xlim(pbsa_c['!cap_std'].min() - 0.1, pbsa_c['!cap_std'].max() + 0.1)\n    ax.set_ylim(pbsa_c[slag_col].min() - 0.1, pbsa_c[slag_col].max() + 0.1)\n\n# Hide any extra subplots\nfor j in range(len(k_values), len(axes)):\n    axes[j].set_visible(False)\n\n# Layout\nfig.suptitle(\"Student Accommodation Capacity Moran's I Scatterplots for Different Number of Neighbours (k)\", fontsize=16, y=0.98)\nplt.subplots_adjust(top=0.93, hspace=0.5, wspace=0.5)\n\nsave_path = os.path.join(hf, \"Student Accommodation Capacity Moran's I Scatterplots for Different Number of Neighbours (k).png\")\nplt.savefig(save_path, dpi=300, bbox_inches=\"tight\")\n\nplt.tight_layout()\nplt.show()\n\n\n\nFigure XX. Student Accommodation Capacity Moran’s I Scatterplots for Different Number of Neighbours (k)\n\nThe difference between the scatterplots (Figure XX) must be evaluated based on Moran’s I index and P-value. Through these metrics, we assess whether spatial autocorrelation is statistically significant. To do this, we need to calculate the parameters for each value of the number of nearest neighbors (k) (Table XX).\n\nMoran’s I index and P-value can be interpreted as follows. A Moran’s I index score higher than 0.3 is an indication of relatively strong positive autocorrelation, while a score lower than -0.3 is an indication of relatively strong negative autocorrelation. If the p-value is large (usually p > 0.05), the results are not statistically significant, and we cannot reject spatial dependency (Grekousis, 2020).\n\nnp.random.seed(55)\n\nk_values = [ 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20]\nmorans_I = []\np_values = []\n\nfor k in k_values:\n    w = libpysal.weights.KNN.from_dataframe(pbsa_c, k=k)\n    w.transform = \"R\"\n    moran = Moran(pbsa_c['!cap'], w)\n    morans_I.append(moran.I)\n    p_values.append(moran.p_sim)\n\n# Create DataFrame\npbsa_k_test = pd.DataFrame({\n    'k': k_values,\n    \"Moran's I\": morans_I,\n    'P-value': p_values\n})\n\npbsa_k_test\n\n\n\nTable XX. Student Accommodation Capacity Moran’s I index and P-value for Different Number of Neighbors (k)\n\nThe task of finding the desired value of the number of nearest neighbors (k) can be solved by plotting a graph of the dependence of Moran’s I index and P-value on k (Figure XX). On this graph, it is necessary to find the maximum values of the Moran’s I index modulus and then compare the P-value.\n\nThe maximum values of Moran’s I index are achieved at k from 15 to 17. Since there are only 88 student dormitories, the minimum value of 15 neighbors (k = 15) was chosen. That is, each student dormitory is compared with its 15 closest neighbors in order to identify spatial dependence.\n\nplt.figure(figsize=(6, 6))\nplt.plot(pbsa_k_test['k'], pbsa_k_test[\"Moran's I\"], label=\"Moran's I\", color='#FFB78F')\nplt.plot(pbsa_k_test['k'], pbsa_k_test['P-value'], label='P-value', color='#76A79D')\n\nplt.axhline(0.05, color='#A9CCC1', linestyle='--', linewidth=1.5, label=\"P = 0.05 (Significance Threshold)\")\nplt.grid(True, color='#cccccc', linestyle='--', alpha=0.5)\n\nplt.xlabel('k (number of neighbors)')\nplt.title(\"Student Accommodation Capacity Moran's I and P-value\")\nplt.xticks(pbsa_k_test['k'])\nplt.legend(loc='best', frameon=False)\n\nsave_path = os.path.join(hf, \"Student Accommodation Capacity Moran's I and P-value.png\")\nplt.savefig(save_path, dpi=300, bbox_inches=\"tight\")\n\nplt.tight_layout()\nplt.show()\n\n\n\nFigure XX. Student Accommodation Capacity Moran’s I index and P-value for Different Number of Neighbours (k)\n\n","type":"content","url":"/notebooks/global-spatial-autocorrelation#morans-i-scatterplots-test-k-nearest-neighbor-test","position":13},{"hierarchy":{"lvl1":"Student Accommodation Capacity","lvl2":"Significance Threshold Test"},"type":"lvl2","url":"/notebooks/global-spatial-autocorrelation#significance-threshold-test","position":14},{"hierarchy":{"lvl1":"Student Accommodation Capacity","lvl2":"Significance Threshold Test"},"content":"\n\nIn the original Moran’s I Scatterplots for Different Number of Neighbors (Figure XX), the points are distributed across four quadrants: HH, HL, LH, LL. However, points near zero may accidentally fall into false categories, even though they do not demonstrate real spatial dependence. This can lead to distorted results and the identification of false points of spatial autocorrelation.\n\nThe Significance Threshold Test sets a significance threshold (theshold) for standardized capacity (!cap_std) and spatial lag standardized capacity (!cap_slag_std), and filters out not significant points where both variables take neutral values.\n\n# Option 1: Based on percentiles (recommended for your data)\nthreshold_percentile = np.percentile(np.abs(pbsa_c['!cap_std']), 75)  # 75th percentile of absolute values\nprint(f\"Option 1 - Percentile-based threshold: {threshold_percentile:.3f}\")\nprint(f\"  (75th percentile of absolute values)\")\n\n# Option 2: Based on standard deviation\nstd_dev = pbsa_c['!cap_std'].std()\nthreshold_std = 0.5 * std_dev  # 0.5 standard deviations\nprint(f\"Option 2 - Standard deviation-based threshold: {threshold_std:.3f}\")\nprint(f\"  (0.5 * standard deviation)\")\n\n# Option 3: Fixed threshold based on your data range\nthreshold_fixed = 50.0  # Fixed value appropriate for your range\nprint(f\"Option 3 - Fixed threshold: {threshold_fixed:.3f}\")\nprint(f\"  (Fixed value for data range)\")\n\n# Option 4: Median-based threshold\nmedian_abs = np.median(np.abs(pbsa_c['!cap_std']))\nthreshold_median = median_abs * 0.5\nprint(f\"Option 4 - Median-based threshold: {threshold_median:.3f}\")\nprint(f\"  (0.5 * median of absolute values)\")\n\nthresholds_to_test = [threshold_percentile, threshold_std, threshold_fixed, threshold_median]\n\nfor i, test_threshold in enumerate(thresholds_to_test, 1):\n    print(f\"\\nTest {i}: threshold = {test_threshold:.3f}\")\n    \n    # Count points in each category\n    ns_count = 0\n    hh_count = 0\n    lh_count = 0\n    ll_count = 0\n    hl_count = 0\n    \n    for x, y in zip(pbsa_c['!cap_std'], pbsa_c[slag_col]):\n        if abs(x) <= test_threshold and abs(y) <= test_threshold:\n            ns_count += 1\n        elif x > 0 and y > 0:\n            hh_count += 1\n        elif x > 0 and y < 0:\n            lh_count += 1\n        elif x < 0 and y < 0:\n            ll_count += 1\n        elif x < 0 and y > 0:\n            hl_count += 1\n    \n    total = len(pbsa_c)\n    print(f\"  NS: {ns_count} ({ns_count/total*100:.1f}%)\")\n    print(f\"  HH: {hh_count} ({hh_count/total*100:.1f}%)\")\n    print(f\"  LH: {lh_count} ({lh_count/total*100:.1f}%)\")\n    print(f\"  LL: {ll_count} ({ll_count/total*100:.1f}%)\")\n    print(f\"  HL: {hl_count} ({hl_count/total*100:.1f}%)\")\n\n\n\nIn order to correctly interpret the Significance Threshold Test, it is necessary to pay attention to the distribution of points across four squares - spatial clusters.\n\nOption 1 - Percentile-based threshold: 234.375With a high threshold value, 75% of the points became neutral, and the global autocorrelation analysis lost its meaning.\n\nOption 2 - Standard deviation-based threshold: 124.090It will eliminate the outliers that were described in the Descriptive Market Statistics chapter, as it is calculated according to the standard deviation.\n\nOption 3 - Fixed threshold: 50.000A threshold value that is too low results in the percentage of neutral points being too low at 6.8%.\n\nOption 4 - Median-based threshold: 78.750Median-based threshold does not react to abnormally large values.\nTherefore, this threshold creates a threshold that reflects the real “central” distribution structure (threshold = threshold_median).\n\nUsing three tests: Moran’s I Scatterplots Test, K-Nearest Neighbour Test, and Significance Threshold Test, it can be confirmed that the results of local spatial autocorrelation are stable.\n\n","type":"content","url":"/notebooks/global-spatial-autocorrelation#significance-threshold-test","position":15},{"hierarchy":{"lvl1":"Student Accommodation Capacity","lvl2":"Spatial Weights & Moran’s I & P-value"},"type":"lvl2","url":"/notebooks/global-spatial-autocorrelation#spatial-weights-morans-i-p-value","position":16},{"hierarchy":{"lvl1":"Student Accommodation Capacity","lvl2":"Spatial Weights & Moran’s I & P-value"},"content":"\n\nAfter performing all necessary tests, it is possible to proceed to the direct calculation of Spatial Weights, Moran’s I, and P-value for the selected value of numbers of nearest neighbors (k=15). To do this, the method of spatial weights standardization must be defined. Row-standardization (w.transform = “R”) makes Moran’s I and other spatial indices comparable between different areas, even if the number of neighbors for objects is different. For each row of the weight matrix (each object), the sum of all neighbor weights is normalized to 1.w_{ij}^{(R)} = \\frac{w_{ij}}{\\sum_{j} w_{ij}}\n\nw = KNN.from_dataframe(pbsa_c, k=15)\n\nw.transform = \"R\" \n\nvalues = pbsa_c['!cap']\n\nmoran = Moran(values, w)\nprint(f\"Moran's I: {moran.I:.3f}\")\nprint(f\"P-value: {moran.p_sim:.3f}\")\n\n\n\nMoran’s I (Moran's I: 0.136) indicates positive spatial autocorrelation. In the context of urban planning, this indicates that student accommodations have a weak but stable tendency to form clusters.\n\nP-value (P-value: 0.001) indicates that the probability of obtaining such a result by chance is 0.1%. In the context of urban planning, this shows that the observed spatial clusters actually exist and are not random.\n\n","type":"content","url":"/notebooks/global-spatial-autocorrelation#spatial-weights-morans-i-p-value","position":17},{"hierarchy":{"lvl1":"Student Accommodation Capacity","lvl2":"Spatial Lag & Standardised Spatial Lag"},"type":"lvl2","url":"/notebooks/global-spatial-autocorrelation#spatial-lag-standardised-spatial-lag","position":18},{"hierarchy":{"lvl1":"Student Accommodation Capacity","lvl2":"Spatial Lag & Standardised Spatial Lag"},"content":"\n\nAfter calculating spatial weights, it is necessary to compute the spatial lag. The spatial lag operator is one of the most common and direct applications of spatial weights matrices (called \\textbf{W} formally) in spatial analysis. Conceptually, the spatial lag captures the behavior of a variable in the immediate surroundings of each location; in that respect, it is akin to a local smoother of a variable (Rey et al., 2023).\n\nWe can formally express it in matrix notation as:Y_{sl} = \\textbf{W} Y\n\nor, in individual notation as:y_{sl-i} = \\sum_j w_{ij} y_j\n\nwhere:\n\nw_{ij} is the cell in \\textbf{W} on the i-th row and j-th column, thus capturing the spatial relationship between observations i and j, in other words y_{sl-i} is the weighted average values in a specified neighborhood.y_{sl-i} thus captures the product of the values and weights of each observation other than i in the dataset.\n\nSpatial lag is a key element of many spatial analysis techniques including spatial autocorrelation (Rey et al., 2023).\n\npbsa_c[\"!cap_slag\"] = lag_spatial(w, pbsa_c[\"!cap\"])\npbsa_c[\"!cap_std\"] = pbsa_c[\"!cap\"] - pbsa_c[\"!cap\"].mean()\npbsa_c[\"!cap_slag_std\"] = lag_spatial(w, pbsa_c[\"!cap_std\"])\n\n\n\nThe maps (Figure XX) illustrate the various stages of data preparation for global autocorrelation — from actual capacity values (!cap) and their spatial relationships (!cap_slag) to their standardized values (!cap_std and !cap_slag_std).\n\na. Student Housing Capacity (!cap)The first map shows the absolute capacity of student housing. Despite the presence of large facilities in central areas, the overall structure remains fragmented, with significant heterogeneity between districts. This map reflects the actual market and serves as a starting point for analysis.\n\nb. Student Housing Capacity Influence (!cap_slag)The second map displays the spatial lag of capacity — the average capacity in neighboring locations. It captures the influence of neighboring facilities, smoothing out local peaks and revealing latent clusters that are not visible in the absolute data. This shows not only where large dormitories are located, but also where their surroundings are saturated or deficient.\n\nc. Standardized Capacity (!cap_std)The third map shows standardised values (centered around the mean). Here you can see which areas have above- or below-average capacity for the city, rather than simply “large/small.” This is a key step for Moran’s I, as it allows you to identify deviations from the overall trend rather than absolute values.\n\nd. Standardized Capacity Influence (!cap_slag_std)The fourth map displays standardized spatial lag—how much neighboring areas are above or below average. In combination with map (c), it shows where High–High (HH) and Low–Low (LL) clusters form and where anomalies (High–Low / Low–High) occur. These patterns form the basis for interpreting the Moran Scatterplot.\n\nTogether, maps (a–d) demonstrate that the distribution of student housing in Berlin is highly heterogeneous and structurally dependent on the spatial environment. The transition from absolute values (!cap) to standardized spatial lags (!cap_slag_std) allows us to identify hidden clusters and areas of shortage — key information for rethinking student housing placement strategies and developing spatially sensitive solutions.\n\nfig, axs  = plt.subplots(2, 2, figsize=(18, 12))\n\npgr.plot(ax=axs[0, 0], facecolor='none', edgecolor='#cccccc', linewidth=0.5, linestyle=\"--\")\nbz.plot(ax=axs[0, 0], facecolor='none', edgecolor='#999999', linewidth=0.75)\nout.plot(ax=axs[0, 0], facecolor='none', edgecolor='#666666', linewidth=1)\npbsa_c.plot(ax=axs[0, 0],\n          column='!cap',\n          cmap=cmap_or,\n          markersize = np.sqrt(pbsa_c['!cap']) * 2,  # Scale marker size\n          alpha=0.9,\n          edgecolor='white',\n          linewidth=0.3,\n          legend=True,\n          legend_kwds={'shrink': 0.6, 'label': \"capacity\"},\n          vmin=0,\n          vmax=pbsa_c['!cap'].quantile(0.95))  # Cap extremes\naxs[0, 0].set_title('a. Student Housing Capacity (!cap)', fontsize=14, pad=15, fontweight='bold')\naxs[0, 0].set_axis_off()\n\npgr.plot(ax=axs[0, 1], facecolor='none', edgecolor='#cccccc', linewidth=0.5, linestyle=\"--\")\nbz.plot(ax=axs[0, 1], facecolor='none', edgecolor='#999999', linewidth=0.75)\nout.plot(ax=axs[0, 1], facecolor='none', edgecolor='#666666', linewidth=1)\npbsa_c.plot(ax=axs[0, 1],\n          column='!cap_slag',\n          cmap=cmap_or,\n          markersize=np.sqrt(pbsa_c['!cap_slag']) * 2,\n          alpha=0.9,\n          edgecolor='white',\n          linewidth=0.3,\n          legend=True,\n          legend_kwds={'shrink': 0.6, 'label': \"capacity spatial lag\"},\n          vmin=0,\n          vmax=pbsa_c['!cap'].quantile(0.95))  # Matching Previous plott\naxs[0, 1].set_title('b. Student Housing Capacity Influence (!cap_slag)', fontsize=14, pad=15, fontweight='bold')\naxs[0, 1].set_axis_off()\n\n\nmax_abs_value = max(abs(pbsa_c['!cap_std'].min()), abs(pbsa_c['!cap_std'].max()))\nvmin, vmax = -max_abs_value, max_abs_value\npgr.plot(ax=axs[1, 0], facecolor='none', edgecolor='#cccccc', linewidth=0.5, linestyle=\"--\")\nbz.plot(ax=axs[1, 0], facecolor='none', edgecolor='#999999', linewidth=0.75)\nout.plot(ax=axs[1, 0], facecolor='none', edgecolor='#666666', linewidth=1)\npbsa_c.plot(ax=axs[1, 0],\n          column='!cap_std',\n          cmap=cmap_mintor,\n          markersize = np.sqrt(np.abs(pbsa_c['!cap_std'])) * 2,  # Scale marker size\n          alpha=0.9,\n          edgecolor='white',\n          linewidth=0.3,\n          legend=True,\n          legend_kwds={'shrink': 0.6, 'label': \"standardised capacity\"},\n          vmin=vmin,  # Symmetrical lower bound\n          vmax=vmax)      # Cap extremes\naxs[1, 0].set_title('c.Standardised Student Housing Capacity (!cap_std)', fontsize=14, pad=15, fontweight='bold')\naxs[1, 0].set_axis_off()\n\nmax_abs_value = max(abs(pbsa_c['!cap_slag_std'].min()), abs(pbsa_c['!cap_slag_std'].max()))\nvmin, vmax = -max_abs_value, max_abs_value\npgr.plot(ax=axs[1, 1], facecolor='none', edgecolor='#cccccc', linewidth=0.5, linestyle=\"--\")\nbz.plot(ax=axs[1, 1], facecolor='none', edgecolor='#999999', linewidth=0.75)\nout.plot(ax=axs[1, 1], facecolor='none', edgecolor='#666666', linewidth=1)\npbsa_c.plot(ax=axs[1, 1],\n          column='!cap_slag_std',\n          cmap=cmap_mintor,\n          markersize=np.sqrt(np.abs(pbsa_c['!cap_slag_std'])) * 2,\n          alpha=0.9,\n          edgecolor='white',\n          linewidth=0.3,\n          legend=True,\n          legend_kwds={'shrink': 0.6, 'label': \"standardised capacity spatial lag\"},\n          vmin=vmin,  # Symmetrical lower bound\n          vmax=vmax)\naxs[1, 1].legend(loc='lower center', ncol=2, frameon=False, prop={'size': 10})\naxs[1, 1].set_title('d. Standardised Student Housing Capacity Influence (!cap_slag_std)', fontsize=14, pad=15, fontweight='bold')\naxs[1, 1].set_axis_off()\n\nsave_path = os.path.join(hf, \"Standardised Student Housing Capacity.png\")\nplt.savefig(save_path, dpi=300, bbox_inches=\"tight\")\n\nplt.tight_layout()\nplt.show()\n\n\n\nFigure XX. Stages of Preparing Student Accommodation Capacity Data\n\nMoran’s graph shows the spatial relationship between the standardised capacity of student housing (!cap_std) and its spatial lag (!cap_slag_std) — that is, the average capacity of neighbouring locations. Dividing the graph into four quadrants allows us to identify types of spatial patterns:\n\nQ1 – High–High (HH)These are high-capacity clusters where several large student residences are concentrated close to each other. For example, Studentenwohnheim Alfred-Jung-Straße, with a capacity of 800, is located less than 200 metres from another large student accommodation facility, WH Storkower Straße, with a capacity of 508 students, forming a stable centre for foreign students. At the same time, 12 of the 17 student facilities in the HH quadrant are state-owned. This leads to the conclusion that these centres of attraction are formed by state-owned facilities.\n\nQ2 – Low–High (LH)\nThese are local pockets near developed clusters where a particular facility has low capacity compared to its saturated surroundings. For example, four facilities located in Wed: Norderoog, Studentenwohnheim Paul-Hertz-Haus, Süderoog, WH Augustenburger Platz with a total capacity of 471 students. Such areas are particularly important for analysis, as they may represent missed opportunities for growth.\n\nQ3 – Low–Low (LL)These are supply shortage clusters where both the property and its surroundings have low capacity. For example, student accommodation in the direct vicinity of the Technical University of Berlin (Insider Apartments Leibniz Straße, WH Fraunhoferstraße, WH Hardenbergstraße). Such areas indicate structurally underserved areas – potential territories for development.\n\nQ4 – High–Low (HL)These are spatial anomalies where one large property appears in an environment where neighbouring areas have low supply. For example, Student Village Berlin Adlershof, is an early indicator of the development of new student areas.\n\nThe graph shows that the distribution of student housing capacity in Berlin includes both stable high-density clusters (HH) and structural gaps (LL), as well as a number of spatial anomalies (HL, LH), indicating uneven market development. These patterns describe indicators of the student housing crisis.\n\n# Define thresholds for \"Not Significant\"\nthreshold = threshold_median\n\n# Prepare lists\ncolors = []\nclusters = []\n\n# Loop through each row\nfor x, y in zip(pbsa_c['!cap_std'], pbsa_c['!cap_slag_std']):\n    if abs(x) <= threshold and abs(y) <= threshold:\n        colors.append('#FBF0EA')         # Cream for Not Significant\n        clusters.append('NS')            # Not Significant\n    elif x > 0 and y > 0:\n        colors.append('#F28B6D')         # Coral\n        clusters.append('HH')            # High-High\n    elif x > 0 and y < 0:\n        colors.append('#C8E0D4')         # Light teal\n        clusters.append('LH')            # Low-High\n    elif x < 0 and y < 0:\n        colors.append('#5F968E')         # Dark teal\n        clusters.append('LL')            # Low-Low\n    elif x < 0 and y > 0:\n        colors.append('#FEC89A')         # Peach\n        clusters.append('HL')            # High-Low\n\n# Assign to GeoDataFrame\npbsa_c['color'] = colors\npbsa_c['cluster_cap'] = clusters\n\n\n\nf, ax = plt.subplots(1, figsize=(6, 6))\n\n# Scatter plot with manual colors\nscatter = ax.scatter(\n    x=pbsa_c['!cap_std'],\n    y=pbsa_c['!cap_slag_std'],\n    c=colors,  # Use our manually assigned colors\n    s=40,\n    edgecolor='white',\n    linewidth=0.3\n)\n\nsns.regplot(\n    x='!cap_std',\n    y='!cap_slag_std',\n    ci=None,\n    data=pbsa_c,\n    scatter=False,  # Disable default points\n    line_kws={\"color\":'#cccccc', \"linewidth\": 2},\n    ax=ax\n)\n\n# Axes lines\nax.axvline(0, color='#cccccc', alpha=0.75, linestyle=\"--\")\nax.axhline(0, color='#cccccc', alpha=0.75, linestyle=\"--\")\n\n# Title and labels\nax.set_title(\"Moran Scatterplot: Standardised Student Accommodation Capacity\", fontsize=12, weight='bold')\nax.set_xlabel(\"standardised capacity (!cap_std)\", fontsize=10)\nax.set_ylabel(\"spatial lag of standardised capacity (!cap_slag_std)\", fontsize=10)\n\n# Quadrant labels\nax.text(400, 125, \"High–High (HH)\", fontsize=9, color=\"gray\")\nax.text(400, -75, \"Low–High (LH)\", fontsize=9, color=\"gray\")\nax.text(-200, -75, \"Low–Low (LL)\", fontsize=9, color=\"gray\")\nax.text(-200, 125, \"High–Low (HL)\", fontsize=9, color=\"gray\")\n\n# Style\nax.set_xlim(pbsa_c['!cap_std'].min() - 0.5, pbsa_c['!cap_std'].max() + 0.5)\nax.set_ylim(pbsa_c['!cap_slag_std'].min() - 0.5, pbsa_c['!cap_slag_std'].max() + 0.5)\n\nsave_path = os.path.join(hf, \"Moran Scatterplot: Standardised Student Accommodation Capacity\")\nplt.savefig(save_path, dpi=300, bbox_inches=\"tight\")\n\nplt.tight_layout()\nplt.show()\n\n\n\nFigure XX. Student Accommodation Capacity Moran Scatterplot\n\nThe map (Figure XX) visualises the results of global spatial autocorrelation, which allows spatial clusters of student housing capacity to be identified.\n\nIn addition to identifying point clusters, the map clearly demonstrates the structural difference between East and West Berlin, which persists decades after the city’s reunification. The map reveals clear spatial segregation.\n\nEast Berlin shows a high concentration of large student complexes and compact clusters. In the districts of Lichtenberg, Marzahn-Hellersdorf, and parts of the central districts, large halls of residence (HH) are spatially clustered, indicating strategically strong market areas. Individual high-capacity facilities (HL) are located in areas with low supply (e.g., in the south-east of the city). This is partly due to the historical legacy of the former East Berlin, where student residences were actively developed as part of the social infrastructure.\n\nWestern Berlin, on the other hand, is characterised by a predominance of stable areas with low capacity and a shortage of supply. Areas of systemic shortage are concentrated mainly in Charlottenburg-Wilmersdorf, Tempelhof-Schöneberg, Neukölln, and Steglitz-Zehlendorf. Properties with low capacity are surrounded by large student complexes, most often in areas where local conditions or urban planning restrictions hinder expansion, such as in Mitte. This reflects a market that is more oriented towards the private rental sector, where student accommodation has developed more slowly.\n\nThe spatial distribution of student housing in Berlin remains uneven and historically conditioned: the east has concentrated large, state-owned housing clusters, while the west faces a systemic supply shortage. This asymmetry increases pressure on rental markets in western districts and serves as a key signal of the ongoing student housing crisis.\n\nfig, ax = plt.subplots(figsize=(12, 12))\n\n# Plot the base map (replace 'lor' with your local authority boundaries if needed)\n\npgr.plot(ax=ax, facecolor='none', edgecolor='#cccccc', linewidth=0.5, linestyle=\"--\")\nmauer.plot(ax=ax, facecolor='none', edgecolor='#666666', linewidth=1.25, linestyle=\"--\")\nbz.plot(ax=ax, facecolor='none', edgecolor='#999999', linewidth=0.75)\nfor idx, row in bz.iterrows():\n    centroid = row['geometry'].centroid\n    txt = ax.text(\n        centroid.x, centroid.y,\n        str(row['namgem']),\n        fontsize=8, color='#666666', ha='center', va='center'\n    )\n    txt.set_path_effects([\n        path_effects.Stroke(linewidth=2, foreground='white'),\n        path_effects.Normal()\n    ])\nout.plot(ax=ax, facecolor='none', edgecolor='#666666', linewidth=1.25)\n\n# Plot the student housing with colors based on cluster classification\npbsa_c.plot(ax=ax,\n            color=pbsa_c['color'],\n            markersize=np.sqrt(np.abs(pbsa_c['!cap_std'])) * 3 + 5,  # Adjust size based on standardized capacity\n            alpha=0.9,\n            edgecolor='white',\n            linewidth=0.3)\n\nlegend_elements = [\n    mpatches.Patch(color='#F28B6D', label='High-High (HH)', edgecolor='none'),\n    mpatches.Patch(color='#FEC89A', label='High-Low (HL)', edgecolor='none'),\n    mpatches.Patch(color='#C8E0D4', label='Low-High (LH)', edgecolor='none'),\n    mpatches.Patch(color='#5F968E', label='Low-Low (LL)', edgecolor='none'), \n    mpatches.Patch(color='#FBF0EA', label='Not Significant (NS)', edgecolor='#FAE1DD'), \n]\n\n# Add the legend to the plot\nax.legend(handles=legend_elements, loc='lower center', ncol=5, frameon=False, prop={'size': 10})\n\n# Add titles and customize the layout\nax.set_title('Student Housing Capacity Clusters in Berlin', fontsize=16, weight='bold')\nax.set_axis_off()\n\nsave_path = os.path.join(hf, \"Student Housing Capacity Clusters in Berlin.png\")\nplt.savefig(save_path, dpi=300, bbox_inches=\"tight\")\n\nplt.tight_layout()\nplt.show()\n\n\n\nFigure XX. Student Accommodation Capacity Clusters in Berlin\n\n","type":"content","url":"/notebooks/global-spatial-autocorrelation#spatial-lag-standardised-spatial-lag","position":19},{"hierarchy":{"lvl1":"Student Accommodation Capacity","lvl2":"Data Export"},"type":"lvl2","url":"/notebooks/global-spatial-autocorrelation#data-export","position":20},{"hierarchy":{"lvl1":"Student Accommodation Capacity","lvl2":"Data Export"},"content":"\n\nThe student accommodation data obtained from global spatial autocorrelation was stored for further market analysis.\n\n# List of columns to drop\ncols_to_drop = [f'!cap_slag_std_k{i}' for i in range(1, 21)]\n\n# Drop them from the GeoDataFrame\npbsa_c = pbsa_c.drop(columns=cols_to_drop)\n\n\n\nef = r'../outputs/2.4_global_spatial_autocorrelation/pbsa_capacity_analysis.gpkg'\npbsa_c.to_file(ef, driver=\"GPKG\")\n\n\n\n","type":"content","url":"/notebooks/global-spatial-autocorrelation#data-export","position":21},{"hierarchy":{"lvl1":"Higher Education Universities International Demand"},"type":"lvl1","url":"/notebooks/global-spatial-autocorrelation#higher-education-universities-international-demand","position":22},{"hierarchy":{"lvl1":"Higher Education Universities International Demand"},"content":"Similarly, an analysis of the spatial distribution of higher education university student demand across the city was conducted.\n\n","type":"content","url":"/notebooks/global-spatial-autocorrelation#higher-education-universities-international-demand","position":23},{"hierarchy":{"lvl1":"Higher Education Universities International Demand","lvl2":"Data Import"},"type":"lvl2","url":"/notebooks/global-spatial-autocorrelation#data-import-1","position":24},{"hierarchy":{"lvl1":"Higher Education Universities International Demand","lvl2":"Data Import"},"content":"\n\nuf = r'../inputs/2.4_global_spatial_autocorrelation/uni_c.gpkg'\nuni_c = gpd.read_file(uf)\n\n\n\n","type":"content","url":"/notebooks/global-spatial-autocorrelation#data-import-1","position":25},{"hierarchy":{"lvl1":"Higher Education Universities International Demand","lvl2":"Standartalisation"},"type":"lvl2","url":"/notebooks/global-spatial-autocorrelation#standartalisation-1","position":26},{"hierarchy":{"lvl1":"Higher Education Universities International Demand","lvl2":"Standartalisation"},"content":"\n\nSince the research focused on international students, global autocorrelation will focus on number of international students (!s_aus), which measures the market demand.\n\nuni_c[\"!s_aus_std\"] = uni_c[\"!s_aus\"] - uni_c[\"!s_aus\"].mean()\n\n\n\n","type":"content","url":"/notebooks/global-spatial-autocorrelation#standartalisation-1","position":27},{"hierarchy":{"lvl1":"Higher Education Universities International Demand","lvl2":"Moran’s I Scatterplots Test & K-Nearest Neighbor Test"},"type":"lvl2","url":"/notebooks/global-spatial-autocorrelation#morans-i-scatterplots-test-k-nearest-neighbor-test-1","position":28},{"hierarchy":{"lvl1":"Higher Education Universities International Demand","lvl2":"Moran’s I Scatterplots Test & K-Nearest Neighbor Test"},"content":"\n\nMoran’s I Scatterplots (Figure XX) demonstrate how the spatial structure of international student demand changes as the number of nearest neighbours increases (k_values = list(range(1, 21))). The main conclusion is that, unlike the student housing market, demand from universities does not form stable spatial clusters. Most points in all graphs are concentrated near zero on the standardised international demand axis (!s_aus_std), indicating that neighbouring universities do not have a strong influence on demand values.\n\nQ1 – High–High (HH)Unlike student dormitories, there are virtually no high-density clusters because large universities are located far from each other, and their demand values do not correlate with each other, i.e., universities attract foreign students regardless of their location.\n\nQ2 – Low–High (LH)These are local pockets near universities with a large number of foreign students, where a particular university has low demand compared to its saturated surroundings.\n\nQ3 – Low–Low (LL)For most values of the number of nearest neighbours (k), there is a high concentration of universities with a low number of foreign students surrounded by similar institutions. This indicates a generally uniform low density of international student demand across the city.\n\nQ4 – High–Low (HL)Several universities with very high numbers of international students are isolated “peaks of demand”, not forming full-fledged spatial clusters.\n\nIn conclusion, Moran’s I scatterplots illustrate that the demand generated by international students is structurally dispersed and does not form clusters across the city.\n\nnp.random.seed(55)\n\nk_values = list(range(1, 21))\nthreshold = 1.0  # Customize this if needed\n\n# Subplot grid\nn_cols = 5\nn_rows = (len(k_values) + n_cols - 1) // n_cols\nn_plots = len(k_values)\n\nfig, axes = plt.subplots(n_rows, n_cols, figsize=(20, 4 * n_rows))\naxes = axes.flatten()\n\n# Generate plots\nfor i, k in enumerate(k_values):\n    ax = axes[i]\n    \n    # Create spatial weights matrix\n    w_k = libpysal.weights.KNN.from_dataframe(uni_c, k=k)\n    w_k.transform = \"R\"\n    \n    # Compute spatial lag for this k\n    slag_col = f'!s_aus_slag_std_k{k}'\n    uni_c[slag_col] = lag_spatial(w_k, uni_c[\"!s_aus_std\"])\n\n    # Generate quadrant-based colors\n    colors = []\n    clusters = []\n    for x, y in zip(uni_c['!s_aus_std'], uni_c[slag_col]):\n        if abs(x) <= threshold and abs(y) <= threshold:\n            colors.append('#FBF0EA')         # Cream for Not Significant\n            clusters.append('NS')\n        elif x > 0 and y > 0:\n            colors.append('#F08080')         # Pink\n            clusters.append('HH')\n        elif x > 0 and y < 0:\n            colors.append('#C8E0D4')         # Light teal\n            clusters.append('LH')\n        elif x < 0 and y < 0:\n            colors.append('#5F968E')         # Dark teal\n            clusters.append('LL')\n        elif x < 0 and y > 0:\n            colors.append('#FCD5CE')         # Light Pink \n            clusters.append('HL')\n    \n    # Scatter plot\n    ax.scatter(\n        uni_c['!s_aus_std'], uni_c[slag_col],\n        c=colors, s=np.random.seed(55), edgecolor='white', linewidth=0.3, alpha=0.8\n    )\n\n    # Add regression line\n    sns.regplot(\n        x='!s_aus_std', y=slag_col, data=uni_c,\n        scatter=False, ci=None, line_kws={\"color\": '#999999', \"linewidth\": 1.2}, ax=ax\n    )\n\n    # Axes\n    ax.axvline(0, color='#aaaaaa', linestyle='--', linewidth=0.8)\n    ax.axhline(0, color='#aaaaaa', linestyle='--', linewidth=0.8)\n\n    # Moran calculation\n    moran_k = Moran(uni_c['!s_aus'], w_k)\n    moran_i = moran_k.I\n    p_val = moran_k.p_sim\n\n    # Title\n    ax.set_title(f'k={k}', fontsize=12)\n    #ax.set_title(f'k={k}\\nMoran\\'s I = {moran_i:.3f}, P-value = {p_val:.3f}', fontsize=9)\n    # Axis labels\n    if i % n_cols == 0:\n        ax.set_ylabel(\"spatial lag of standardised university int. demand (!s_aus_slag_std)\", fontsize=8)\n    if i >= len(k_values) - n_cols:\n        ax.set_xlabel(\"standardised university international demand (!s_aus_std)\", fontsize=8)\n    if i % n_cols != 0:\n        ax.set_ylabel('')\n    if i < n_plots - n_cols:\n        ax.set_xlabel('')\n\n    # Tight axes\n    ax.set_xlim(uni_c['!s_aus_std'].min() - 0.1, uni_c['!s_aus_std'].max() + 0.1)\n    ax.set_ylim(uni_c[slag_col].min() - 0.1, uni_c[slag_col].max() + 0.1)\n\n# Hide any extra subplots\nfor j in range(len(k_values), len(axes)):\n    axes[j].set_visible(False)\n\n# Layout\nfig.suptitle(\"Higher Education Universities International Students Demand Moran's I Scatterplots for Different Number of Neighbours (k)\", fontsize=16, y=0.98)\nplt.tight_layout()\nplt.subplots_adjust(top=0.93, hspace=0.5, wspace=0.5)\n\nsave_path = os.path.join(hf, \"Higher Education Universities International Students Demand Moran's I Scatterplots for Different Number of Neighbours (k).png\")\nplt.savefig(save_path, dpi=300, bbox_inches=\"tight\")\n\nplt.tight_layout()\nplt.show()\n\n\n\nFigure XX. Higher Education Universities International Students Demand Moran’s I Scatterplots for Different Number of Neighbours (k)\n\nnp.random.seed(55)\n\nk_values = [2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20]\nmorans_I = []\np_values = []\n\nfor k in k_values:\n    w = libpysal.weights.KNN.from_dataframe(uni_c, k=k)\n    w.transform = \"R\"\n    moran = Moran(uni_c['!s_aus'], w)\n    morans_I.append(moran.I)\n    p_values.append(moran.p_sim)\n\n# Create DataFrame\nuni_k_test = pd.DataFrame({\n    'k': k_values,\n    \"Moran's I\": morans_I,\n    'P-value': p_values\n})\n\nuni_k_test\n\n\n\nTable XX. Higher Education Universities International Students Demand Moran’s I index and P-value for Different Number of Neighbors (k)\n\nThe Moran’s I distribution graph and P-value (Figure XX) show that the P-value takes acceptable values (P < 0.05) when k is between 2 and 10. Since we are talking about global spatial autocorrelation, the purpose of which is to identify patterns throughout Berlin, it is necessary to choose the maximum value of k. At the same time, the P-value when choosing 10 nearest neighbours is critically close to the significance threshold. Therefore, the previous value k=9 was chosen.\n\nplt.figure(figsize=(6, 6))\nplt.plot(uni_k_test['k'], uni_k_test[\"Moran's I\"], label=\"Moran's I\", color='#FEC5BB')\nplt.plot(uni_k_test['k'], uni_k_test['P-value'], label='P-value', color='#76A79D')\n\nplt.axhline(0.05, color='#A9CCC1', linestyle='--', linewidth=1.5, label=\"P = 0.05 (Significance Threshold)\")\nplt.grid(True, color='#cccccc', linestyle='--', alpha=0.3)\n\nplt.xlabel('k (number of neighbors)')\nplt.title(\"Moran's I and P-value\")\nplt.xticks(uni_k_test['k'])\nplt.legend(loc='best', frameon=False)\n\nsave_path = os.path.join(hf, \"International Students Demand Moran’s I index and P-value for Different Number of Neighbours (k).png\")\nplt.savefig(save_path, dpi=300, bbox_inches=\"tight\")\n\nplt.tight_layout()\nplt.show()\n\n\n\nFigure XX. Higher Education Universities International Students Demand Moran’s I index and P-value for Different Number of Neighbours (k)\n\n","type":"content","url":"/notebooks/global-spatial-autocorrelation#morans-i-scatterplots-test-k-nearest-neighbor-test-1","position":29},{"hierarchy":{"lvl1":"Higher Education Universities International Demand","lvl2":"Significance Threshold Test"},"type":"lvl2","url":"/notebooks/global-spatial-autocorrelation#significance-threshold-test-1","position":30},{"hierarchy":{"lvl1":"Higher Education Universities International Demand","lvl2":"Significance Threshold Test"},"content":"\n\nBy analogy with student accommodation capacity, the significance threshold was calculated as half of the median of the absolute value (median_abs * 0.5).\n\n# Option 1: Based on percentiles (recommended for your data)\nthreshold_percentile = np.percentile(np.abs(uni_c['!s_aus_std']), 75)  # 75th percentile of absolute values\nprint(f\"Option 1 - Percentile-based threshold: {threshold_percentile:.3f}\")\nprint(f\"  (75th percentile of absolute values)\")\n\n# Option 2: Based on standard deviation\nstd_dev = uni_c['!s_aus_std'].std()\nthreshold_std = 0.5 * std_dev  # 0.5 standard deviations\nprint(f\"Option 2 - Standard deviation-based threshold: {threshold_std:.3f}\")\nprint(f\"  (0.5 * standard deviation)\")\n\n# Option 3: Fixed threshold based on your data range\nthreshold_fixed = 550.0  # Fixed value appropriate for your range\nprint(f\"Option 3 - Fixed threshold: {threshold_fixed:.3f}\")\nprint(f\"  (Fixed value for your data range)\")\n\n# Option 4: Median-based threshold\nmedian_abs = np.median(np.abs(uni_c['!s_aus_std']))\nthreshold_median = median_abs * 0.5\nprint(f\"Option 4 - Median-based threshold: {threshold_median:.3f}\")\nprint(f\" (0.5 * median of absolute values)\")\n\nthresholds_to_test = [threshold_percentile, threshold_std, threshold_fixed, threshold_median]\n\nfor i, test_threshold in enumerate(thresholds_to_test, 1):\n    print(f\"\\nTest {i}: threshold = {test_threshold:.3f}\")\n    \n    # Count points in each category\n    ns_count = 0\n    hh_count = 0\n    lh_count = 0\n    ll_count = 0\n    hl_count = 0\n    \n    for x, y in zip(uni_c['!s_aus_std'], uni_c[slag_col]):\n        if abs(x) <= test_threshold and abs(y) <= test_threshold:\n            ns_count += 1\n        elif x > 0 and y > 0:\n            hh_count += 1\n        elif x > 0 and y < 0:\n            lh_count += 1\n        elif x < 0 and y < 0:\n            ll_count += 1\n        elif x < 0 and y > 0:\n            hl_count += 1\n    \n    total = len(uni_c)\n    print(f\"  NS: {ns_count} ({ns_count/total*100:.1f}%)\")\n    print(f\"  HH: {hh_count} ({hh_count/total*100:.1f}%)\")\n    print(f\"  LH: {lh_count} ({lh_count/total*100:.1f}%)\")\n    print(f\"  LL: {ll_count} ({ll_count/total*100:.1f}%)\")\n    print(f\"  HL: {hl_count} ({hl_count/total*100:.1f}%)\")\n\n\n\n","type":"content","url":"/notebooks/global-spatial-autocorrelation#significance-threshold-test-1","position":31},{"hierarchy":{"lvl1":"Higher Education Universities International Demand","lvl2":"Spatial Weights & Moran’s I & Spatial Lag"},"type":"lvl2","url":"/notebooks/global-spatial-autocorrelation#spatial-weights-morans-i-spatial-lag","position":32},{"hierarchy":{"lvl1":"Higher Education Universities International Demand","lvl2":"Spatial Weights & Moran’s I & Spatial Lag"},"content":"\n\n# Generate spatial weights from the GeoDataFrame\nw = KNN.from_dataframe(uni_c, k=9) \nw.transform = \"R\"  # Row-standardize weights\n\nvalues = uni_c['!s_aus']\n\nmoran = Moran(values, w)\nprint(f\"Moran's I: {moran.I:.3f}\")\nprint(f\"P-value: {moran.p_sim:.3f}\")\n\n\n\nMoran’s I (Moran's I: -0.082) indicates a weak negative spatial autocorrelation. In the context of urban planning, this indicates that higher education universities do not create spatial clusters; in other words, they are unevenly distributed throughout the city.\n\nP-value (P-value: 0.007) indicates that the probability of obtaining such a result by chance is 0.7%, i.e., the result obtained is statistically significant.\n\n","type":"content","url":"/notebooks/global-spatial-autocorrelation#spatial-weights-morans-i-spatial-lag","position":33},{"hierarchy":{"lvl1":"Higher Education Universities International Demand","lvl2":"Spatial Lag & Standardised Spatial Lag"},"type":"lvl2","url":"/notebooks/global-spatial-autocorrelation#spatial-lag-standardised-spatial-lag-1","position":34},{"hierarchy":{"lvl1":"Higher Education Universities International Demand","lvl2":"Spatial Lag & Standardised Spatial Lag"},"content":"\n\n# Add spatial lag and standardized columns\nuni_c[\"!s_aus_slag\"] = lag_spatial(w, uni_c[\"!s_aus\"])\nuni_c[\"!s_aus_std\"] = uni_c[\"!s_aus\"] - uni_c[\"!s_aus\"].mean()\nuni_c[\"!s_aus_slag_std\"] = lag_spatial(w, uni_c[\"!s_aus_std\"])\n\n\n\n# Define thresholds for \"Not Significant\"\nthreshold = threshold_median\n\ncolors = []\nclusters = []\n\nfor x, y in zip(uni_c['!s_aus_std'], uni_c['!s_aus_slag_std']):\n    if abs(x) <= threshold and abs(y) <= threshold:\n        colors.append('#FBF0EA')         # Cream for Not Significant\n        clusters.append('NS')\n    elif x > 0 and y > 0:\n        colors.append('#F08080')         # Pink\n        clusters.append('HH')\n    elif x > 0 and y < 0:\n        colors.append('#C8E0D4')         # Light teal\n        clusters.append('LH')\n    elif x < 0 and y < 0:\n        colors.append('#5F968E')         # Dark teal\n        clusters.append('LL')\n    elif x < 0 and y > 0:\n        colors.append('#FCD5CE')         # Light Pink \n        clusters.append('HL')\n\nuni_c['color'] = colors\nuni_c['cluster_aus'] = clusters\n\n\n\nThe maps (Figure XX) visualise the different stages of preparing international demand data for spatial analysis.\n\nfig, axs  = plt.subplots(2, 2, figsize=(18, 12))\n\n# a. University Demand (!s_aus)\npgr.plot(ax=axs[0, 0], facecolor='none', edgecolor='#cccccc', linewidth=0.5, linestyle=\"--\")\nbz.plot(ax=axs[0, 0], facecolor='none', edgecolor='#999999', linewidth=0.75)\nout.plot(ax=axs[0, 0], facecolor='none', edgecolor='#666666', linewidth=1)\nuni_c.plot(ax=axs[0, 0],\n          column='!s_aus',\n          cmap=cmap_pi,\n          markersize = np.sqrt(uni_c['!s_aus']),\n          alpha=0.9,\n          edgecolor='white',\n          linewidth=0.3,\n          legend=True,\n          legend_kwds={'shrink': 0.6, 'label': \"university international demand\"},\n          vmin=0,\n          vmax=uni_c['!s_aus'].quantile(0.95))\naxs[0, 0].set_title('a. University International Demand (!s_aus)', fontsize=14, pad=15, fontweight='bold')\naxs[0, 0].set_axis_off()\n\n# b. University Demand Influence (!s_aus_slag)\npgr.plot(ax=axs[0, 1], facecolor='none', edgecolor='#cccccc', linewidth=0.5, linestyle=\"--\")\nbz.plot(ax=axs[0, 1], facecolor='none', edgecolor='#999999', linewidth=0.75)\nout.plot(ax=axs[0, 1], facecolor='none', edgecolor='#666666', linewidth=1)\nuni_c.plot(ax=axs[0, 1],\n          column='!s_aus_slag',\n          cmap=cmap_pi,\n          markersize=np.sqrt(uni_c['!s_aus_slag']),\n          alpha=0.9,\n          edgecolor='white',\n          linewidth=0.3,\n          legend=True,\n          legend_kwds={'shrink': 0.6, 'label': \"university international demand spatial lag\"},\n          vmin=0,\n          vmax=uni_c['!s_aus'].quantile(0.95))\naxs[0, 1].set_title('b. University International Demand Influence (!s_aus_slag)', fontsize=14, pad=15, fontweight='bold')\naxs[0, 1].set_axis_off()\n\n# c. Standardised University Demand (!s_all_std)\nmax_abs_value = max(abs(uni_c['!s_aus_std'].min()), abs(uni_c['!s_aus_std'].max()))\nvmin, vmax = -max_abs_value, max_abs_value\npgr.plot(ax=axs[1, 0], facecolor='none', edgecolor='#cccccc', linewidth=0.5, linestyle=\"--\")\nbz.plot(ax=axs[1, 0], facecolor='none', edgecolor='#999999', linewidth=0.75)\nout.plot(ax=axs[1, 0], facecolor='none', edgecolor='#666666', linewidth=1)\nuni_c.plot(ax=axs[1, 0],\n          column='!s_aus_std',\n          cmap=cmap_mintpi,\n          markersize = np.sqrt(np.abs(uni_c['!s_aus_std'])),\n          alpha=0.9,\n          edgecolor='white',\n          linewidth=0.3,\n          legend=True,\n          legend_kwds={'shrink': 0.6, 'label': \"standardised university international demand\"},\n          vmin=vmin,\n          vmax=vmax)\naxs[1, 0].set_title('c. Standardised University International Demand (!s_aus_std)', fontsize=14, pad=15, fontweight='bold')\naxs[1, 0].set_axis_off()\n\n# d. Standardised University Demand Influence (!s_aus_slag_std)\nmax_abs_value = max(abs(uni_c['!s_aus_slag_std'].min()), abs(uni_c['!s_aus_slag_std'].max()))\nvmin, vmax = -max_abs_value, max_abs_value\npgr.plot(ax=axs[1, 1], facecolor='none', edgecolor='#cccccc', linewidth=0.5, linestyle=\"--\")\nbz.plot(ax=axs[1, 1], facecolor='none', edgecolor='#999999', linewidth=0.75)\nout.plot(ax=axs[1, 1], facecolor='none', edgecolor='#666666', linewidth=1)\nuni_c.plot(ax=axs[1, 1],\n          column='!s_aus_slag_std',\n          cmap=cmap_mintpi,\n          markersize=np.sqrt(np.abs(uni_c['!s_aus_slag_std'])),\n          alpha=0.9,\n          edgecolor='white',\n          linewidth=0.3,\n          legend=True,\n          legend_kwds={'shrink': 0.6, 'label': \"standardised university international demand spatial lag\"},\n          vmin=vmin,\n          vmax=vmax)\naxs[1, 1].legend(loc='lower center', ncol=2, frameon=False, prop={'size': 10})\naxs[1, 1].set_title('d. Standardised University International Demand Influence (!s_aus_slag_std)', fontsize=14, pad=15, fontweight='bold')\naxs[1, 1].set_axis_off()\n\nsave_path = os.path.join(hf, \"Stages of Preparing Higher Education Universities International Students Demand Data.png\")\nplt.savefig(save_path, dpi=300, bbox_inches=\"tight\")\n\nplt.tight_layout()\nplt.show()\n\n\n\nFigure XX. Stages of Preparing Higher Education Universities International Students Demand Data\n\nMoran’s graph (Figure XX) visualises the spatial relationships between standardised international university demand (!s_aus_std) and its spatial lag (!s_aus_slag_std). The division into four quadrants allows us to identify characteristic spatial patterns of demand distribution and understand where areas of high competition or, conversely, a lack of educational attractiveness are forming.\n\nQ1 – High–High (HH)These are clusters of high international demand, where universities with a large proportion of foreign students are located next to similarly significant neighbours. Such areas form stable ‘magnets’ for international students, for example, the College of Business and Law (HWR – 1,336 foreign students), the University of the Arts Berlin (UKB – 1,244 foreign students), and ESCP Business School Berlin (ESCP – 1,092 foreign students). At the same time, two of the three universities in the HH quadrant are publicly owned (HWR and UKB) and located in Willensdorf, while the private ESCP University is located in Charlottenburg. These three universities form a powerful spatial core of global education in West Berlin.\n\nQ2 – High–Low (HL)Spatial anomalies, where a university with high international demand is located among neighbouring universities with low values. This is the largest cluster among all universities. It mainly consists of individual private universities that have a localised impact and signal the beginning of the formation of new educational centres. Among the universities belonging to the HL cluster but funded by the state are the Technical University of Berlin, the Protestant University of Applied Sciences Berlin, and the Charité – University Medicine Berlin campuses in the south-west of the city.\n\nQ3 – Low–Low (LL)Clusters of low demand, where both the university itself and its surroundings attract relatively few foreign students. LL zones indicate areas where international educational activity is weak, such as Pankow, Lichtenberg, Friedrichshain-Kreuzberg, and Neukölln. Among the reasons for unrealised educational potential, one can assume a lack of infrastructure, limited academic activity, or weak integration into the city’s structure.\n\nQ4 – Low–High (LH)These are local failures, where a university demonstrates low international demand, but its environment demonstrates high demand. At the same time, seven of the nine universities in the LH quadrant are publicly owned. Universities such as the Free University of Berlin and Humboldt University of Berlin have the potential to participate in existing educational clusters, but are not yet strategically integrated into them.\n\nThis distribution indicates competition between universities, the existence of ‘hot spots’ of international activity, and, at the same time, structural territorial gaps.\nAll these patterns are important for studying the student housing crisis, as international demand directly correlates with increased pressure on the rental market, especially in highly attractive local clusters.\n\nf, ax = plt.subplots(1, figsize=(6, 6))\n\nscatter = ax.scatter(\n    x=uni_c['!s_aus_std'],\n    y=uni_c['!s_aus_slag_std'],\n    c=colors,\n    s=40,\n    edgecolor='white',\n    linewidth=0.3\n)\n\nsns.regplot(\n    x='!s_aus_std',\n    y='!s_aus_slag_std',\n    ci=None,\n    data=uni_c,\n    scatter=False,\n    line_kws={\"color\":'#cccccc', \"linewidth\": 2},\n    ax=ax\n)\n\nax.axvline(0, color='#cccccc', alpha=0.75, linestyle=\"--\")\nax.axhline(0, color='#cccccc', alpha=0.75, linestyle=\"--\")\n\nax.set_title(\"Moran Scatterplot: Standardised University International Demand\", fontsize=12, weight='bold')\nax.set_xlabel(\"standardised university international demand (!s_aus_std)\", fontsize=10)\nax.set_ylabel(\"spatial lag of standardised university international demand (!s_aus_slag_std)\", fontsize=10)\n\nax.text(4200, 600, \"High–High (HH)\", fontsize=9, color=\"gray\")\nax.text(4200, -300, \"Low–High (LH)\", fontsize=9, color=\"gray\") \nax.text(-500, -300, \"Low–Low (LL)\", fontsize=9, color=\"gray\") #\nax.text(-500, 600, \"High–Low (HL)\", fontsize=9, color=\"gray\") #\n\n\nax.set_xlim(uni_c['!s_aus_std'].min() - 0.5, uni_c['!s_aus_std'].max() + 0.5)\nax.set_ylim(uni_c['!s_aus_slag_std'].min() - 0.5, uni_c['!s_aus_slag_std'].max() + 0.5)\n\nsave_path = os.path.join(hf, \"Higher Education Universities International Students Demand Moran Scatterplot.png\")\nplt.savefig(save_path, dpi=300, bbox_inches=\"tight\")\n\nplt.tight_layout()\nplt.show()\n\n\n\nFigure XX. Higher Education Universities International Students Demand Moran Scatterplot\n\nThe map showing the spatial distribution of international student demand in Berlin (Figure XX) reveals that, unlike the supply of student housing, demand does not form stable clusters of high concentration. Instead of the expected spatial agglomeration around large public universities, there is a dispersion (scattering) of values. In other words, universities with high numbers of international students are not grouped geographically, but rather distributed in a fragmented manner and often separated from similar neighbours.\n\nThe east-west divide highlights Berlin’s historical asymmetry: the West traditionally concentrates international academic demand, while the East remains unattractive in an international context.\n\nThe demand for international students is distributed more chaotically and does not correlate with the spatial patterns of student housing supply, which exacerbates the structural imbalance between the housing market and the city’s academic infrastructure.\n\nfig, ax = plt.subplots(figsize=(12, 12))\n\n# Replace pgr, bz, out with your base layers if needed\npgr.plot(ax=ax, facecolor='none', edgecolor='#cccccc', linewidth=0.5, linestyle=\"--\")\nmauer.plot(ax=ax, facecolor='none', edgecolor='#666666', linewidth=1.25, linestyle=\"--\")\nbz.plot(ax=ax, facecolor='none', edgecolor='#999999', linewidth=0.75)\nfor idx, row in bz.iterrows():\n    centroid = row['geometry'].centroid\n    txt = ax.text(\n        centroid.x, centroid.y,\n        str(row['namgem']),\n        fontsize=8, color='#666666', ha='center', va='center'\n    )\n    txt.set_path_effects([\n        path_effects.Stroke(linewidth=2, foreground='white'),\n        path_effects.Normal()\n    ])\n\nout.plot(ax=ax, facecolor='none', edgecolor='#666666', linewidth=1.25)\n\nuni_c.plot(ax=ax,\n           color=uni_c['color'],\n           markersize=np.sqrt(np.abs(uni_c['!s_aus_std'])) + 5,\n           alpha=0.9,\n           edgecolor='white',\n           linewidth=0.3)\n\nlegend_elements = [\n    mpatches.Patch(color='#F08080', label='High-High (HH)', edgecolor='none'),\n    mpatches.Patch(color='#FCD5CE', label='High-Low (HL)', edgecolor='none'),\n    mpatches.Patch(color='#C8E0D4', label='Low-High (LH)', edgecolor='none'),\n    mpatches.Patch(color='#5F968E', label='Low-Low (LL)', edgecolor='none'), \n    mpatches.Patch(color='#FBF0EA', label='Not Significant (NS)', edgecolor='#FAE1DD'), \n]\n\nuni_c['color'] = colors\nuni_c['cluster'] = clusters\n\nax.legend(handles=legend_elements, loc='lower center', ncol=5, frameon=False, prop={'size': 10})\nax.set_title('Higher Education Universities International Demand Dispersion in Berlin', fontsize=16, weight='bold')\nax.set_axis_off()\n\nsave_path = os.path.join(hf, \"Higher_Education_Universities_International_Demand_Dispersion_in_Berlin.png\")\nplt.savefig(save_path, dpi=300, bbox_inches=\"tight\")\n\nplt.tight_layout()\nplt.show()\n\n\n\nFigure XX. Higher Education Universities International Demand Dispersion in Berlin\n\n","type":"content","url":"/notebooks/global-spatial-autocorrelation#spatial-lag-standardised-spatial-lag-1","position":35},{"hierarchy":{"lvl1":"Higher Education Universities International Demand","lvl2":"Data Export"},"type":"lvl2","url":"/notebooks/global-spatial-autocorrelation#data-export-1","position":36},{"hierarchy":{"lvl1":"Higher Education Universities International Demand","lvl2":"Data Export"},"content":"\n\n# List of columns to drop\ncols_to_drop = [f'!s_aus_slag_std_k{i}' for i in range(1, 21)]\n\n# Drop them from the GeoDataFrame\nuni_c = uni_c.drop(columns=cols_to_drop)\n\n\n\nThe data on higher education universities’ international students demand obtained as a result of global spatial autocorrelation was collected for further market analysis.\n\nhf = r'../outputs/2.4_global_spatial_autocorrelation/uni_int_demand_analysis.gpkg'\nuni_c.to_file(hf, driver=\"GPKG\")\n\n","type":"content","url":"/notebooks/global-spatial-autocorrelation#data-export-1","position":37},{"hierarchy":{"lvl1":"3.1 Overview"},"type":"lvl1","url":"/notebooks/overview-1","position":0},{"hierarchy":{"lvl1":"3.1 Overview"},"content":"Chapter Student Housing Market Imbalance analyses the imbalance between university demand and student housing capacity.","type":"content","url":"/notebooks/overview-1","position":1},{"hierarchy":{"lvl1":"3.1 Overview","lvl2":"What? Student Housing Market Imbalance"},"type":"lvl2","url":"/notebooks/overview-1#what-student-housing-market-imbalance","position":2},{"hierarchy":{"lvl1":"3.1 Overview","lvl2":"What? Student Housing Market Imbalance"},"content":"Student Housing Market Imbalance can be understood as a set of statistically significant patterns that constitute mismatches between student housing capacity supply and university demand for higher education.\n\nAmong these patterns, one of the most important is pressure on the student housing market. Based on the conclusions drawn in the Capacities, Demand & Spatial Distribution Chapter, it can be assumed that pressure on the market is not evenly distributed.","type":"content","url":"/notebooks/overview-1#what-student-housing-market-imbalance","position":3},{"hierarchy":{"lvl1":"3.1 Overview","lvl2":"Why? Assess Spatial Demand–Supply Imbalances"},"type":"lvl2","url":"/notebooks/overview-1#why-assess-spatial-demand-supply-imbalances","position":4},{"hierarchy":{"lvl1":"3.1 Overview","lvl2":"Why? Assess Spatial Demand–Supply Imbalances"},"content":"The aim of this chapter is to assess the student housing market imbalances, identify areas where demand exceeds supply by answering the following research questions:\n\nHow do student university demand compare to student housing market housing capacities?\n\nWhere do spatial patterns of demand and supply generate elevated market pressure?\n\nThe answers to these questions are necessary to understand how and where pressure on the student housing market is formed in the city.","type":"content","url":"/notebooks/overview-1#why-assess-spatial-demand-supply-imbalances","position":5},{"hierarchy":{"lvl1":"3.1 Overview","lvl2":"How? Spatial Data Analysis"},"type":"lvl2","url":"/notebooks/overview-1#how-spatial-data-analysis","position":6},{"hierarchy":{"lvl1":"3.1 Overview","lvl2":"How? Spatial Data Analysis"},"content":"Unlike the Capacities, Demand & Spatial Distribution Chapter, where the analysis of the two systems was conducted sequentially, this chapter aimed to combine the data using spatial join and conduct a comparative analysis of the student housing market according to the Central Place Theory outlined in the Theoretical Framework chapter.\n\nSpatial JoinA spatial join combines represented geographic objects and their associated attributes based on a spatial relationship (University of West Florida and Morgan, 2023). In other words, spatial joins allow you to combine multiple data sets based on spatial characteristics. For example, you can calculate the total student housing capacity and university demand for the Mitte district.\n\nHowever, such a rough approach is not suitable for a detailed analysis of the student housing market, as Berlin’s districts vary greatly in size, so simple spatial intersection and subsequent aggregation distort the real picture of market pressure. In order to increase the accuracy of the spatial join, an isochrone accessibility analysis was performed.\n\nIsochrone AnalysisAn isochrone in geography and urban planning is a polygon that depicts the area accessible from a point within a certain time threshold, i.e., isochrones calculate accessibility in terms of time (OpenStreetMap Wiki, 2025). This allows administrative district boundaries to be replaced with more functional zones - zones of student mobility. Thus, isochrone analysis eliminates the problem of mismatched district areas and focuses on the actual patterns of student movement.\n\nBased on isochrones, it is possible to perform a spatial join between university demand and student housing capacity. However, such isochrones often overlap with each other, which leads to the problem of overlap. One solution to the problem of overlap is rasterisation.\n\nRasterisationRasterisation converts vectors into rasters. In Geospatial Science, it usually means converting vector geometry to raster geometry. It can be used to summarise data from several objects. Since accessibility isochrones intersect with each other, rasterisation — the conversion of geometry into a regular grid — is performed to match spatially heterogeneous supply and demand data.\n\nThese research methods allow for a parallel assessment of market areas and show how spatial patterns exacerbate or mitigate the shortage of student housing, forming or neutralising market pressure.\n\nThus, the chapter demonstrates the geography of the student housing market, identifying the most problematic areas.","type":"content","url":"/notebooks/overview-1#how-spatial-data-analysis","position":7},{"hierarchy":{"lvl1":"3.2 Central Place Analysis"},"type":"lvl1","url":"/notebooks/central-place-analysis","position":0},{"hierarchy":{"lvl1":"3.2 Central Place Analysis"},"content":"import warnings\n\nwarnings.filterwarnings(\"ignore\")\n\nimport os\nhf = r'../outputs/3.2_central_place_analysis/'\nos.makedirs(hf, exist_ok=True)\n\n\n\n","type":"content","url":"/notebooks/central-place-analysis","position":1},{"hierarchy":{"lvl1":"3.2 Central Place Analysis"},"type":"lvl1","url":"/notebooks/central-place-analysis#id-3-2-central-place-analysis","position":2},{"hierarchy":{"lvl1":"3.2 Central Place Analysis"},"content":"\n\nThe chapter Student Housing Market: Capacities, Demand, and Spatial Distribution provides a consistent analysis of two systems: student accommodations and higher education universities.\n\nTo proceed to market analysis, it is necessary to examine how these two systems interact with each other, forming the student accommodation market. Central Place Theory, outlined in the chapter Theoretical Framework, assists in navigating the analysis process.\n\n","type":"content","url":"/notebooks/central-place-analysis#id-3-2-central-place-analysis","position":3},{"hierarchy":{"lvl1":"3.2 Central Place Analysis","lvl3":"Set Up"},"type":"lvl3","url":"/notebooks/central-place-analysis#set-up","position":4},{"hierarchy":{"lvl1":"3.2 Central Place Analysis","lvl3":"Set Up"},"content":"\n\nImport Libraries\n\nimport os\nimport numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport matplotlib as mpl\nimport geopandas as gpd\nfrom shapely.geometry import Point, MultiPoint\nfrom pyproj import CRS\nfrom scipy.stats import norm\nfrom matplotlib.colors import LinearSegmentedColormap\nimport matplotlib.patheffects as path_effects\nimport string\nimport requests\nimport time\nfrom shapely.geometry import Polygon\nimport seaborn as sns\nfrom shapely.geometry import MultiPolygon\n\n\n\nColors\n\ncolor_palettes = {\n    \"Mint\": [\"#EAF4E8\", \"#C8E0D4\", \"#A9CCC1\", \"#8FB9AE\", \"#76A79D\", \"#5F968E\", \"#498581\"], \n    \"Pi\": [\"#F8EDEB\", \"#FAE1DD\", \"#FCD5CE\", \"#FEC5BB\", \"#F8AD9D\", \"#F4978E\", \"#F08080\"],\n    \"Or\": [\"#FFE5D9\", \"#FFD7BA\", \"#FEC89A\", \"#FFB78F\", \"#F49F7D\", \"#F28B6D\", \"#E1755CFF\"],\n    \"GrSc\":  ['#EFEFEF', '#D9D9D9', '#CCCCCC', '#B7B7B7', '#999999', '#666666', '#434343'],\n    \"MintPi\": [\"#76A79D\", \"#8FB9AE\", \"#A9CCC1\", \"#C8E0D4\", \"#FBF0EA\", \"#FCD5CE\", \"#FEC5BB\", \"#F8AD9D\", \"#F4978E\"],\n    \"MintOr\": [\"#76A79D\", \"#8FB9AE\", \"#A9CCC1\", \"#C8E0D4\", \"#FBF0EA\", \"#FFD7BA\", \"#FEC89A\", \"#FFB78F\", \"#F28B6D\"],\n    \"MiPiOr\": ['#EAF4E8', '#FAE1DD', '#C8E0D4', '#FFD7BA', '#F8EDEB', '#FCD5CE', '#FFE5D9']\n}\n\ncmap_mint = LinearSegmentedColormap.from_list(\"Mint\", color_palettes[\"Mint\"])\ncmap_pi = LinearSegmentedColormap.from_list(\"Pi\", color_palettes[\"Pi\"])\ncmap_or = LinearSegmentedColormap.from_list(\"Or\", color_palettes[\"Or\"])\ncmap_mintpi = LinearSegmentedColormap.from_list(\"MintPi\", color_palettes[\"MintPi\"])\ncmap_mintor = LinearSegmentedColormap.from_list(\"MintOr\", color_palettes[\"MintOr\"])\ncmap_grsc = LinearSegmentedColormap.from_list(\"GrSc\", color_palettes[\"GrSc\"])\ncmap_mipior = LinearSegmentedColormap.from_list(\"MiPiOr\", color_palettes[\"MiPiOr\"])\n\n\n\nFont\n\nplt.rcParams[\"font.family\"] = \"Helvetica\"\n\n\n\nBerlin Spatial Boundaries\n\npf = r\"../inputs/3.2_central_place_analysis/lor_pgr.gpkg\"\npgr = gpd.read_file(pf)\npgr.replace({'-': np.nan, 0: np.nan, '': np.nan}, inplace=True)\n\nbf = r\"../inputs/3.2_central_place_analysis/adm_bz.gpkg\"\nbz = gpd.read_file(bf)\nbz.replace({'-': np.nan, 0: np.nan, '': np.nan}, inplace=True)\n\nof = r\"../inputs/3.2_central_place_analysis/adm_out.gpkg\"\nout = gpd.read_file(of)\nout.replace({'-': np.nan, 0: np.nan, '': np.nan}, inplace=True)\n\n\n\nThe analysis of student accommodation capacity and higher education universities’ international student demand data, obtained as a result of Global Spatial Autocorrelation, served as the basis for student housing market research.\n\nef = r'../inputs/3.2_central_place_analysis/pbsa_capacity_analysis.gpkg'\npbsa_cap = gpd.read_file(ef)\n\nmf = r'../inputs/3.2_central_place_analysis/uni_int_demand_analysis.gpkg'\nuni_dem = gpd.read_file(mf, driver=\"GPKG\")\n\n\n\n","type":"content","url":"/notebooks/central-place-analysis#set-up","position":5},{"hierarchy":{"lvl1":"Central Places Definition"},"type":"lvl1","url":"/notebooks/central-place-analysis#central-places-definition","position":6},{"hierarchy":{"lvl1":"Central Places Definition"},"content":"\n\nIn Central Place Theory King (1986) argue that the idea that there is a smooth and regular progression in urban centres from the smallest up to the largest center - is not a very useful one, and that greater insight can be gained into the nature of an urban pattern by referring to discrete population-size classes.\n\nTaking this into account, central universities should be defined not as the ‘largest’ in terms of numbers, but as institutions that perform central functions in the urban system. Their significance is determined not so much by the scale of student enrolment as by their functional role, their position in the urban and educational hierarchy, and their ability to serve wider areas of attraction.\n\nCleaning Higher Education Universities Data Set\n\nuni_dem = uni_dem.dropna(subset=['!s_aus'])\n\nuni_dem = uni_dem.drop(columns=['!s_aus_std', '!s_aus_slag', '!s_aus_slag_std'])\n\n\n\nIn order to determine which universities are considered central, the following concerns must be taken into account.\n\nFirstly, based on spatial economics analysis of university clusters, only High–High (HH), Low–High (LH) and High–Low (HL) clusters are capable of generating sustained high demand in the housing market, fulfilling the functional roles of centres. Meanwhile, Low–Low (LL) clusters do not form centres of demand.\n\nSecondly, the number of central universities must be limited, as 26 out of 52 universities cannot be central by definition.\n\nOnly by taking this into account can a quantitative test be conducted using the international student demand (!s_aus) threshold.\n\n# Option 1: Based on percentiles (recommended for your data)\nthreshold_percentile = np.percentile(np.abs(uni_dem['!s_aus']), 75)  \n# 75th percentile of absolute values\nprint(f\"Option 1 - Percentile-based threshold: {threshold_percentile:.3f}\")\nprint(f\"  (75th percentile of absolute values)\")\n\n# Option 2: Based on standard deviation\nstd_dev = uni_dem['!s_aus'].std()\nthreshold_std = 0.5 * std_dev  # 0.5 standard deviations\nprint(f\"Option 2 - Standard deviation-based threshold: {threshold_std:.3f}\") #Standard deviation für alle features \nprint(f\"  (0.5 * standard deviation)\")\n\n# Option 3: Fixed threshold based on your data range\nthreshold_fixed = 550.0  # Fixed value appropriate for your range\nprint(f\"Option 3 - Fixed threshold: {threshold_fixed:.3f}\")\nprint(f\"  (Fixed value for your data range)\")\n\n# Option 4: Median-based threshold\nmedian_abs = np.median(np.abs(uni_dem['!s_aus']))\nthreshold_median = median_abs * 0.5\nprint(f\"Option 4 - Median-based threshold: {threshold_median:.3f}\")\nprint(f\" (0.5 * median of absolute values)\")\n\nthresholds_to_test = [threshold_percentile, threshold_std, threshold_fixed, threshold_median]\n\nfor i, test_threshold in enumerate(thresholds_to_test, 1):\n    print(f\"\\nTest {i}: threshold = {test_threshold:.3f}\")\n    \n    test_centr = uni_dem[\n        (uni_dem['cluster'].isin(['HL', 'HH', 'LH', 'LL',])) & \n        (uni_dem['!s_aus'] >= test_threshold)\n        ]\n\n    print(f\"Total features: {len(test_centr)}\")\n    print(f\"Total demand: {test_centr['!s_aus'].sum()}\")\n\n    print(f\"Features with cluster = 'NS': {len(test_centr[test_centr['cluster'] == 'NS'])}\")\n    print(f\"Features with cluster = 'HH': {len(test_centr[test_centr['cluster'] == 'HH'])}\")\n    print(f\"Features with cluster = 'LH': {len(test_centr[test_centr['cluster'] == 'LH'])}\")\n    print(f\"Features with cluster = 'HL': {len(test_centr[test_centr['cluster'] == 'HL'])}\")\n    print(f\"Features with cluster = 'LL': {len(test_centr[test_centr['cluster'] == 'LL'])}\")\n\n\n\n\nIn order to correctly interpret the Threshold Test, it is necessary to pay attention to the number of universities and their distribution across four spatial clusters.\n\nOption 1 - Percentile-based threshold: 414,000With a percentile-based threshold, the upper quarter of the distribution is selected, taking into account three spatial clusters - HH, LH and HL. It also significantly reduces the sample from 52 to 15 universities, fixing the central nodes of the pair. Therefore, this threshold creates a threshold that reflects the real structure of the student housing market. (theshold = threshold_percentile).\n\nOption 2 - Standard deviation-based threshold: 828.251Option 3 - Fixed threshold: 550.000Standard deviation-based and fixed thresholds exclude HL clusters that are early indicators of the development of new student attraction zones.\n\nOption 4 - Median-based threshold: 51.000With a median-based threshold, almost all universities become ‘central,’ which devalues the category itself.\n\nThus, using the spatial clusters and percentile-based threshold filter, 15 universities (Table XX) were identified as central.\n\nТаким образом, с помошью фильтра по spatial clusters and percentile-based threshold было получено 15 университетов (Table XX), которые являються центральными.\n\ncentral_places = uni_dem[\n    (uni_dem['cluster_aus'].isin(['HL', 'HH', 'LH'])) & \n    (uni_dem['!s_aus'] >= threshold_percentile)\n]\n\n\n\ncentral_places[[\n    \"code\",\n    \"abr\",\n    \"name\",\n    \"own\",\n    \"cluster\",\n    \"!s_aus\"\n]]\n\n\n\nTable XX. Central Higher Education Universities\n\n","type":"content","url":"/notebooks/central-place-analysis#central-places-definition","position":7},{"hierarchy":{"lvl1":"Market Areas Definition"},"type":"lvl1","url":"/notebooks/central-place-analysis#market-areas-definition","position":8},{"hierarchy":{"lvl1":"Market Areas Definition"},"content":"\n\nOnce the central universities have been identified, the next step is to define market areas that jointly reflect data on higher education universities’ international demand and student accommodation capacity. As noted in the Overview chapter, there are several approaches to combining these data. Here are three primary approaches.\n\nThe first approach is to use Berlin’s existing administrative boundaries, such as Life-Oriented Spaces (LOR - Lebensweltlich Orientierte Räume) or their sub-level Neighbourhood Districts (BZR - Bezirksregionen). However, this method creates significant gaps: many areas end up “empty” because they have neither universities nor student accommodation. This indicates that neighbourhood districts are too small for analysing the urban supply and demand system. The next level, Prognosis Areas (PGR), on the contrary, is too large and aggregates too heterogeneous areas. Thus, the existing life-oriented spaces do not reflect the real geography of the student housing market.\n\nThe second approach is to build buffer zones around central universities, creating new geometries for spatial data integration. However, due to Berlin’s heterogeneous morphology, it is impossible to correctly determine a universal buffer distance. In addition, this method results in all market areas being the same size, which contradicts the actual structure of urban accessibility and central place theory.\n\nThe third approach is to use accessibility isochrones, i.e., zones formed on the basis of actual travel time. Unlike administrative boundaries or fixed buffers, isochrones reflect the actual spatial relationship  and student mobility. This allows for the creation of flexible and functionally relevant market areas in which supply and demand can be matched more accurately.\n\nTo construct accessibility isochrones, the study used the Travel Time API service, which allows modelling reachability zones based on real-time travel. A distinctive feature of the Travel Time service is the ability to generate isochrones based on public transport estimates (‘type’: ‘public_transport’).\n\nBelow is an example of using the Travel Time API to create 15-minute accessibility zones (travel_time = 900).\n\n# url = 'https://api.traveltimeapp.com/v4/time-map'\n\n# tt_app_id = 'my_app_id'\n# tt_api_key = 'my_api_key'\n\n# headers = {\n#     'content-type': 'application/json',\n#     'x-application-id': tt_app_id,\n#     'x-api-key': tt_api_key\n# }\n\n# travel_time = 900 # 15 minutes\n\n# for idx, row in central_places.iterrows():\n#     lon = float(row['lon'])\n#     lat = float(row['lat'])\n\n#     payload = {\n#         \"arrival_searches\": [\n#             {\n#                 \"id\": f\"iso_{idx}\",\n#                 \"coords\": {\"lat\": lat, \"lng\": lon},\n#                 \"arrival_time\": \"2025-08-13T09:00:00+01:00\",\n#                 \"travel_time\": travel_time,\n#                 \"transportation\": {\"type\": \"public_transport\", \"disable_border_crossing\": True } \n#             }\n#         ]\n#     }\n\n#     resp = requests.post(url, json=payload, headers=headers)\n#     print(f\"request {idx}: {resp.status_code} {resp.reason} for location {[lon, lat]}\")\n\n#     if resp.ok:\n#         data = resp.json()\n#         for res in data.get('results', []):\n#             search_id = res.get('search_id')\n#             for shp in res.get('shapes', []):\n#                 shell = shp.get('shell', [])\n#                 if not shell:\n#                     continue\n#                 coords = [(pt['lng'], pt['lat']) for pt in shell]\n#                 if coords and coords[0] != coords[-1]:\n#                     coords.append(coords[0])\n#                 poly = Polygon(coords)\n#                 g = gpd.GeoDataFrame([{'geometry': poly, 'tt_id': search_id, \n#                                       'origin_lon': lon, 'origin_lat': lat}],\n#                                       crs='EPSG:4326')\n#                 iso_gdf = gpd.GeoDataFrame(pd.concat([iso_gdf, g], \n#                                                       ignore_index=True, \n#                                                       sort=False))\n\n#         time.sleep(15)\n\n# print(f\"got {len(iso_gdf)} isochrone polygons.\")\n\n\n\n# iso_gdf[\"geometry\"] = iso_gdf[\"geometry\"].buffer(0)\n# iso_gdf.to_crs(epsg=25833)\n\n# ef = r\"../outputs/3.2_central_place_analysis/iso_without_data_15_min.gpkg\"\n# iso_gdf.to_file(ef, driver=\"GPKG\")\n\n\n\n","type":"content","url":"/notebooks/central-place-analysis#market-areas-definition","position":9},{"hierarchy":{"lvl1":"Travel Time Test"},"type":"lvl1","url":"/notebooks/central-place-analysis#travel-time-test","position":10},{"hierarchy":{"lvl1":"Travel Time Test"},"content":"\n\nSince isochrones are sensitive to travel time, a travel time test was conducted (Figure XX) to determine market areas where travel time varied from 10 to 35 minutes with 5-minute intervals (isochrone_times = [10, 15, 20, 25, 30, 35]).\n\n# Define isochrone time ranges\nisochrone_times = [10, 15, 20, 25, 30, 35]\nbase_path = \"../outputs/3.2_central_place_analysis\"\n\n# Initialize results storage\nresults_summary = []\npbsa_market_summary = None\niso_dem_ready = None \npbsa_cap_ready = None\nsummary_df = None\n\n\n\ntotal_capacity_complete = pbsa_cap[\"!cap\"].sum()\ntotal_demand_complete = uni_dem[\"!s_aus\"].sum()\n\npbsa_cap = pbsa_cap.to_crs(\"EPSG:25833\")\ncentral_places = central_places.to_crs(\"EPSG:25833\")\n\n\n\nn_rows, n_cols = 3, 2   \nfig, axs = plt.subplots(\n    nrows=n_rows,\n    ncols=n_cols,\n    figsize=(9 * n_cols, 6 * n_rows)\n)\n\nfor idx, time_min in enumerate(isochrone_times):\n    r, c = divmod(idx, n_cols)         \n    ax = axs[r, c]\n\n    file_path = os.path.join(base_path, f\"iso_without_data_{time_min}_min.gpkg\")\n    market = gpd.read_file(file_path).to_crs(\"EPSG:25833\")\n\n\n    pgr.plot(ax=ax,facecolor='none',edgecolor='#cccccc',linewidth=0.5,linestyle='--')\n    bz.plot(ax=ax,facecolor='none',edgecolor='#999999',linewidth=0.75)\n    out.plot(ax=ax,facecolor='none',edgecolor='#666666',linewidth=1)\n\n    market.plot(\n        ax=ax,\n        color=\"#FEC5BB\",          #.reversed()   # <-- choose any matplotlib colormap\n        alpha=0.35,\n        edgecolor='white',\n        linewidth=1,\n        legend=True,\n        legend_kwds={'shrink': 0.6, 'label': \"demand‑capacity pressure\"}\n    )\n\n    letter = string.ascii_lowercase[idx]  # 'a', 'b', 'c', …\n    ax.set_title(f\"{letter}. Travel Time – {time_min} minutes\", fontsize=12, pad=8, fontweight='bold')\n    ax.set_axis_off()\n    plt.tight_layout()\n\nsave_path = os.path.join(hf, \"Travel Time Test.png\")\nplt.savefig(save_path, dpi=300, bbox_inches=\"tight\")\n\nplt.show()\n\n\n\nFigure XX. Travel-Time API Test\n\nWhen constructing isochrones, it is important to correctly interpret the allocation of student housing capacity and higher education universities demand.\n\nThe allocation of student accommodations is performed using a spatial join between points and isochrone polygons. Since one student accommodations facility may be located within the catchment area of several universities, directly assigning its full capacity to each area would lead to a significant overestimation of supply. To avoid double-counting, each student accommodation facility first receives information about the number of isochrones in which it is located, after which its capacity is divided equally among all relevant areas. The adjusted values are then aggregated at the market area level. This approach allows for the correct distribution of available housing in accordance with the actual spatial structure of accessibility, taking into account the overlap of the areas of influence of different universities.\n\nSimilar to the distribution of dormitories, university demand (number of German students (!s_de), number of foreign students (!s_aus) and total number of students (!s_all)) is assigned to isochrones based on the principle of spatial intersection. Universities may also lie within several isochrones, especially when accessibility times are long (30–35 minutes). Therefore, the demand for each university is divided among all the zones within which it falls. This method eliminates artificial doubling of demand and creates a balanced distribution that reflects the real impact of universities on the housing market within their accessibility zones. The final demand values are aggregated at the market area level and can be compared with the distributed student accommodation capacity.\n\nfor time_min in isochrone_times:\n    # Load isochrone data\n    iso_file = f\"{base_path}/iso_without_data_{time_min}_min.gpkg\"\n    iso_gdf = gpd.read_file(iso_file)\n    \n    # Reproject immediately\n    if iso_gdf.crs != \"EPSG:25833\":\n        iso_gdf = iso_gdf.to_crs(\"EPSG:25833\")\n\n    # Build multipolygons per tt_id \n    iso_multi = (\n        iso_gdf.groupby([\"tt_id\", \"origin_lon\", \"origin_lat\"])\n        .geometry.apply(lambda g: MultiPolygon([geom for geom in g]))\n        .reset_index()\n    )\n    iso_multi_gdf = gpd.GeoDataFrame(iso_multi, geometry=\"geometry\", crs=\"EPSG:25833\")\n\n    # Prepare central places (no geometry needed for merge)\n    central_places_no_geom = central_places.drop(columns=\"geometry\")\n    central_places_no_geom[\"lon\"] = central_places_no_geom[\"lon\"].astype(float)\n\n    # Merge on origin_lon/lon\n    iso_multi_gdf[\"origin_lon\"] = iso_multi_gdf[\"origin_lon\"].astype(float)\n    iso_dem = iso_multi_gdf.merge(\n        central_places_no_geom,\n        left_on=\"origin_lon\",\n        right_on=\"lon\"\n    )\n    iso_dem = gpd.GeoDataFrame(iso_dem, geometry=\"geometry\", crs=\"EPSG:25833\")\n    iso_dem = iso_dem.drop(columns=[\"origin_lon\", \"url\"])\n    iso_dem[\"geometry\"] = iso_dem[\"geometry\"].buffer(0)   # fix invalids\n\n    # From here everything is already in EPSG:25833\n    pbsa_cap_ready = pbsa_cap.copy()\n    if \"pbsa_id\" not in pbsa_cap_ready.columns:\n        pbsa_cap_ready[\"pbsa_id\"] = pbsa_cap_ready.index\n    \n    iso_dem_ready = iso_dem.copy()\n    if \"iso_id\" not in iso_dem_ready.columns:\n        iso_dem_ready[\"iso_id\"] = iso_dem_ready.index\n    \n    uni_dem = uni_dem.copy()\n    if 'uni_id' not in uni_dem.columns:\n        uni_dem['uni_id'] = uni_dem.index\n\n    # PBSA allocation\n    join_pbsa = gpd.sjoin(pbsa_cap_ready, iso_dem_ready, how=\"inner\", predicate=\"intersects\")\n    n_iso_pbsa = join_pbsa.groupby(\"pbsa_id\")[\"iso_id\"].nunique().rename(\"n_iso_pbsa\")\n    join_pbsa = join_pbsa.merge(n_iso_pbsa, left_on=\"pbsa_id\", right_index=True, how=\"left\")\n    cap_cols = [\"!cap\"]\n    for c in cap_cols:\n        join_pbsa[f\"{c}_sum\"] = join_pbsa[c] / join_pbsa[\"n_iso_pbsa\"]\n    iso_alloc_pbsa = (\n        join_pbsa.groupby(\"iso_id\")[[f\"{c}_sum\" for c in cap_cols]]\n        .sum().reset_index()\n    )\n    \n    # --- UNI allocation ---\n    join_uni = gpd.sjoin(uni_dem, iso_dem_ready, how='inner', predicate='intersects')\n    n_iso_uni = join_uni.groupby('uni_id')['iso_id'].nunique().rename('n_iso_uni')\n    join_uni = join_uni.merge(n_iso_uni, left_on='uni_id', right_index=True, how='left')\n    dem_cols = ['!s_aus_left', '!s_de_left', '!s_all_left']\n    for c in dem_cols:\n        join_uni[f'{c}_sum'] = join_uni[c] / join_uni['n_iso_uni']\n    iso_alloc_uni = (join_uni.groupby('iso_id')[[f'{c}_sum' for c in dem_cols]]\n                 .sum()\n                 .reset_index())\n    \n    # Merge results\n    market_area = iso_dem_ready.merge(iso_alloc_pbsa, on=\"iso_id\", how=\"left\")\n    market_area = market_area.merge(iso_alloc_uni, on=\"iso_id\", how=\"left\")\n    \n    market_area = market_area.rename(columns={\n        \"!s_aus_left_sum\": \"!s_aus_sum\",\n        \"!s_de_left_sum\": \"!s_de_sum\",\n        \"!s_all_left_sum\": \"!s_all_sum\",\n    })\n    \n    # Ratios\n    market_area[\"capacity_demand_ratio\"] = (\n        market_area[\"!cap_sum\"] / market_area[\"!s_aus_sum\"].replace(0, np.inf)\n    )\n    market_area[\"demand_capacity_pressure\"] = (\n        market_area[\"!s_aus_sum\"] / market_area[\"!cap_sum\"].replace(0, np.inf)\n    )\n    market_area[\"area\"] = market_area.geometry.area / 1e6 # in sq km\n    \n    # PBSA count\n    pbsa_pts = pbsa_cap_ready.copy()\n    wb = gpd.sjoin(pbsa_pts, market_area[[\"iso_id\", \"geometry\"]], how=\"inner\", predicate=\"within\")\n    pbsa_counts = wb.groupby(\"iso_id\").size()\n    market_area[\"pbsa_count\"] = market_area[\"iso_id\"].map(pbsa_counts).fillna(0).astype(int)\n\n    # Uni Count \n    uni_pts = uni_dem.copy()   # again, geometry is already active\n    # Spatial join: UNI point within isochrone polygon\n    wb = gpd.sjoin(uni_pts, market_area[['iso_id', 'geometry']], how='inner', predicate='within')\n    # Count UNI per iso_id\n    uni_counts = wb.groupby('iso_id').size()\n    # Attach to market_area – fill missing with 0\n    market_area['uni_count'] = market_area['iso_id'].map(uni_counts).fillna(0).astype(int)\n    \n    # Travel time\n    market_area[\"travel_time_min\"] = time_min\n    \n    #Cleaning \n    market_area['cluster'] = market_area['cluster'].map({\n    'HH': 'High-High (HH)',\n    'HL': 'High-Low (HL)', \n    'LH': 'Low-High (LH)',\n    'LL': 'Low-Low (LL)',\n    'NS': 'Not Significant (NS)'\n    })\n    columns_to_drop = ['origin_lat', 'origin_lon', 'cluster_aus', 'iso_id', 'lon']\n    market_area = market_area.drop(columns=columns_to_drop, errors='ignore')\n\n    # Save\n    output_file = f\"{base_path}/market_areas_{time_min}_min.gpkg\"\n    market_area.to_file(output_file, driver=\"GPKG\")\n    \n    # Summary stats\n    total_capacity_inside = market_area[\"!cap_sum\"].sum()\n    total_demand_inside = market_area[\"!s_aus_sum\"].sum()\n\n    uncovered_demand = total_demand_complete - total_demand_inside\n    unused_capacity = total_capacity_complete - total_capacity_inside\n    \n    results_summary.append({\n        \"travel_time_min\": time_min,\n        \"total_capacity_inside\": total_capacity_inside,\n        \"total_demand_inside\": total_demand_inside,\n        \"uncovered_demand\": uncovered_demand,\n        \"unused_capacity\": unused_capacity,\n        # \"market_areas_count\": len(market_area),\n        # \"market_areas_with_capasity\": len(market_area[market_area['!cap_sum'].notnull()]),\n    })\n\n\n\nBy changing the time thresholds, it is possible to check the stability of market areas: whether the structure of supply and demand zones changes or remains stable. To do this, at the final stage, a summary of key indicators is formed for each tested time of availability, allowing us to assess how effectively the formed market areas reflect the real structure of supply and demand. The table (Table XX) contains: the total capacity of dormitories that fall within the isochrones (total_capacity_inside) and the total university demand covered by these same areas (total_demand_inside).\n\n# Create summary DataFrame\nsummary_df = []\n\nsummary_df = pd.DataFrame(results_summary).round(1)\n\nsummary_df.sort_values(\"travel_time_min\", inplace=True)\n\nsummary_df\n\n\n\nTable XX. Travel Time Summary Statistics\n\noutput_path = r\"../outputs/3.2_central_place_analysis/market_area_travel_time.xlsx\" \nwith pd.ExcelWriter(output_path, engine='openpyxl') as writer:\n    summary_df.to_excel(writer, sheet_name='base')\n\n\n\nComparing these indicators between different time thresholds (10–35 minutes) (Figure XX) allows us to determine the optimal radius of market influence of universities, as well as to identify structural imbalances between supply and demand associated with spatial constraints. This approach provides a quantitative basis for selecting the isochrone threshold and correctly forming market areas.\n\n# Get the total values for percentage calculation\ntotal_demand_complete = uni_dem['!s_aus'].sum()  # You'll need to load uni_dem data\ntotal_capacity_complete = pbsa_cap['!cap'].sum()\n\n# Create the figure and axis\nfig, ax = plt.subplots(figsize=(12, 12))\n\n# Set up the bar positions\nx = np.arange(len(summary_df))\nwidth = 0.35\n\n# Calculate percentages\ndemand_percentages = (summary_df['total_demand_inside'] / total_demand_complete) * 100\ncapacity_percentages = (summary_df['total_capacity_inside'] / total_capacity_complete) * 100\n\n\ndemand_coeffs    = np.polyfit(x, demand_percentages, 1)\ncapacity_coeffs  = np.polyfit(x, capacity_percentages, 1)\n\n# Prepare a smooth x array for plotting the line\nx_smooth = np.linspace(-0.5, len(summary_df)-0.5, 200)\n\n# Evaluate the fitted lines\ndemand_trend    = np.polyval(demand_coeffs, x_smooth)\ncapacity_trend  = np.polyval(capacity_coeffs, x_smooth)\n\n# Plot the trend lines\nax.plot(x_smooth, demand_trend,   color='#F08080',   lw=1.5, linestyle='--', label='demand trend')\nax.plot(x_smooth, capacity_trend, color='#F49F7D', lw=1.5, linestyle='--', label='capacity trend')\n\n# Create bars\ndemand_bars = ax.bar(x - width/2, demand_percentages, width, label='total demand inside', \n                     color='#FAE1DD', alpha=1, linewidth=1)\ncapacity_bars = ax.bar(x + width/2, capacity_percentages, width, label='total capasity inside', \n                       color='#FFD7BA', alpha=1,  linewidth=1)\n\n\n\n# Prepare a smooth x array for plotting the line\nx_smooth = np.linspace(-0.5, len(summary_df)-0.5, 200)\n\n# Customize the plot\nax.set_ylim(0, 101)                # a bit of head‑room for the trend lines\nax.set_yticks(np.arange(0, 101, 10))   # 0,10,20,...,100\nax.set_xlabel('travel time')\nax.set_ylabel('percentage of total')\nax.set_title('Market Areas Demand-Capacity Coverage by Travel Time', fontsize=12, pad=8, fontweight='bold')\nax.set_xticks(x)\nax.set_xticklabels(summary_df['travel_time_min'])\nplt.legend(loc='best', frameon=False)\nax.grid(True, alpha=0.3, axis='y')\n\n# Add percentage labels on bars\ndef add_labels(bars, percentages):\n    for bar, percentage in zip(bars, percentages):\n        height = bar.get_height()\n        ax.text(bar.get_x() + bar.get_width()/2., height + 0.5,\n                f'{percentage:.0f}%', ha='center', va='bottom', fontsize=10)\n\nadd_labels(demand_bars, demand_percentages)\nadd_labels(capacity_bars, capacity_percentages)\n\nplt.tight_layout()\n\nsave_path = os.path.join(hf, \"Market Areas Demand-Capacity Coverage by Travel Time.png\")\nplt.savefig(save_path, dpi=300, bbox_inches=\"tight\")\n\nplt.show()\n\n\n\nFigure XX. Market Areas Demand-Capacity Coverage by Travel Time\n\nThe results of the travel time test demonstrate that increasing the time threshold for accessibility significantly affects the degree of coverage of university demand and the capacity of student housing included in market areas. However, the effect grows unevenly, and it is precisely this dynamic that allows us to determine the optimal travel time value.\n\nFirst, at thresholds of 10–25 minutes, there is a significant discrepancy between the share of demand covered and the share of capacity included. For example, at 25 minutes, the market already covers 96% of total demand, but only 59% of housing capacity. This imbalance indicates that with short isochrones, a significant portion of dormitories remain formally ‘outside the market,’ which leads to artificially inflated estimates of the deficit and local market pressure.\n\nSecondly, starting at 30 minutes, the volume of included capacity increases sharply, reaching 69%, and by 35 minutes, 80%, which reflects a significant improvement in the spatial correspondence between university demand and student accommodation capacity. At the same time, there is no further noticeable growth in demand coverage: even at 20 minutes, more than 94% of student demand is covered, and at 30–35 minutes, 97%. This means that an increase in travel time in this range mainly affects the housing supply rather than changing the demand pattern.\n\nThus, the 35-minute threshold represents an optimal compromise.\n\nMoreover, according to a study by Menz & Mandl (2024), students studying mostly in person spend 5 hours more per week on study-related activities compared to students studying mostly online. Thus, it can be concluded that full-time students spend an additional 5 hours per week commuting, which is equivalent to approximately 1 hour per day or 30 minutes each way.\n\n","type":"content","url":"/notebooks/central-place-analysis#travel-time-test","position":11},{"hierarchy":{"lvl1":"Market Areas Analysis"},"type":"lvl1","url":"/notebooks/central-place-analysis#market-areas-analysis","position":12},{"hierarchy":{"lvl1":"Market Areas Analysis"},"content":"\n\nSpatial economics and central place metrics were used to analyse market areas (Table XX).\n\nmarket_area[[\n    \"code\",\n    \"name\",\n    \"own\",\n    \"cluster\",\n    \"!cap_sum\",\n    \"!s_aus_sum\",\n    \"!s_de_sum\",\n    \"!s_all_sum\"\n]].round(1)\n\n#market_area.describe().round(1)\n\n\n\nTable XX. Market Areas\n\n","type":"content","url":"/notebooks/central-place-analysis#market-areas-analysis","position":13},{"hierarchy":{"lvl1":"Market Areas Analysis","lvl2":"Spatial Economics Metrics"},"type":"lvl2","url":"/notebooks/central-place-analysis#spatial-economics-metrics","position":14},{"hierarchy":{"lvl1":"Market Areas Analysis","lvl2":"Spatial Economics Metrics"},"content":"Spatial Economics indicators are important for further calculation of capacity–demand balance and central place metrics.\n\nCapacity–Demand RatioThis indicator reflects the ratio between the supply of student housing and university demand within each market area. It is calculated as the share of the total capacity of all student accommodation  in the market area relative to the total demand from international students (market_area[‘capacity_demand_ratio’] = !cap_sum / !s_aus_sum).\nHigh ratio values indicate areas with a relative oversupply, while low values indicate a shortage of housing relative to demand. This indicator helps to identify areas where the market is potentially balanced or, conversely, under the pressure.\n\nDemand–Capacity PressureThis indicator is the inverse ratio and is calculated as the share of total university demand relative to student housing capacity (market_area[‘demand_capacity_pressure’] = !s_aus_sum / !cap_sum). It is interpreted as the degree of market pressure: the higher the value, the greater the load on the available supply and the more acute the shortage.\n\nNumber of Student AccommodationsThis indicator determines how many student accommodation facilities are located within a specific market area (pbsa_counts = wb.groupby(‘iso_id’).size()).\n\nNumber of Higher Education UniversitiesThis indicator reflects how many higher education institutions fall within the boundaries of the market area (uni_counts = wb.groupby(“iso_id”).size()).\n\nMarket Area SizeThe area of each market area is calculated as the area of its geometry in square kilometres (market_area[‘area’] = market_area.geometry.area / 1e6).\n\nThe main result of the analysis of spatial economic metrics is the capacity–demand balance (Figure XX), which allows for a direct comparison of the aggregate demand of international students within each market area with the available supply of places in student accommodation.\n\nAs can be seen in the graph, in the vast majority of university market areas, university international demand significantly exceeds available student accommodation capacity. Almost all points are below the ideal equilibrium line (45°), indicating a structural supply shortage and systemic pressure on the student housing market. The size of the points reflects the degree of pressure on a particular university. The smallest pressure is on the market area formed by SRH Berlin University of Applied Sciences, where capacity exceeds demand. The greatest pressure is on the market area formed by the University of Business and Law, where demand exceeds capacity by 6.2 times.\n\ndemand_median = market_area['!s_aus_sum'].median()\ncapacity_median = market_area['!cap_sum'].median()\n\nmpl.rcParams['font.family'] = 'Helvetica'\n\n# Plot\nf, ax = plt.subplots(1, figsize=(12, 12))\nx_min, x_max = 0, 6000  # For capacity_demand_ratio.clip(0, 5)\ny_min, y_max = 0, 6000  \n\nax.scatter(market_area['!s_aus_sum'], market_area['!cap_sum'], color = market_area['color'], s=(market_area['demand_capacity_pressure'])*25, alpha=0.75)\n\nfor idx, row in market_area.iterrows():\n    offset = 10\n    ax.annotate(row['abr'], #abr\n        xy=(row['!s_aus_sum'], row['!cap_sum']),  # Original point position\n        xytext=(0, offset),  # Move text 5 points upward from the point\n        textcoords='offset points',  # Use offset coordinates for xytext\n        color='#999999', \n        fontsize=8, \n        alpha=1,\n        ha='center',    # Horizontal alignment: center\n        va='bottom' if idx % 2 == 0 else 'bottom'     # Vertical alignment: bottom of text above point\n    )\n\nax.axhline(capacity_median, color='#cccccc', linestyle='--', alpha=0.5)\nax.axvline(demand_median, color='#cccccc', linestyle='--', alpha=0.5)\nax.set_xlabel('university international demand (!s_aus_sum)')\nax.set_ylabel('student accommodation capasity (!cap_sum)')\nax.set_title('Market Areas Capacity Demand Balance', fontsize=12, pad=8, fontweight='bold')\nax.axline((0, 0), slope=1, color='#F4978E', linestyle='--', alpha=0.7, label='Perfect Balance')\nax.set_xlim(x_min, x_max)\nax.set_ylim(y_min, y_max)\nplt.grid(True, color='#cccccc', linestyle='--', alpha=0.3)\nplt.legend(loc='upper right', frameon=False)\n\nsave_path = os.path.join(hf, \"Market Areas Capacity Demand Balance.png\")\nplt.savefig(save_path, dpi=300, bbox_inches=\"tight\")\n\nplt.show()\n\n\n\nFigure XX. Market Areas Capacity Demand Balance\n\n","type":"content","url":"/notebooks/central-place-analysis#spatial-economics-metrics","position":15},{"hierarchy":{"lvl1":"Market Areas Analysis","lvl2":"Central Place Metrics"},"type":"lvl2","url":"/notebooks/central-place-analysis#central-place-metrics","position":16},{"hierarchy":{"lvl1":"Market Areas Analysis","lvl2":"Central Place Metrics"},"content":"CentralityThe first challenge was to find some way of measuring the centrality of an urban place (King, 1986). To calculate centrality Godlund (1956) used the following formula:C \\;=\\; \\sqrt{\\,(B)\\,(m) \\;-\\; (P)\\,(k)\\,}\n\nwhere:\n\nB — a count of the number of shops in the place\nm — a weighting factor that took into account the comparative average size of the shopsP — the population of the townk — was an index of the average accessibility to retail trade services enjoyed by any one inhabitant of the larger region in which the central place was located\n\nIn a study of the student housing market, centrality can be determined using a modified version of Godlund’s formula.C \\;=\\; \\sqrt{\\,(Csa +Cuni)\\,(m) \\;-\\; (D)\\,(Ci/Di)\\,}\n\nwhere:\n\nCsa +Cuni — a sum of the number of student accommodations and higher education  universities in the market aream — is a constant calculated during manual tests (m=50)D — the total international demandCi/Di — a capacity-demand ratio\n\nmarket_area[\"!s_aus_sum\"] = market_area[\"!s_aus_sum\"].round(3)\n\n\n\nm = 50\n\nmarket_area[\"centrality\"] = np.sqrt(((market_area[\"pbsa_count\"] + market_area[\"uni_count\"]) * m) - \n                                    (market_area[\"!s_aus_sum\"] * market_area[\"capacity_demand_ratio\"])).fillna(0.0).round(3)\n\nmarket_area[[\"fname\", \"pbsa_count\", \"uni_count\", \"capacity_demand_ratio\",\n           \"!s_aus_sum\", \"centrality\"]].head(15).sort_values(\"centrality\", ascending=False) \n\n\n\nTable XX. Centrality Central Place Metrics\n\nThe market areas formed by the Humboldt University of Berlin and the University of Applied Sciences for Technology and Economics Berlin have zero centrality, which can be explained by their spatial location in Treptow-Köpenick and Lichtenberg, respectively.\n\nService Range AdequacyIt is based on the key principle of central place theory: service range determines the size of the market territory necessary for the sustainable operation of the facility. As King (1986) notes, the higher the ‘service range’ of a product or service, the larger the area that must provide a sufficient flow of users, and the higher the probability that such a facility will be located in a larger urban centre. Service Range Adequacy allows us to assess how well each territory meets the expected level of service and contributes to the sustainable functioning of the student housing market. It is calculated as the relative share of demand attributable to each market area (market_area[“cntr_service_range_adequacy”] = market_area[“!s_aus_sum”] / total_demand_complete))\n\ntotal_demand_complete = uni_dem['!s_aus'].sum()\nmarket_area['cntr_service_range'] = (\n    market_area['!s_aus_sum'] / total_demand_complete).round(3)\n\nmarket_area[[\"fname\",\"!s_aus_sum\", \"centrality\", \"cntr_service_range\"]].head(15).sort_values(\"cntr_service_range\", ascending=False) \n\n\n\nTable XX. Service Range Adequacy Central Place Metrics\n\nHierarchy RankAccording to King’s approach, the hierarchy of urban places is defined not only by their size, but primarily by the number and order of the functions they perform (King, 1986, p. 22).\n\nFollowing this logic, the ranking of market areas in this study is based on their functional capacity, expressed through two key indicators: centrality and service range adequacy. These values are combined into a composite index (market_area[“cntr_hierarchy”] = ((market_area[“centrality”]/100) + (market_ara[“cntr_service_range”])).round(3)). The hierarchical ranking allows us to see not only the current configuration of supply and demand, but also the structural role of each market area in the urban system, identifying higher-order centres and lower-level areas.\n\nmarket_area['cntr_hierarchy'] = (\n    (market_area['centrality']/100) + (market_area['cntr_service_range'])).round(3)\n\nmarket_area['cntr_hierarchy_rank'] = pd.qcut(\n    market_area['cntr_hierarchy'],\n    q=5, labels=range(1, 6)   # 1‑5 classes\n)\n\nmarket_area[[\"fname\",\"!s_aus_sum\", \"centrality\", \"cntr_service_range\", \n             'cntr_hierarchy', 'cntr_hierarchy_rank']].head(15).sort_values(\"cntr_hierarchy\", ascending=False) \n\n\n\nTable XX. Hierarchy Rank Central Place Metrics\n\nMarket Areas Hierarchy Rank demonstrates the distribution of central places by hierarchical classes in accordance with Central Place Theory.\n\nHierarchy Rank - 5. Primary Central Places\n\nPrimary Central Places (Figure XX) are formed around the University of the Arts Berlin (UAB), the University of Europe for Applied Sciences (UEAS) and the School of Economics and Law (HWR_BA). Although according to King (1986), centrality is not determined by the physical size of the territory, these market areas have some of the largest areas, more than 90 km² each. This is because top-level zones must have a sufficiently wide coverage to serve a large number of functions and significant volumes of demand.\n\nGeographically, these market areas are located mainly in the districts of Mitte, Charlottenburg-Wilmersdorf and Friedrichshain-Kreuzberg, as well as partly in Tempelhof-Schöneberg, Steglitz-Zehlendorf and Neukölln, forming a distinct axis in a south-westerly direction. Together, they account for about 32% of total international student demand, which highlights their systemic role in the city’s university infrastructure.\n\nIt is worth noting that two of the three primary centres belong to the High–High cluster, meaning they are stable magnets for international students, around which areas of high demand and growing market pressure are forming. However, the greatest pressure is observed in the School of Economics and Law market zone, where demand exceeds available capacity by 6.2 times, making this zone the most vulnerable in the hierarchy of central locations. This imbalance highlights the critical shortage of infrastructure and the need to prioritise the expansion of the housing stock near this educational cluster.\n\nTogether, the primary central places form the core of Berlin’s student urbanisation, where key educational functions, large volumes of demand and the most significant infrastructure imbalances are concentrated. Their high hierarchical position confirms the central role of these areas in the urban structure, but at the same time demonstrates the vulnerability of the system: even higher-order centres face a significant housing shortage and growing market pressure.\n\nfig, axs  = plt.subplots(figsize=(12, 12))\n\npgr.plot(ax=axs, facecolor='none', edgecolor='#cccccc', linewidth=0.5, linestyle=\"--\")\nbz.plot(ax=axs, facecolor='none', edgecolor='#999999', linewidth=0.75)\nout.plot(ax=axs, facecolor='none', edgecolor='#666666', linewidth=1)\n\nmarket_area[market_area['cntr_hierarchy_rank'] == 5].plot(ax=axs,\n          column='cntr_hierarchy_rank',\n          cmap=cmap_pi,\n          alpha=0.55,\n          edgecolor='none',\n          linewidth=0.3,\n          legend=True,\n          legend_kwds={'frameon': False},\n          label = 'hierarchy rank', \n          vmin=0,\n          vmax=5)\n\nmarket_area[market_area['cntr_hierarchy_rank'] == 5].plot(\n    ax=axs,\n    edgecolor='white',  # variable for colormap\n    facecolor=\"none\",        # transparent polygons  # edge colors from your column\n    linewidth=0.3,\n    alpha=1\n)\n\ncentral_places.plot(ax=axs,\n           color='#76A79D', \n           markersize=20,\n           #markersize= 10,\n           alpha=0.75,\n           edgecolor='white',\n           linewidth=1)\nfor _, row in central_places.iterrows():\n    offset = 3  # vertical offset in points\n    axs.annotate(\n        row['abr'],                           # abbreviation\n        xy=(row.geometry.x, row.geometry.y),  # coords from the Point\n        xytext=(0, offset),                   # lift the text a bit\n        textcoords='offset points',\n        color='#1b4332',\n        fontsize=8,\n        ha='center',\n        va='bottom',\n        alpha=1,\n        zorder=6,\n        path_effects=[\n            path_effects.Stroke(linewidth=2, foreground='white'),\n            path_effects.Normal()\n        ]\n    )\n\naxs.set_title('Hierarchy Rank - 5. Primary Central Places', fontsize=16, fontweight='bold')\naxs.set_axis_off()\nplt.tight_layout()\n\nsave_path = os.path.join(hf, \"Hierarchy Rank - 5. Primary Central Places.png\")\nplt.savefig(save_path, dpi=300, bbox_inches=\"tight\")\n\nplt.show()\n\n\n\nFigure XX. Primary Central Places\n\nmarket_area[market_area['cntr_hierarchy_rank'] == 5][[\"fname\",\"!s_aus_sum\", \"centrality\", \"cntr_service_range\", 'cntr_hierarchy', 'cntr_hierarchy_rank']].head(15).sort_values(\"cntr_hierarchy\", ascending=False) \n\n\n\nTable XX. Primary Central Places\n\nHierarchy Rank - 4. Secondary Central Places\n\nSecondary Central Places Centres (Figure XX) are formed by Humboldt University of (HU), International University of Applied Sciences (BIU) and Charité University Hospital (CU). These market areas are secondary central places, i.e., high-order centres that have significant functional saturation but are lower than primary centres in terms of scale of attraction and infrastructure concentration.\n\nGeographically, secondary central places are located east of primary central places, covering parts of the Lichtenberg and Pankow districts and forming a distinct west-east axis in the spatial structure of the student housing market. This configuration reflects the expansion of the city’s education system in an easterly direction, which is historically less saturated with higher education institutions. Together, these areas account for about 20% of the total demand from international students, confirming their significant but not dominant role in the urban hierarchy.\n\nThe average demand–capacity pressure value of 2.1 confirms that demand exceeds current supply by more than double. This creates moderate but stable market pressure, indicating the need for strategic expansion of student infrastructure and further development of public-private initiatives in the field of student accommodation.\n\nThus, secondary central places function as sub-regional centres in the urban hierarchy, playing a key role in rebalancing demand, ensuring access to higher education and shaping future growth trends in Berlin’s student housing market.\n\nfig, axs  = plt.subplots(figsize=(12, 12))\n\npgr.plot(ax=axs, facecolor='none', edgecolor='#cccccc', linewidth=0.5, linestyle=\"--\")\nbz.plot(ax=axs, facecolor='none', edgecolor='#999999', linewidth=0.75)\nout.plot(ax=axs, facecolor='none', edgecolor='#666666', linewidth=1)\n\nmarket_area[market_area['cntr_hierarchy_rank'] == 4].plot(ax=axs,\n          column='cntr_hierarchy_rank',\n          cmap=cmap_pi,\n          alpha=0.55,\n          edgecolor='none',\n          linewidth=0.3,\n          legend=True,\n          legend_kwds={'frameon': False},\n          label = 'hierarchy rank', \n          vmin=0,\n          vmax=5)\n\nmarket_area[market_area['cntr_hierarchy_rank'] == 4].plot(\n    ax=axs,\n    edgecolor='white',  # variable for colormap\n    facecolor=\"none\",        # transparent polygons  # edge colors from your column\n    linewidth=0.3,\n    alpha=1\n)\n\ncentral_places.plot(ax=axs,\n           color='#76A79D', \n           markersize=20,\n           #markersize= 10,\n           alpha=0.75,\n           edgecolor='white',\n           linewidth=1)\nfor _, row in central_places.iterrows():\n    offset = 3  # vertical offset in points\n    axs.annotate(\n        row['abr'],                           # abbreviation\n        xy=(row.geometry.x, row.geometry.y),  # coords from the Point\n        xytext=(0, offset),                   # lift the text a bit\n        textcoords='offset points',\n        color='#1b4332',\n        fontsize=8,\n        ha='center',\n        va='bottom',\n        alpha=1,\n        zorder=6,\n        path_effects=[\n            path_effects.Stroke(linewidth=2, foreground='white'),\n            path_effects.Normal()\n        ]\n    )\n\naxs.set_title('Hierarchy Rank - 4. Secondary Central Places', fontsize=16, fontweight='bold')\naxs.set_axis_off()\nplt.tight_layout()\n\nsave_path = os.path.join(hf, \"Hierarchy Rank - 4. Secondary Central Places.png\")\nplt.savefig(save_path, dpi=300, bbox_inches=\"tight\")\n\nplt.show()\n\n\n\nFigure XX. Secondary Central Places\n\nmarket_area[market_area['cntr_hierarchy_rank'] == 4][[\"fname\",\"!s_aus_sum\", \"centrality\", \"cntr_service_range\", 'cntr_hierarchy', 'cntr_hierarchy_rank']].head(15).sort_values(\"cntr_hierarchy\", ascending=False) \n\n\n\nTable XX. Secondary Central Places\n\nHierarchy Rank - 3. Tertiary Central Places\n\nTertiary Central Places (Figure XX) are formed around the Technical University of Berlin (TUB), Free University (FU) and Berlin School of Technology (BTS). These universities represent significant but less dominant centres of demand, located on the periphery of the primary and secondary central places.\n\nGeographically, tertiary central places occupy areas to the north and south of secondary central places, covering a significant part of Steglitz-Zehlendorf and Reinickendorf. In this way, they support the established south-western educational axis extending from the primary central places and, at the same time, form a new north-south axis in the spatial structure of the student housing market. This configuration reflects the complex multipolar organisation of demand characteristic of a large polycentric city.\n\nTogether, these market areas account for about 17% of total international student demand, making them significant but not dominant elements in the structure of central places.\n\nIt is noteworthy that all three universities forming tertiary central places belong to the Low–High (LH) cluster and are public. This combination indicates the high educational potential of these areas and their ability to be included in existing clusters, but at the same time demonstrates the lack of full strategic integration into established centres of student urbanisation.\n\nThe average demand–capacity pressure value is 2.8, which is higher than that of secondary central places. This indicates that demand is almost three times higher than the available supply. Consequently, tertiary central places are critically important areas of hidden deficit, where a growing gap is forming between the educational potential of universities and the lack of adequate housing infrastructure.\n\nfig, axs  = plt.subplots(figsize=(12, 12))\n\npgr.plot(ax=axs, facecolor='none', edgecolor='#cccccc', linewidth=0.5, linestyle=\"--\")\nbz.plot(ax=axs, facecolor='none', edgecolor='#999999', linewidth=0.75)\nout.plot(ax=axs, facecolor='none', edgecolor='#666666', linewidth=1)\n\nmarket_area[market_area['cntr_hierarchy_rank'] == 3].plot(ax=axs,\n          column='cntr_hierarchy_rank',\n          cmap=cmap_pi,\n          alpha=0.55,\n          edgecolor='none',\n          linewidth=0.3,\n          legend=True,\n          legend_kwds={'frameon': False},\n          label = 'hierarchy rank', \n          vmin=0,\n          vmax=5)\n\nmarket_area[market_area['cntr_hierarchy_rank'] == 3].plot(\n    ax=axs,\n    edgecolor='white',  # variable for colormap\n    facecolor=\"none\",        # transparent polygons  # edge colors from your column\n    linewidth=0.3,\n    alpha=1\n)\n\ncentral_places.plot(ax=axs,\n           color='#76A79D', \n           markersize=20,\n           #markersize= 10,\n           alpha=0.75,\n           edgecolor='white',\n           linewidth=1)\nfor _, row in central_places.iterrows():\n    offset = 3  # vertical offset in points\n    axs.annotate(\n        row['abr'],                           # abbreviation\n        xy=(row.geometry.x, row.geometry.y),  # coords from the Point\n        xytext=(0, offset),                   # lift the text a bit\n        textcoords='offset points',\n        color='#1b4332',\n        fontsize=8,\n        ha='center',\n        va='bottom',\n        alpha=1,\n        zorder=6,\n        path_effects=[\n            path_effects.Stroke(linewidth=2, foreground='white'),\n            path_effects.Normal()\n        ]\n    )\n\naxs.set_title('Hierarchy Rank - 3. Tertiary Central Places', fontsize=16, fontweight='bold')\naxs.set_axis_off()\nplt.tight_layout()\n\nsave_path = os.path.join(hf, \"Hierarchy Rank - 3. Tertiary Central Places.png\")\nplt.savefig(save_path, dpi=300, bbox_inches=\"tight\")\n\nplt.show()\n\n\n\nFigure XX. Tertiary Central Places\n\nmarket_area[market_area['cntr_hierarchy_rank'] == 3][[\"fname\",\"!s_aus_sum\", \"centrality\", \"cntr_service_range\", 'cntr_hierarchy', 'cntr_hierarchy_rank']].head(15).sort_values(\"cntr_hierarchy\", ascending=False) \n\n\n\nTable XX. Tertiary Central Places\n\nHierarchy Rank - 2. Local Central Places\n\nLocal Central Places (Figure XX) are formed around SRH Berlin University of Applied Sciences (SRHU), Charité University Hospital (CU) and ESCP Business School Berlin (ESCP). These universities act as local centres, primarily serving the surrounding areas and acting as a link between larger secondary and tertiary central places.\n\nGeographically, these market areas are mainly located in the districts of Friedrichshain-Kreuzberg and Neukölln, as well as partly in Mitte, Charlottenburg-Wilmersdorf, Tempelhof-Schöneberg, Treptow-Köpenick and Lichtenberg. Spatially, they occupy positions south of secondary central places and simultaneously support two key axes of the urban structure: the west-east axis formed by secondary central places and the north-south axis formed by tertiary central places. In this way, local central places reinforce the polycentric organisation of the student housing market, ensuring connectivity between areas of different hierarchical levels and serving 11% of student demand.\n\nWhat is particularly interesting is that the three universities that form this hierarchical level belong to different types of spatial clusters: ESCP Business School Berlin is characterised by a High-High (HH) pattern, Charité University Hospital by a High-Low (HL) pattern, and SRH Berlin University of Applied Sciences by a Low-High (LH) pattern. This highlights the heterogeneity of these areas and their varying degrees of integration into existing educational clusters.\n\nThe intensity of market pressure within local central places also varies. Market areas formed by private universities ESCP and SRHU show relatively moderate indicators: 2.7 and 0.7, respectively. At the same time, the area formed by the state-owned Charité University Hospital experiences a pronounced imbalance between supply and demand: demand exceeds available capacity by five times. This indicates a structural shortage of student housing in one of the city’s most important medical and scientific centres.\n\nThus, local central places reflect an important intermediate level of the city’s educational and housing structure. They combine areas with stable patterns of demand and supply, adjacent to local shortages, and form a significant component of Berlin’s polycentric student space.\n\nfig, axs  = plt.subplots(figsize=(12, 12))\n\npgr.plot(ax=axs, facecolor='none', edgecolor='#cccccc', linewidth=0.5, linestyle=\"--\")\nbz.plot(ax=axs, facecolor='none', edgecolor='#999999', linewidth=0.75)\nout.plot(ax=axs, facecolor='none', edgecolor='#666666', linewidth=1)\n\nmarket_area[market_area['cntr_hierarchy_rank'] == 2].plot(ax=axs,\n          column='cntr_hierarchy_rank',\n          cmap=cmap_pi,\n          alpha=0.55,\n          edgecolor='none',\n          linewidth=0.3,\n          legend=True,\n          legend_kwds={'frameon': False},\n          label = 'hierarchy rank', \n          vmin=0,\n          vmax=5)\n\nmarket_area[market_area['cntr_hierarchy_rank'] == 2].plot(\n    ax=axs,\n    edgecolor='white',  # variable for colormap\n    facecolor=\"none\",        # transparent polygons  # edge colors from your column\n    linewidth=0.3,\n    alpha=1\n)\n\ncentral_places.plot(ax=axs,\n           color='#76A79D', \n           markersize=20,\n           #markersize= 10,\n           alpha=0.75,\n           edgecolor='white',\n           linewidth=1)\nfor _, row in central_places.iterrows():\n    offset = 3  # vertical offset in points\n    axs.annotate(\n        row['abr'],                           # abbreviation\n        xy=(row.geometry.x, row.geometry.y),  # coords from the Point\n        xytext=(0, offset),                   # lift the text a bit\n        textcoords='offset points',\n        color='#1b4332',\n        fontsize=8,\n        ha='center',\n        va='bottom',\n        alpha=1,\n        zorder=6,\n        path_effects=[\n            path_effects.Stroke(linewidth=2, foreground='white'),\n            path_effects.Normal()\n        ]\n    )\n\naxs.set_title('Hierarchy Rank - 2. Local Central Places', fontsize=16, fontweight='bold')\naxs.set_axis_off()\nplt.tight_layout()\n\nsave_path = os.path.join(hf, \"Hierarchy Rank - 2. Local Central Places.png\")\nplt.savefig(save_path, dpi=300, bbox_inches=\"tight\")\n\nplt.show()\n\n\n\nFigure XX. Local Central Places\n\nmarket_area[market_area['cntr_hierarchy_rank'] == 3][[\"fname\",\"!s_aus_sum\", \"centrality\", \"cntr_service_range\", 'cntr_hierarchy', 'cntr_hierarchy_rank']].head(15).sort_values(\"cntr_hierarchy\", ascending=False) \n\n\n\nTable XX. Local Central Places\n\nHierarchy Rank - 1. Basic Service Areas\n\nBasic Service Areas (Figure XX) are formed around the German International University Berlin (GIU), University of Applied Sciences for Technology, Economics Berlin (HTW) and Humboldt University of Berlin (HU). These universities are basic service centres whose role in the structure of central locations is primarily to provide fundamental educational functions and support peripheral parts of the urban system.\n\nGeographically, these market areas are located mainly in the districts of Reinickendorf, Treptow-Köpenick and Lichtenberg. They are situated to the south-east and north-west of the secondary central places. This location emphasises their functional role as areas serving peripheral or poorly integrated parts of the city’s educational space, acting as ‘edge’ centres in Berlin’s polycentric structure.\n\nCollectively, Basic Service Areas account for about 19% of international student demand — more than  tertiary central places. This indicates that even the most basic centres in the hierarchy play a significant role in the distribution of student mobility and the formation of market pressure, serving significant shares of both educational and housing demand in the periphery.\n\nIt is worth noting that two of the three universities forming this hierarchical level belong to the Low–High (LH) cluster, demonstrating low supply with higher regional demand. The third university is private and belongs to the High–Low (HL) cluster, reflecting the opposite dynamic: a high value at the facility level in an environment with relatively low values. This distribution of clusters shows that the basic market areas are characterised by strong heterogeneity in demand and supply, as well as varying levels of integration into existing educational clusters.\n\nfig, axs  = plt.subplots(figsize=(12, 12))\n\npgr.plot(ax=axs, facecolor='none', edgecolor='#cccccc', linewidth=0.5, linestyle=\"--\")\nbz.plot(ax=axs, facecolor='none', edgecolor='#999999', linewidth=0.75)\nout.plot(ax=axs, facecolor='none', edgecolor='#666666', linewidth=1)\n\nmarket_area[market_area['cntr_hierarchy_rank'] == 1].plot(ax=axs,\n          column='cntr_hierarchy_rank',\n          cmap=cmap_pi,\n          alpha=0.55,\n          edgecolor='none',\n          linewidth=0.3,\n          legend=True,\n          legend_kwds={'frameon': False},\n          label = 'hierarchy rank', \n          vmin=0,\n          vmax=5)\n\nmarket_area[market_area['cntr_hierarchy_rank'] == 1].plot(\n    ax=axs,\n    edgecolor='white',  # variable for colormap\n    facecolor=\"none\",        # transparent polygons  # edge colors from your column\n    linewidth=0.3,\n    alpha=1\n)\n\ncentral_places.plot(ax=axs,\n           color='#76A79D', \n           markersize=20,\n           #markersize= 10,\n           alpha=0.75,\n           edgecolor='white',\n           linewidth=1)\nfor _, row in central_places.iterrows():\n    offset = 3  # vertical offset in points\n    axs.annotate(\n        row['abr'],                           # abbreviation\n        xy=(row.geometry.x, row.geometry.y),  # coords from the Point\n        xytext=(0, offset),                   # lift the text a bit\n        textcoords='offset points',\n        color='#1b4332',\n        fontsize=8,\n        ha='center',\n        va='bottom',\n        alpha=1,\n        zorder=6,\n        path_effects=[\n            path_effects.Stroke(linewidth=2, foreground='white'),\n            path_effects.Normal()\n        ]\n    )\n\naxs.set_title('Hierarchy Rank - 1. Basic Service Areas', fontsize=16, fontweight='bold')\naxs.set_axis_off()\nplt.tight_layout()\n\nsave_path = os.path.join(hf, \"Hierarchy Rank - 1. Basic Service Areas.png\")\nplt.savefig(save_path, dpi=300, bbox_inches=\"tight\")\n\nplt.show()\n\n\n\nFigure XX. Basic Service Areas\n\nmarket_area[market_area['cntr_hierarchy_rank'] == 3][[\"fname\",\"!s_aus_sum\", \"centrality\", \"cntr_service_range\", 'cntr_hierarchy', 'cntr_hierarchy_rank']].head(15).sort_values(\"cntr_hierarchy\", ascending=False) \n\n\n\nTable XX. Basic Service Areas\n\nThe constructed hierarchy of market areas revealed a pronounced polycentricity of the city’s educational space: central locations at the highest levels concentrate the greatest student demand and form the main clusters of attraction, while lower-level zones perform supporting functions. At the same time, demand significantly exceeds supply at all levels.\n\nThus, the analysis shows that the student housing crisis in Berlin has a clearly defined spatial structure. The uneven distribution of both universities and accommodation infrastructure exacerbates market pressure, creating persistent areas of overload and local shortages, which require further strategic intervention and planning.\n\nmarket_area.to_crs(epsg=25833)\n\nef = r\"../outputs/3.2_central_place_analysis/market_area_central_place_analysis.gpkg\"\nmarket_area.to_file(ef, driver=\"GPKG\")\n\n","type":"content","url":"/notebooks/central-place-analysis#central-place-metrics","position":17},{"hierarchy":{"lvl1":"3.3 Market Pressure Analysis"},"type":"lvl1","url":"/notebooks/market-pressure-analysis","position":0},{"hierarchy":{"lvl1":"3.3 Market Pressure Analysis"},"content":"import warnings\n\nwarnings.filterwarnings(\"ignore\")\n\nimport os\nhf = r'../outputs/3.3_market_pressure_analysis/'\nos.makedirs(hf, exist_ok=True)\n\n\n\n","type":"content","url":"/notebooks/market-pressure-analysis","position":1},{"hierarchy":{"lvl1":"3.3 Market Pressure Analysis"},"type":"lvl1","url":"/notebooks/market-pressure-analysis#id-3-3-market-pressure-analysis","position":2},{"hierarchy":{"lvl1":"3.3 Market Pressure Analysis"},"content":"\n\nIn the chapter Central Place Analysis, spatial economics metrics were calculated, including demand–capacity pressure for each market area. The task of the chapter Market Pressure Analysis is to move from numerical characteristics to spatial ones and to calculate the local pressure on the student housing market and particular student accommodations.\n\n","type":"content","url":"/notebooks/market-pressure-analysis#id-3-3-market-pressure-analysis","position":3},{"hierarchy":{"lvl1":"3.3 Market Pressure Analysis","lvl2":"Set Up"},"type":"lvl2","url":"/notebooks/market-pressure-analysis#set-up","position":4},{"hierarchy":{"lvl1":"3.3 Market Pressure Analysis","lvl2":"Set Up"},"content":"\n\nImport Libraries\n\nimport numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport geopandas as gpd\nfrom matplotlib.colors import LinearSegmentedColormap\nimport seaborn as sns\nimport matplotlib.patheffects as path_effects\nfrom matplotlib.colors import ListedColormap\nfrom shapely.ops import unary_union\nimport rasterio\nfrom rasterio import features\nfrom affine import Affine\nfrom scipy.ndimage import gaussian_filter\n\n\n\nColors\n\ncolor_palettes = {\n    \"Mint\": [\"#EAF4E8\", \"#C8E0D4\", \"#A9CCC1\", \"#8FB9AE\", \"#76A79D\", \"#5F968E\", \"#498581\"], \n    \"Pi\": [\"#F8EDEB\", \"#FAE1DD\", \"#FCD5CE\", \"#FEC5BB\", \"#F8AD9D\", \"#F4978E\", \"#F08080\"],\n    \"Or\": [\"#FFE5D9\", \"#FFD7BA\", \"#FEC89A\", \"#FFB78F\", \"#F49F7D\", \"#F28B6D\"], \n    \"MintPi\": [\"#76A79D\", \"#8FB9AE\", \"#A9CCC1\", \"#C8E0D4\", \"#FBF0EA\", \"#FCD5CE\", \"#FEC5BB\", \"#F8AD9D\", \"#F4978E\"],\n    \"MintOr\": [\"#76A79D\", \"#8FB9AE\", \"#A9CCC1\", \"#C8E0D4\", \"#FBF0EA\", \"#FFD7BA\", \"#FEC89A\", \"#FFB78F\", \"#F28B6D\"],\n    \"GrSc\":  [\"#434343\", \"#666666\", \"#999999\", \"#b7b7b7\", \"#cccccc\", \"#d9d9d9\", \"#efefef\", \"#f3f3f3\", \"#ffffff\"]\n}\n\ncmap_mint = LinearSegmentedColormap.from_list(\"Mint\", color_palettes[\"Mint\"])\ncmap_pi = LinearSegmentedColormap.from_list(\"Pi\", color_palettes[\"Pi\"])\ncmap_or = LinearSegmentedColormap.from_list(\"Or\", color_palettes[\"Or\"])\ncmap_mintpi = LinearSegmentedColormap.from_list(\"MintPi\", color_palettes[\"MintPi\"])\ncmap_mintor = LinearSegmentedColormap.from_list(\"MintOr\", color_palettes[\"MintOr\"])\ncmap_grsc = LinearSegmentedColormap.from_list(\"GrSc\", color_palettes[\"GrSc\"])\n\n\n\nFont\n\nplt.rcParams[\"font.family\"] = \"Helvetica\"\n\n\n\nBerlin Spatial Boundaries\n\npf = r\"../inputs/3.3_market_pressure_analysis/lor_pgr.gpkg\"\npgr = gpd.read_file(pf)\npgr.replace({'-': np.nan, 0: np.nan, '': np.nan}, inplace=True)\n\nbf = r\"../inputs/3.3_market_pressure_analysis/adm_bz.gpkg\"\nbz = gpd.read_file(bf)\nbz.replace({'-': np.nan, 0: np.nan, '': np.nan}, inplace=True)\n\nof = r\"../inputs/3.3_market_pressure_analysis/adm_out.gpkg\"\nout = gpd.read_file(of)\nout.replace({'-': np.nan, 0: np.nan, '': np.nan}, inplace=True)\n\n\n\nData Import\n\nff = r\"../inputs/3.3_market_pressure_analysis/market_area_central_place_analysis.gpkg\"\nmarket_area = gpd.read_file(ff)\n\ncf = r\"../inputs/3.3_market_pressure_analysis/central_places.gpkg\"\ncentral_places = gpd.read_file(cf)\n\npf = r\"../inputs/3.3_market_pressure_analysis/pbsa_capacity_analysis.gpkg\"\npbsa_cap = gpd.read_file(pf)\n\n\n\n","type":"content","url":"/notebooks/market-pressure-analysis#set-up","position":5},{"hierarchy":{"lvl1":"Overlap Problem"},"type":"lvl1","url":"/notebooks/market-pressure-analysis#overlap-problem","position":6},{"hierarchy":{"lvl1":"Overlap Problem"},"content":"Whereas in the original Central Place, theory market areas do not overlap, in order to analyse the aggregate market pressure on the student housing market, it is necessary to move from the overlapping market areas obtained as a result of the Central Place Analysis (Figure XX) to a more accurate local structure that reflects the aggregate pressure on a particular part of the city.\n\nmarket_area['demand_capacity_pressure_rank'] = pd.qcut(\n    market_area['demand_capacity_pressure'],\n    q=5, labels=range(1, 6)   # 1‑5 classes\n)\n\n\n\ncmap_mint_mini = ListedColormap(cmap_mint(np.linspace(0.15, 1, 256)))\n\nfig, ax = plt.subplots(figsize=(12, 12))\n\npgr.plot(ax=ax, facecolor='none', edgecolor='#cccccc', linewidth=0.5, linestyle=\"--\")\nbz.plot(ax=ax, facecolor='none', edgecolor='#999999', linewidth=0.75)\nout.plot(ax=ax, facecolor='none', edgecolor='#666666', linewidth=1.25)\n\nvmin=0\nvmax=5\n\nmarket_area.plot(\n    ax=ax,\n    column='demand_capacity_pressure_rank',\n    cmap=cmap_mint,\n    edgecolor='none',\n    linewidth=0.3,\n    alpha=0.55,\n    legend=True,\n    legend_kwds={'frameon': False}, \n    label = 'demand capacity pressure rank', \n    vmax = vmax)  # Matching Previous plott\n\nplt.tight_layout()\n\n# sm = plt.cm.ScalarMappable(cmap=cmap_mint_mini, norm=plt.Normalize(vmin, vmax))\n# cbar = fig.colorbar(sm, ax=ax, shrink=0.6)\n# cbar.set_label(\"demand capacity pressure\")\n# cbar.set_ticks(range(vmin, 6))\n# cbar.outline.set_visible(False)\n\nmarket_area.plot(\n    ax=ax,\n    edgecolor='white',  # variable for colormap\n    facecolor=\"none\",        # transparent polygons  # edge colors from your column\n    linewidth=0.3,\n    alpha=1\n)\nplt.tight_layout()\n\ncentral_places.plot(ax=ax,\n           color='#434343',\n           markersize= 10,\n           alpha=0.75,\n           edgecolor='white',\n           linewidth=1)\nplt.tight_layout()\nfor idx, row in central_places.iterrows():\n    offset = 3  # vertical offset in points\n    ax.annotate(\n        row['abr'],  # abbreviation\n        xy=(row.geometry.x, row.geometry.y),  # position of the point\n        xytext=(0, offset),  # move text upward\n        textcoords='offset points',\n        color='#1b4332',     # dark mint / forest green for good contrast\n        fontsize=8,\n        ha='center',\n        va='bottom',\n        alpha=1,\n        zorder=6,\n        path_effects=[\n            path_effects.Stroke(linewidth=2, foreground='white'),\n            path_effects.Normal()\n        ]\n    )\n\nax.set_title('Market Areas Demand Capacity Pressure', fontsize=16, weight='bold')\nax.set_axis_off()\n\nsave_path = os.path.join(hf, \"Market_Areas_Demand_Capacity_Pressure.png\")\nplt.savefig(save_path, dpi=300, bbox_inches=\"tight\")\n\nplt.show()\n\n\n\nFigure XX. Market Areas Demand Capacity Pressure Rank\n\nMarket Areas Demand Capacity Pressure Rank (Figure XX) illustrates that each university forms its own accessibility zone, and these zones naturally overlap. On the one hand, this overlap reflects the real competition for student flows for the same housing stock. On the other hand, it creates analytical complexity: some territories are part of several market areas at the same time, which complicates the interpretation of local pressure.\n\nThis is partly due to the fact that, initially, isochrones were calculated using multipolygons, which form complex geometries and consist of several polygon parts. These fragments overlap with each other and with the polygons of other universities.\n\nAccording to the results of spatial analysis, individual market areas of overlap and are part of at least five different market areas, while particularly central areas, such as parts of the Mitte district, are part of 14 market areas simultaneously. In order to simplify such a dense network of intersecting zones of influence, it is necessary to eliminate overlaps.\n\nmarket_area['er_overlap'] = 0\n\n# Calculate overlaps\nfor i, current_poly in market_area.iterrows():\n    overlap_count = 0\n    for j, other_poly in market_area.iterrows():\n        if i != j:  # Don't compare with itself\n            if current_poly.geometry.intersects(other_poly.geometry):\n                overlap_count += 1\n    market_area.at[i, 'er_overlap'] = overlap_count\n\nprint(f\"Overlap Counts Range for Market Areas: {market_area['er_overlap'].min()} to {market_area['er_overlap'].max()}\")\n\nff = r'../outputs/3.3_market_pressure_analysis/market_areas_not_explode_overlap.gpkg'\nmarket_area.to_file(ff, driver=\"GPKG\")\n\n\n\nOne way to simplify geometry is to divide complex multipolygon geometry into simple polygons market_area.explode(ignore_index=True). In this case, polygons intersect between 0 and 51 times.\n\nmarket_area_exp = market_area.explode(ignore_index=True)\n\nmarket_area_exp['er_overlap'] = 0\n\nfor i, current_poly in market_area_exp.iterrows():\n    overlap_count = 0\n    for j, other_poly in market_area_exp.iterrows():\n        if i != j:  \n            if current_poly.geometry.intersects(other_poly.geometry):\n                overlap_count += 1\n    market_area_exp.at[i, 'er_overlap'] = overlap_count\n\nprint(f\"Overlap Counts Range for Exploded Market Areas: {market_area_exp['er_overlap'].min()} to {market_area_exp['er_overlap'].max()}\")\n\n\n\nThis means that in order to switch to simple geometry, it will be necessary to apply the division 51 more times. Such a task is not only difficult in terms of computing power, but will also result in the resulting non-intersecting polygons being extremely small.\n\n","type":"content","url":"/notebooks/market-pressure-analysis#overlap-problem","position":7},{"hierarchy":{"lvl1":"Rasterisation"},"type":"lvl1","url":"/notebooks/market-pressure-analysis#rasterisation","position":8},{"hierarchy":{"lvl1":"Rasterisation"},"content":"Another way to eliminate the problem of multiple market area overlaps is to switch from vector geometry to raster representation, i.e., to a regular grid of fixed size. Rasterisation allows complex, overlapping polygons to be replaced with a set of uniform pixel cells. Unlike a vector model, where a single territory can belong to several market areas at once, a raster grid forces a unique spatial correspondence: one cell equals one pressure value.\n\nThe use of a regular 25-meter grid provides a sufficient level of spatial detail to identify micro-zones of local congestion, especially in areas where the density of universities and student accommodation is highest.\n\nvalue_col = \"demand_capacity_pressure\"\n\n# Define raster resolution (in meters)\nresolution = 25 \n\n# Bounding box\nminx, miny, maxx, maxy = market_area.total_bounds\n\n# Create transform (affine)\ntransform = Affine.translation(minx, maxy) * Affine.scale(resolution, -resolution)\n\n# Calculate raster shape\nwidth = int((maxx - minx) / resolution)\nheight = int((maxy - miny) / resolution)\n\n\n\nraster = np.zeros((height, width), dtype=np.float32)\n\n# For each polygon, add pressure values\nfor _, row in market_area.iterrows():\n    shapes = [(row.geometry, row[value_col])]\n    layer = features.rasterize(\n        shapes=shapes,\n        out_shape=(height, width),\n        transform=transform,\n        fill=0,\n        all_touched=True,\n        dtype=np.float32\n    )\n    raster += layer\n\n\n\n","type":"content","url":"/notebooks/market-pressure-analysis#rasterisation","position":9},{"hierarchy":{"lvl1":"Demand Capacity Pressure"},"type":"lvl1","url":"/notebooks/market-pressure-analysis#demand-capacity-pressure","position":10},{"hierarchy":{"lvl1":"Demand Capacity Pressure"},"content":"\n\nThus, rasterisation can be used to assess Market Areas Local Demand Capacity Pressure (Figure XX).\n\nThe Local Demand–Capacity Pressure (Figure XX) shows the spatial distribution of the total market pressure arising from the overlap of the catchment areas of all universities. Unlike capacity–demand pressure, which is calculated at the level of individual market areas, this visualisation shows the ‘accumulated’ pressure, reflecting the cumulative effect of student competition for housing resources at each point in the urban area.\n\nThe most intense pressure zones are marked in saturated red shades and are concentrated in the central part of the city — primarily in the districts of Mitte, Charlottenburg-Wilmersdorf, and Friedrichshain-Kreuzberg. This core coincides with the spatial location of the largest educational clusters: the University of the Arts Berlin (UAB), University of Europe for Applied Sciences (UEAS), Berlin International University (BIU), Berlin School of Technology (BTS), and School of Economics and Law (HWR_BA). The catchment areas of these universities overlap most densely, which greatly increases the pressure on the limited housing stock in the central districts. It is here that local pressure reaches its maximum values — over 30, which indicates extremely high competition among international students for available places.\n\nAs move away from the central core, the intensity of the pressure gradually decreases, transitioning into moderate greenish hues. However, the decrease is asymmetrical: in the south-west (Steglitz-Zehlendorf), south-east (Treptow-Köpenick), and partly in the north-east (Pankow), there are still local areas of increased local pressure caused by the influence of the large universities FU, HU, and HTW. At the same time, the districts of Reinickendorf, Spandau, and Marzahn-Hellersdorf show the lowest local pressure values, indicating weak involvement in competition for housing stock and relatively low attractiveness for students.\n\nThus, the local demand–capacity pressure map clearly shows that market tension in the student housing market in Berlin is concentrated and polycentric, reaching its peak in the central ‘education corridor’ and gradually weakening towards the periphery.\n\nImportantly, this visualisation emphasises that the pressure is not generated by individual market areas, but by the overlap of multiple accessibility zones, which explains why it is the concentration of university functions — and not just the local shortage of student accommodation — that is the key driver of market pressure in the central areas of the city.\n\nfig, ax = plt.subplots(figsize=(12, 12))\nextent = (minx, maxx, miny, maxy)\n\ncmap_mintpi_mini = ListedColormap(cmap_mintpi(np.linspace(0.15, 1, 256)))\n\n\n# Replace pgr, bz, out with your base layers if needed\npgr.plot(ax=ax, facecolor='none', edgecolor='#cccccc', linewidth=0.5, linestyle=\"--\")\nbz.plot(ax=ax, facecolor='none', edgecolor='#999999', linewidth=0.75)\nout.plot(ax=ax, facecolor='none', edgecolor='#666666', linewidth=1.25)\n\n\n#-----------------------------1-------------------------------------\n\ncentral_places.plot(ax=ax,\n           color='#434343',\n           markersize= 10,\n           alpha=0.85,\n           edgecolor=None,\n           linewidth=1)\nplt.tight_layout()\nfor idx, row in central_places.iterrows():\n    offset = 3  # vertical offset in points\n    ax.annotate(\n        row['abr'],  # abbreviation\n        xy=(row.geometry.x, row.geometry.y),  # position of the point\n        xytext=(0, offset),  # move text upward\n        textcoords='offset points',\n        color='#1b4332',     # dark mint / forest green for good contrast\n        fontsize=8,\n        ha='center',\n        va='bottom',\n        alpha=1,\n        zorder=6,\n        path_effects=[\n            path_effects.Stroke(linewidth=2, foreground='white'),\n            path_effects.Normal()\n        ]\n    )\n\n#-----------------------------2-------------------------------------  \npbsa_cap.plot(ax=ax,\n           color='#434343',\n           markersize= 10,\n           alpha=0.75,\n           edgecolor='white',\n           linewidth=1)\n\n#-----------------------------3-------------------------------------  \n                  \nmasked_raster = np.ma.masked_where(raster == 0, raster)\n\nim = ax.imshow(\n    masked_raster,\n    cmap=cmap_mintpi_mini,\n    alpha=0.9,\n    zorder=1\n)\n\nax.imshow(masked_raster, cmap=cmap_mintpi_mini, extent=extent) #, extent=extent\nax.set_title('Market Areas Local Demand Capacity Pressure', fontsize=16, weight='bold')\nax.axis('off') \n\ncbar = plt.colorbar(im, ax=ax, fraction=0.036, pad=0.04)\ncbar.set_label('local demand capacity pressure', fontsize=12)\ncbar.outline.set_visible(False)  # cleaner look\n\nsave_path = os.path.join(hf, \"Market Areas Local Demand Capacity Pressure.png\")\nplt.savefig(save_path, dpi=300, bbox_inches=\"tight\")\n\nplt.tight_layout()\nplt.show()\nax.set_axis_off()\n\n\n\nFigure XX. Market Areas Local Demand Capacity Pressure\n\nout_raw = r'../outputs/3.3_market_pressure_analysis/market_pressure_sum_raw.tif'\n\n\n\n","type":"content","url":"/notebooks/market-pressure-analysis#demand-capacity-pressure","position":11},{"hierarchy":{"lvl1":"Student Accommodation Pressure"},"type":"lvl1","url":"/notebooks/market-pressure-analysis#student-accommodation-pressure","position":12},{"hierarchy":{"lvl1":"Student Accommodation Pressure"},"content":"\n\nData Import\n\nout_raw = r'../outputs/3.3_market_pressure_analysis/market_pressure_sum_raw.tif'\n\nwith rasterio.open(out_raw) as src:\n    raster = src.read(1)  # read first band as numpy array\n    transform = src.transform\n    crs = src.crs\n\nef = r\"../inputs/3.3_market_pressure_analysis/pbsa_capacity_analysis.gpkg\"\npbsa_cap = gpd.read_file(ef)\n\npbsa_cap.drop(columns=['link', '!cap_slag', '!cap_std', '!cap_slag_std', 'cluster', 'model', 'color', 'city'], inplace=True, errors='ignore') \n\n\n\ncoords = [(geom.x, geom.y) for geom in pbsa_cap.geometry]\nwith rasterio.open(out_raw) as src:\n    pbsa_cap[\"local_demand_capacity_pressure\"] = [val[0] for val in src.sample(coords)]\n\npbsa_cap[\"local_demand_capacity_pressure\"] = pbsa_cap[\"local_demand_capacity_pressure\"].round(3)\n\n\n\nLess Pressured Student Accommodations:\n\npbsa_cap[pbsa_cap[\"local_demand_capacity_pressure\"] > 0][[\n    \"name\",\n    \"plz\",\n    \"ownership\",\n    \"!cap\",\n    \"ownership_model\",\n    \"cluster_cap\",\n    \"local_demand_capacity_pressure\",\n]].sort_values(\"local_demand_capacity_pressure\").head(10)\n\n\n\nTable XX. Less Pressured Student Accommodations\n\npbsa_cap[pbsa_cap[\"local_demand_capacity_pressure\"] > 0][[\n    \"name\",\n    \"plz\",\n    \"ownership\",\n    \"!cap\",\n    \"ownership_model\",\n    \"cluster_cap\",\n    \"local_demand_capacity_pressure\",\n]].sort_values(\"local_demand_capacity_pressure\", ascending=False).head(10)\n\n\n\nTable XX. Most Pressured Student Accommodations\n\nбольшое давнение прихолитьмя именно на Studierendenwerk Berlin - госудавсвенные общежития\n\ncmap_mint_mini = ListedColormap(cmap_mint(np.linspace(0.15, 1, 256)))\n\nfig, ax = plt.subplots(figsize=(12, 12))\n\n# Replace pgr, bz, out with your base layers if needed\npgr.plot(ax=ax, facecolor='none', edgecolor='#cccccc', linewidth=0.5, linestyle=\"--\")\nbz.plot(ax=ax, facecolor='none', edgecolor='#999999', linewidth=0.75)\n# for idx, row in bz.iterrows():\n#     centroid = row['geometry'].centroid\n#     txt = ax.text(\n#         centroid.x, centroid.y,\n#         str(row['namgem']),\n#         fontsize=8, color='#666666', ha='center', va='center'\n#     )\n#     txt.set_path_effects([\n#         path_effects.Stroke(linewidth=2, foreground='white'),\n#         path_effects.Normal()\n#     ])\nout.plot(ax=ax, facecolor='none', edgecolor='#666666', linewidth=1.25)\n\nvmin=0\nvmax=35\n\npbsa_cap.plot(\n    ax=ax,\n    column='local_demand_capacity_pressure',\n    cmap=cmap_mintpi_mini,\n    edgecolor='none',\n    linewidth=0.3,\n    alpha=1,\n    legend=False,\n    vmin = vmin,\n    vmax = vmax)  # Matching Previous plott\n\nplt.tight_layout()\n\ncbar = plt.colorbar(im, ax=ax, fraction=0.036, pad=0.04)\ncbar.set_label('local_demand_capacity_pressure', fontsize=12)\ncbar.outline.set_visible(False)  # cleaner look\n\n# sm = plt.cm.ScalarMappable(cmap=cmap_mintpi_mini, norm=plt.Normalize(vmin, vmax))\n# cbar = fig.colorbar(sm, ax=ax, shrink=0.6)\n# cbar.set_label(\"summed demand capacity pressure\")\n# cbar.set_ticks(range(vmin, 36))\n\n# for _, r in market_area.iterrows():\n#     ax.annotate(str(int(r[\"cntr_hierracy_rank\"])), \n#                 xy=r[\"geometry\"].representative_point().coords[0],\n#                 ha=\"center\", va=\"center\", fontsize=7)\n\n# market_area.plot(\n#     ax=ax,\n#     edgecolor='white',  # variable for colormap\n#     facecolor=\"none\",        # transparent polygons  # edge colors from your column\n#     linewidth=0.3,\n#     alpha=1\n# )\nplt.tight_layout()\n\ncentral_places.plot(ax=ax,\n           color='#434343',\n           markersize= 10,\n           alpha=0.75,\n           edgecolor='white',\n           linewidth=1)\nplt.tight_layout()\nfor idx, row in central_places.iterrows():\n    offset = 3  # vertical offset in points\n    ax.annotate(\n        row['abr'],  # abbreviation\n        xy=(row.geometry.x, row.geometry.y),  # position of the point\n        xytext=(0, offset),  # move text upward\n        textcoords='offset points',\n        color='#1b4332',     # dark mint / forest green for good contrast\n        fontsize=8,\n        ha='center',\n        va='bottom',\n        alpha=1,\n        zorder=6,\n        path_effects=[\n            path_effects.Stroke(linewidth=2, foreground='white'),\n            path_effects.Normal()\n        ]\n    )\n\n#ax.legend(handles=legend_elements, loc='lower center', ncol=5, frameon=False, prop={'size': 10})\nax.set_title('Student Accommodation Demand Capacity Pressure', fontsize=16, weight='bold')\nax.set_axis_off()\n\nsave_path = os.path.join(hf, \"Student Accommodation Demand Capacity Pressure.png\")\nplt.savefig(save_path, dpi=300, bbox_inches=\"tight\")\n\nplt.show()\n\n\n\nFigure XX. Student Accommodation Demand Capacity Pressure","type":"content","url":"/notebooks/market-pressure-analysis#student-accommodation-pressure","position":13},{"hierarchy":{"lvl1":"4.1 Overview"},"type":"lvl1","url":"/notebooks/overview-2","position":0},{"hierarchy":{"lvl1":"4.1 Overview"},"content":"While the previous chapters described and examined the components of student housing and the market relationships between them, this chapter focuses on the users of student accommodations.","type":"content","url":"/notebooks/overview-2","position":1},{"hierarchy":{"lvl1":"4.1 Overview","lvl2":"What? Students Behind the Numbers"},"type":"lvl2","url":"/notebooks/overview-2#what-students-behind-the-numbers","position":2},{"hierarchy":{"lvl1":"4.1 Overview","lvl2":"What? Students Behind the Numbers"},"content":"Behind the student housing crisis numbers there are actual users. In order to rethink the housing crisis, it is necessary not only to assess the student housing market, but also to address users—customers—directly.\n\nThe first attempt to understand users was made in the chapter on defining demand. It is worth remembering that for this research, the target group is international students enrolled in Berlin’s higher education institutions, at any level, regardless of current residency. However, international students themselves do not represent a homogeneous group, but rather a multitude of disparate qualitative groups that differ from each other in terms of housing needs and preferences.\n\nThis chapter helps to get to know international students as users in more detail.","type":"content","url":"/notebooks/overview-2#what-students-behind-the-numbers","position":3},{"hierarchy":{"lvl1":"4.1 Overview","lvl2":"Why? Bridge Demand and Supply"},"type":"lvl2","url":"/notebooks/overview-2#why-bridge-demand-and-supply","position":4},{"hierarchy":{"lvl1":"4.1 Overview","lvl2":"Why? Bridge Demand and Supply"},"content":"The aim of this chapter is to define users and assess user experience by answering the following research questions:\n\nWho are the users of student accommodations?\n\nWhat experience they have in ongoing housing crisis? What are common needs, preferences, difficulties and problems?\n\nThe answers to these questions can be used in developing strategies to improve the situation on the student housing market and bridge demand and supply.","type":"content","url":"/notebooks/overview-2#why-bridge-demand-and-supply","position":5},{"hierarchy":{"lvl1":"4.1 Overview","lvl2":"How? Behavioral Studies"},"type":"lvl2","url":"/notebooks/overview-2#how-behavioral-studies","position":6},{"hierarchy":{"lvl1":"4.1 Overview","lvl2":"How? Behavioral Studies"},"content":"This chapter was written in collaboration with Joseph Kampfmann as part of the preparations for the ENHANCE workshop Perspectives on the European Student Accommodation Crisis, which was organised by Hannah Berner and Jesco Lippke.\n\nSurveys, Questionnaires, InterviewsSurveys, questionnaires, and interviews are traditional behavioral study methods widely used to collect data on people’s opinions, attitudes, and behavior. To improve the accuracy and relevance of the results, it is important not to generalise students but to divide them into qualitative groups. This takes into account the diversity of their needs and preferences, which contributes to a deeper understanding of the phenomena under study.\n\nStorytelling & Narrative AnalysisStorytelling & Narrative Analysis can be seen as an alternative method of behavioral studies that allows the exploration of participants’ personal stories and experiences, revealing the emotional and social aspects of their behavior (Riessman, 2008). Although this method differs from an overall data-driven approach, it makes it difficult to automate data analysis. Nevertheless, individual experiences are important for understanding hidden barriers to finding student housing, cultural sensitivity, and adaptation in a new city.\n\nFuture-proof urban solutions require collaborative planning, where city authorities, public and private investors, and citizens act together.","type":"content","url":"/notebooks/overview-2#how-behavioral-studies","position":7},{"hierarchy":{"lvl1":"4.2 Student Needs and Preferences"},"type":"lvl1","url":"/notebooks/students-needs-and-preferences","position":0},{"hierarchy":{"lvl1":"4.2 Student Needs and Preferences"},"content":"import warnings\n\nwarnings.filterwarnings(\"ignore\")\n\nimport os\nhf = r'../outputs/4.2_students_needs/'\nos.makedirs(hf, exist_ok=True)\n\n\n\n","type":"content","url":"/notebooks/students-needs-and-preferences","position":1},{"hierarchy":{"lvl1":"4.2 Student Needs and Preferences"},"type":"lvl1","url":"/notebooks/students-needs-and-preferences#id-4-2-student-needs-and-preferences","position":2},{"hierarchy":{"lvl1":"4.2 Student Needs and Preferences"},"content":"\n\nAs part of behavioural studies, an online survey of student dormitory users was conducted, in which more than 100 people took part.\n\nThe survey of Berlin students partially reproduces and refines the study by Von Wittenhorst Zu Sonsfeld and Beusker conducted in 2024 in the German city of Aachen.\n\nAs part of the study, the survey was published in thematic groups on housing search, and was also distributed in the form of QR codes on the campus of the Technical University of Berlin (TU) and Studierendenwerk Berlin accommodations.\n\nAffordability Theory was chosen as the theoretical basis for behavioural studies, which assumes that affordability is not limited to financial indicators, but also includes education, transport and social indicators.\n\n","type":"content","url":"/notebooks/students-needs-and-preferences#id-4-2-student-needs-and-preferences","position":3},{"hierarchy":{"lvl1":"4.2 Student Needs and Preferences","lvl2":"Set Up"},"type":"lvl2","url":"/notebooks/students-needs-and-preferences#set-up","position":4},{"hierarchy":{"lvl1":"4.2 Student Needs and Preferences","lvl2":"Set Up"},"content":"\n\nImport Libraries\n\nimport pandas as pd\nimport geopandas as gpd\nimport chardet\nimport gspread\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nimport textwrap\nfrom pywaffle import Waffle\nimport numpy as np\nfrom matplotlib.patches import Patch\nfrom math import pi\n\n\n\nColors\n\nfrom matplotlib.colors import LinearSegmentedColormap\n\ncolors= [\"#FFE5D9\", \"#FFD7BA\", \"#FEC89A\", \"#FFB78F\", \"#F49F7D\", \"#F28B6D\", \"#E1755CFF\"]\n\n\n\nFont\n\nplt.rcParams[\"font.family\"] = \"Helvetica\"\n\n\n\nScripts\n\nimport pandas as pd          \nimport matplotlib.pyplot as plt  \n\ndef plot_pie_chart(column_name, title=None):\n    if column_name not in df.columns:\n        print(f\"Column '{column_name}' not found in DataFrame\")\n        return\n    \n    # Count values and prepare data\n    value_counts = df[column_name].value_counts()\n    total = value_counts.sum()\n    \n\n    # Custom function to show count and percentage\n    def make_autopct(values):\n        def my_autopct(pct):\n            count = int(round(pct * total / 100.0))\n            return f\"{pct:.1f}%\\n[{count}]\"\n        return my_autopct\n\n    # Create pie chart\n    plt.figure(figsize=(8, 8))\n    patches, texts, autotexts = plt.pie(\n        value_counts,\n        labels=value_counts.index,\n        colors=colors[:len(value_counts)],\n        autopct=make_autopct(value_counts),\n        startangle=90,\n        textprops={'fontsize': 12}\n    )\n    \n    # Equal aspect ratio ensures pie is drawn as circle\n    plt.axis('equal')  \n    \n    # Set title (use column name if no custom title provided)\n    if not title:\n        title = f\"Distribution of {column_name}\"\n    plt.title(title, fontsize=14, pad=20, weight='bold')\n    \n    # Improve label readability\n    plt.setp(texts, size=12)\n    plt.setp(autotexts, size=10, color='black')\n    \n    plt.tight_layout()\n\n    plt.savefig(os.path.join(hf, f\"{column_name}_pie_chart.png\"))\n\n    plt.show()\n\n\n\n\nimport pandas as pd          \nimport matplotlib.pyplot as plt  \n\ndef plot_bar_chart(column_name, title=None, rotate_labels=True):\n    if column_name not in df.columns:\n        print(f\"Column '{column_name}' not found in DataFrame\")\n        return\n\n    value_counts = df[column_name].value_counts()\n    total = value_counts.sum()\n\n    plt.figure(figsize=(10, 6))\n    bars = plt.bar(value_counts.index,\n                   value_counts.values,\n                   color=colors[:len(value_counts)])\n\n    # add 15 % breathing room above tallest bar\n    plt.ylim(0, value_counts.max() * 1.15)\n\n    # annotate bars\n    for bar, value in zip(bars, value_counts.values):\n        pct = 100 * value / total\n        plt.text(bar.get_x() + bar.get_width() / 2,\n                 bar.get_height() + value_counts.max() * 0.02,  # a little above the bar\n                 f\"{pct:.1f}%\\n[{value}]\",\n                 ha='center', va='bottom', fontsize=10)\n\n    if not title:\n        title = f\"Distribution of {column_name}\"\n    plt.title(title, fontsize=14, pad=15, weight='bold')\n    plt.ylabel(\"Count\")\n\n    if rotate_labels:\n        plt.xticks(rotation=45, ha='right')\n\n    plt.tight_layout()\n\n    # Save the figure\n    plt.savefig(os.path.join(hf, f\"{column_name}_bar_chart.png\"))\n\n    plt.show()\n\n\n\n","type":"content","url":"/notebooks/students-needs-and-preferences#set-up","position":5},{"hierarchy":{"lvl1":"4.2 Student Needs and Preferences","lvl2":"Data Mining"},"type":"lvl2","url":"/notebooks/students-needs-and-preferences#data-mining","position":6},{"hierarchy":{"lvl1":"4.2 Student Needs and Preferences","lvl2":"Data Mining"},"content":"\n\nThe input data for the analysis was tabular data downloaded from Google Forms responses.\n\nfp = r\"../inputs/4.2_students_needs/student_experience_090126.xlsx\" \n\ndf = pd.read_excel(fp)\n\n\n\ncolumns_to_drop = [\n    'Отметка времени',\n    'Баллы',\n    'Briefly describe your experience with discrimination',\n    'What was your biggest challenge in your apartment search?',\n    'How has Berlin’s housing crisis affected your search?',\n    'What policies could improve student housing in your eyes?'\n]\n\ndf.drop(columns= columns_to_drop, inplace=True, errors='ignore')\n\n\n\nThe survey consists of 34 questions, designed to take a total of 10-15 minutes to complete, and consists of three thematic sections:\n\nPersonal DataThe first section is aimed at collecting basic socio-demographic and contextual information necessary to understand the profile of respondents and correctly interpret behavioural patterns in the student housing market.\n\nSocio-demographic characteristics\n\ngender\n\nage group\n\norigin (origin)\n\nstudy status (stat)These questions allow us to analyse whether housing problems vary between different social groups and help to determine whether international students face a higher degree of market pressure than local students.\n\nFinancial and housing information\n\nresidential address (adr)\n\npostcode (plz)\n\ncurrent rent (price),\n\nsources of funding (fin)\n\nhousing model (model)These questions provide insight into budget constraints and types of accommodation.\n\nThis block forms the basis for analysis and helps answer the question:\n\nWho are the users of student accommodation?\n\nNeeds and PreferencesThe second section is devoted to identifying the factors that determine the choice of housing, subjective assessment of needs and living conditions. The structure of the section reflects the key parameters of housing affordability, location choice, mobility behaviour and social environment.\n\nAffordability\nThe questions assess the financial component of current housing:\n\nmonthly rent within budget (a_price) — whether the rent is in proportion to personal budget.\n\nprice matches apartment condition (a_cond) — subjective perception of the fairness of the cost.\n\nhidden costs (a_hidd) — the presence of additional financial barriers (deposits, commissions).This block allows us to assess the degree of financial stress and identify the gap between expectations and market reality.\n\nLocation & ProximityThis measures the significance of spatial factors:\n\nproximity to the university (l_uni);\n\naccessibility of the ring-bahn as a key transport axis (l_ring);\n\navailability of inexpensive food (Mensa) (l_mensa);\n\navailability of green areas (l_green);\n\nproximity to shops and essential services (l_grocer).This data allows us to assess which amenities have the greatest influence on the choice of place of residence.\n\nTransportationThe questions are aimed at assessing the quality of the transport infrastructure:\n\nquality and frequency of public transport (t_connect);\n\ncycling infrastructure (t_bike);\n\navailability of night transport (t_night).This block is critical for understanding how students commute to and from university and how important this is to them.\n\nSocial & Living ConditionsThe questions clarify the quality of the social environment:\n\nneighbourhood safety (s_safe);\n\naccess to cultural/student events (s_cultur);\n\nproximity to student communities (s_common);\n\nfriendliness towards international students (s_env);\n\ninclusiveness (s_incl).This section identifies how the social atmosphere affects satisfaction with accommodation and choice of neighbourhood.\n\nDifficulties and SatisfactionThe third section explores the subjective experience of finding accommodation, stress levels and potential barriers, including discrimination.\n\nThe housing search process\n\nmethod of finding housing (way);\n\nduration of the search (term);\n\nexistence of a long-term contract (longtermagree);\n\nnumber of applications submitted (applic_count).These questions provide insight into the time and effort required to integrate into the rental market.\n\nEmotional and social impact\n\nlevel of stress when searching for housing (stress);\n\nlevel of satisfaction with current housing (satisfied).This helps to identify the degree of individual market pressure.\n\nProblems and discrimination\n\nthe existence of difficulties (diff);\n\ntypes of discrimination (discrimination).These questions allow us to analyse the vulnerability of different groups of students and assess the social justice of the market.\n\nThe interpretation of the third section is beyond the scope of this chapter and will be discussed in more detail in the next chapter, Students’ Experiences.\n\ndf.info()\n\n\n\nWhen working with survey responses, standard data preparation operations used in data science were performed.\n\nFirst, the columns and response categories were renamed to shorter and more uniform designations. This simplified data access made the code more compact and ensured uniformity in the structure of the dataset.\n\n# Clean up any hidden characters\ndf.columns = df.columns.str.strip().str.replace('\\xa0', ' ', regex=False)\n\n# Renaming colums for data clarity\ndf = df.rename(columns={\n    'Gender': 'gender',\n    'Age Group': 'age',\n    'Origin': 'origin',\n    'University': 'uni',\n    'Study Status': 'stat',\n    'Address (street & house number)': 'adr',\n    'Postal Code': 'plz',\n    'Current Rental Price': 'price',\n    'Sources of Financing': 'fin',\n    'Housing Model': 'model',\n    'Monthly Rent Within Budget': 'a_price',\n    'Price Matches Apartment Condition': 'a_cond',\n    'Hidden Costs (deposit, agency fees)': 'a_hidd',\n    'Proximity to the University': 'l_uni',\n    'Proximity to the Ring-Bahn': 'l_ring',\n    'Proximity to the Mensa (or affordable food options)': 'l_mensa',\n    'Proximity to Green Spaces (parks, canals)': 'l_green',\n    'Proximity to Grocery Stores/Essential Services': 'l_grocer',\n    'Quality of public transport connections (frequency, reliability)': 't_connect',\n    'Bike-friendly infrastructure (storage, parking places, bicycle paths)': 't_bike',\n    'Night transport options (for late classes/part-time work)': 't_night',\n    'Safety in the Neighborhood': 's_safe',\n    'Access to Cultural/Student events': 's_cultur',\n    'Proximity to Student Communities': 's_common',\n    'International student-friendly environment': 's_env',\n    'Inclusivity': 's_incl',\n    'How did you find your accomodation in Berlin?': 'way',\n    'How long have you searched for your long term accommodation in Berlin?': 'term',\n    'Do you have a Long Term Rental Agreement?': 'longtermagree',\n    'How stressful would you describe your housing search?': 'stress',\n    'How many accommodations did you apply for?': 'applic_count',\n    'How satisfied are you with your current housing situation?': 'satisfied',\n    'Did you experience any kinds of difficulties?': 'diff',\n    'What kind of discrimination did you have to face with?': 'discrimination'\n})\n\n\n\n#Renaming long answers\nmodel_mapping = {\n    \"Studierendenwerk Dorms (State-subsidised student housing)\": \"PBSA\",\n    \"PBSA (e.g., Neon Wood – private investor housing with high amenities)\": \"PBSA\",\n    \"Wohngemeinschaften (WGs – shared flats, informal sublets)\": \"Wohngemeinschaften (WG)\",\n    \"Living at Home (with family, commuting)\": \"Living at Home\",\n    \"Commons / Co-ops (e.g., STUK - self-managed, solidarity-based housing)\": \"Co-ops / Commons\",\n    \"PPPs (e.g., Camplus – public-private university housing models)\": \"PPP Housing\",\n    \"Private Apartment / Studio\": \"Private Apartment\"\n}\n\n#Apply the renaming\ndf[\"model_short\"] = df[\"model\"].replace(model_mapping)\n\n\n\nSecondly, since the correct type of variables is critical for further analysis, numerical indicators were converted from text format to numerical format. This made it possible to perform statistical calculations, construct distributions, and apply quantitative analysis methods.\n\nint_columns = [\n    'a_price', 'a_cond', 'a_hidd', 'l_uni', 'l_ring', 'l_mensa', 'l_green',\n    'l_grocer', 't_connect', 't_bike', 't_night', 's_safe', 's_cultur',\n    's_common', 's_env', 's_incl', 'stress', 'satisfied'\n]\n\n\nfor col in int_columns:\n    df[col] = pd.to_numeric(df[col], errors='coerce').astype('Int64')\n\n\n\nThirdly, multiple-choice questions were standardised: answers were broken down into binary indicators (dummy variables), which made it possible to correctly account for each selected option when modelling and analysing frequencies. This approach ensures data interpretability and prevents the loss of information that is characteristic of aggregated text fields. In addition, gaps were eliminated, and categories were brought into a uniform format.\n\nfin_categories = ['Public Funding', 'Private Support', 'Part-Time Job', 'Scholarship']\n\n# Step 1: Clean and split the values\ndf['fin_e'] = (\n    df['fin']\n    .str.split(',')  # Split by comma\n    .apply(lambda x: [item.strip() for item in x] if isinstance(x, list) else [])\n    .apply(lambda x: [item for item in x if item])  # Remove empty strings\n)\n\n\n\ndf['discrimination'] = df['discrimination'].replace(\n    'I didn\\'t face Discrimination',  # Value to replace\n    pd.NA  # Replacement value (null)\n)\n\ndiscrimination_categories = ['Nationality', 'Language', 'Gender', 'Economic', 'Sexual Orientation']\n\n# Step 1: Clean and split the values\ndf['discrimination_e'] = (\n    df['discrimination']\n    .str.split(',')  # Split by comma\n    .apply(lambda x: [item.strip() for item in x] if isinstance(x, list) else [])\n    .apply(lambda x: [item for item in x if item])  # Remove empty strings\n)\n\n\n\ndiff_categories = ['Limited Affordable Options', 'Too Much Competition', 'No Responses', 'Discrimination', 'Scams', 'Other']\n\n# Step 1: Clean and split the values\ndf['diff_e'] = (\n    df['diff']\n    .str.split(',')  # Split by comma\n    .apply(lambda x: [item.strip() for item in x] if isinstance(x, list) else [])\n    .apply(lambda x: [item for item in x if item])  # Remove empty strings\n)\n\n\n\nTogether, these steps provided a clean, consistent, and analysable dataset that meets the methodological requirements of quantitative behavioral research.\n\n","type":"content","url":"/notebooks/students-needs-and-preferences#data-mining","position":7},{"hierarchy":{"lvl1":"Users Personal Data"},"type":"lvl1","url":"/notebooks/students-needs-and-preferences#users-personal-data","position":8},{"hierarchy":{"lvl1":"Users Personal Data"},"content":"\n\n","type":"content","url":"/notebooks/students-needs-and-preferences#users-personal-data","position":9},{"hierarchy":{"lvl1":"Users Personal Data","lvl2":"Student Status"},"type":"lvl2","url":"/notebooks/students-needs-and-preferences#student-status","position":10},{"hierarchy":{"lvl1":"Users Personal Data","lvl2":"Student Status"},"content":"\n\nThe majority of survey participants (98.1%) were university students, including undergraduates, postgraduates and college students (Figure XX). This group constitutes the core user base of student accommodation and most accurately reflects the typical demand for long-term, affordable housing near universities.\n\nHowever, it is important to emphasise that student accommodation in Berlin serves a much wider range of educational tracks. A significant proportion of users are applicants from other countries who are studying at a preparatory college (Studienkolleg) and preparing to enrol at universities in the German capital. These students have specific needs related to their short stay and high dependence on the availability of housing when taking their first steps in a new country.\n\nExchange students, including participants in Erasmus and Double-Degree programs, form a separate category. Unlike regular university students, they are mainly interested in short-term rentals of 3 to 12 months, which creates additional seasonal and structural demand for flexible, temporary forms of accommodation.\n\nIn addition, the urban student ecosystem includes students at higher levels of education — doctoral students, graduates seeking additional qualifications, interns, and young research and teaching staff. Their housing needs vary greatly, ranging from short-term stays during internships to long-term accommodation near research institutes.\n\nAll of these groups represent a significant research gap, as they fall outside the scope of both the original study by Von Wittenhorst Zu Sonsfeld and Beusker (2024) and the current work. Their inclusion requires separate analysis, as they create additional hidden demand, which in practice increases the burden on the student housing market but is rarely taken into account in regulatory and statistical assessments.\n\nplot_bar_chart(\"stat\", title=\"Student Status Distribution\")\n\n\n\nFigure XX. Student Status Distribution\n\n","type":"content","url":"/notebooks/students-needs-and-preferences#student-status","position":11},{"hierarchy":{"lvl1":"Users Personal Data","lvl2":"Age"},"type":"lvl2","url":"/notebooks/students-needs-and-preferences#age","position":12},{"hierarchy":{"lvl1":"Users Personal Data","lvl2":"Age"},"content":"According to the survey results, the largest groups were students aged 24–26 (30.1%) and 21–23 (29.1%), who together make up almost two-thirds of the entire sample. These age categories reflect the typical structure of Berlin’s student population, which is dominated by senior undergraduate and master’s students.\n\nThe younger group — students under the age of 21 — accounts for 17.5%, which corresponds to the proportion of first-year students and students in preparatory programs. The remaining categories — 27–29 years old and over 30 years old — include late starters, doctoral students, participants in international programs, and young professionals who combine work with study; each of these groups accounts for 11.7%.\n\nThe data on student age obtained from the survey is consistent with the official statistics from Statistik Berlin Brandenburg (2025), where 57.8% of students are over 25 years old.\n\nThus, the age distribution (Figure XX) shows a predominance of mature students in the later stages of their studies, which influences their housing preferences, level of independence, and requirements for the quality and affordability of housing.\n\nplot_pie_chart(\"age\", title=\"Age Distribution\")\n\n\n\nFigure XX. Age Distribution\n\n","type":"content","url":"/notebooks/students-needs-and-preferences#age","position":13},{"hierarchy":{"lvl1":"Users Personal Data","lvl2":"Origin"},"type":"lvl2","url":"/notebooks/students-needs-and-preferences#origin","position":14},{"hierarchy":{"lvl1":"Users Personal Data","lvl2":"Origin"},"content":"Most of the survey participants are international students, with the majority coming from non-European countries (Non-EU) — 75.7%, while students from European Union countries make up another 13.6% of the sample. Only 10.7% of participants are German citizens.\n\nThis distribution is fully consistent with the target audience of the study, which focuses on analysing the living conditions and barriers faced by international students — the group experiencing the most significant difficulties in the Berlin rental market.\n\nThe high proportion of non-EU students further reflects Berlin’s growing international appeal as an educational center and highlights the relevance of studying the pressure on the student housing market.\n\nplot_pie_chart(\"origin\", title=\"Origin Distribution\")\n\n\n\n\nFigure XX. Origin Distribution\n\n","type":"content","url":"/notebooks/students-needs-and-preferences#origin","position":15},{"hierarchy":{"lvl1":"Users Personal Data","lvl2":"Housing Model"},"type":"lvl2","url":"/notebooks/students-needs-and-preferences#housing-model","position":16},{"hierarchy":{"lvl1":"Users Personal Data","lvl2":"Housing Model"},"content":"Students in Berlin use a wide range of accommodation models, each with its own structural features, advantages, risks and local context. These models form a heterogeneous student housing market, where public mechanisms coexist with the private sector, cooperatives and informal solutions. Let us consider three of them that are most frequently mentioned in the literature.\n\nPurpose-Built Student Accommodation (PBSA)\nPurpose-Built Student Accommodation can be divided into two categories: public and private.\n\nState-owned purpose-built student accommodation is funded and managed by public agencies and is the most affordable form of student housing. Its key advantages are low cost and social diversity among residents. However, limited capacity and long waiting lists significantly reduce their availability. This makes them a scarce resource and increases pressure on other types of housing.\n\nPrivate purpose-built student accommodation is an investment-oriented segment of student housing, offering modern infrastructure, additional services and the possibility of immediate occupancy. At the same time, such properties are very expensive, which makes them inaccessible to many students and contributes to spatial segregation.\n\nAlthough 53.4% of users indicated that they live in PBSAs, in reality, only 5-6% of students in Berlin live in PBSAs. The majority of students live in shared flats or other corporate models due to the predominantly rental housing situation in Germany (Janet Merkel, 2025).\n\nWohngemeinschaften (WGs)\nOne of the most common forms of accommodation for students in Berlin is shared rented flats with an informal system of renting and subletting. The most important advantages of WGs are flexibility, affordability and a high level of social interaction. However, such conditions are often accompanied by instability, short-term contracts and discrimination when moving in, which particularly affects foreign students.\n\nLiving at HomeThis option involves living in the parental home with daily commutes to the place of study. It ensures no or minimal rental costs, but increases the risk of social isolation and imposes time costs associated with long commutes. Unlike in Eastern European countries, this model is much less common in Berlin (Janet Merkel, 2025).\n\nWith regard to Housing Model Distribution (Figure XX), the survey results are heavily skewed towards users of purpose-built student accommodation, as the main target group of the study.\n\nplot_bar_chart(\"model_short\", title=\"Housing Model Distribution\")\n\n\n\nFigure XX. Housing Model Distribution\n\n","type":"content","url":"/notebooks/students-needs-and-preferences#housing-model","position":17},{"hierarchy":{"lvl1":"Users Personal Data","lvl2":"Sources of Financing"},"type":"lvl2","url":"/notebooks/students-needs-and-preferences#sources-of-financing","position":18},{"hierarchy":{"lvl1":"Users Personal Data","lvl2":"Sources of Financing"},"content":"According to the survey results (Figure XX), the most common source of financing for students’ educational and personal expenses is part-time employment: almost half of the respondents (47.3%) work alongside their studies to cover their daily expenses and living costs.\n\nA significant proportion of respondents (36.6%) receive financial support from private individuals, most often from parents or relatives. However, formal support mechanisms, such as government funds (5.3%) and academic scholarships (6.9%), are used relatively rarely, which highlights the limited official channels of assistance for foreign students.\n\nIt is particularly telling that 81.3% of students identify rent as their largest expense. This confirms the key finding of the study: the cost of living in Berlin has a decisive influence on students’ economic behavior and constitutes the main financial pressure affecting both their choice of place of residence and the need for additional employment.\n\nfin_categories = ['Public Funding', 'Private Support', 'Part-Time Job', 'Scholarship']\n\ncolors = [\"#FFE5D9\", \"#FFD7BA\", \"#FEC89A\", \"#FFB78F\", \"#F49F7D\", \"#F28B6D\", \"#E1755CFF\"]\n\n# Create an empty counter\nfin_counts = {cat: 0 for cat in fin_categories}\nfin_counts['Other'] = 0\n\n# Count occurrences (handling multiple answers per student)\nfor entry in df['fin'].dropna():\n    # Convert to lowercase and split multiple answers\n    entries = [e.strip().lower() for e in str(entry).split(',')]\n    matched = False\n    for cat in fin_categories:\n        if any(cat.lower() in e for e in entries):\n            fin_counts[cat] += 1\n            matched = True\n    if not matched and entries:  # Only count as 'Other' if non-empty\n        fin_counts['Other'] += 1\n\n# Convert to DataFrame for plotting\nfin_df = pd.DataFrame(list(fin_counts.items()), columns=['Source', 'Count'])\n\n# Define autopct function with access to counts\ndef make_autopct(values):\n    total = sum(values)\n    def my_autopct(pct):\n        count = int(round(pct * total / 100.0))\n        return f\"{pct:.1f}%\\n[{count}]\"\n    return my_autopct\n\n# Plot pie chart\nplt.figure(figsize=(10, 8))\nplt.pie(fin_df['Count'], \n        labels=fin_df['Source'], \n        autopct=make_autopct(fin_df['Count']),\n        startangle=140, \n        colors=colors[:len(fin_counts)],\n        textprops={'fontsize': 12})\nplt.title('Sources of Financing Distribution\\n(Multiple Answers)', \n          fontsize=14, weight='bold', pad=20)\nplt.axis('equal')\n\nsave_path = os.path.join(hf, \"Sources of Financing Distribution (Multiple Answers).png\")\nplt.savefig(save_path, dpi=300, bbox_inches=\"tight\")\n\nplt.tight_layout()\nplt.show()\n\n\n\n\nFigure XX. Sources of Financing Distribution\n\n","type":"content","url":"/notebooks/students-needs-and-preferences#sources-of-financing","position":19},{"hierarchy":{"lvl1":"Needs and Preferences"},"type":"lvl1","url":"/notebooks/students-needs-and-preferences#needs-and-preferences","position":20},{"hierarchy":{"lvl1":"Needs and Preferences"},"content":"\n\nIn the second part of the survey, the target audience was asked to answer the question: what is most important when looking for housing? This helps to identify the needs and preferences of international students across the city.\n\nThe Affordability category covers issues such as whether the rent fits the budget, whether the price is commensurate with the quality of the accommodation, and whether there are any hidden costs. The Location & Proximity block records students’ spatial preferences, including proximity to the university, everyday infrastructure and leisure areas. Transportation reflects accessibility and quality of mobility, while Social & Living Conditions describes the social environment, sense of security, inclusiveness, and access to student communities.\n\nTo ensure comparability of results, all responses were converted to a numerical format and aggregated within the relevant groups. For each question, respondents were asked to rate the importance of a particular factor on a scale from 1 (not important at all) to 10 (extremely important). In addition, a uniform order of display of indicators was established, which made it possible to maintain the logical structure of the analysis and ensure consistent interpretation of the results both at the level of individual indicators and at the level of thematic blocks.\n\nThus, this stage of the analysis serves as a diagnostic cross-section, allowing us to identify key areas of tension and satisfaction in students’ perceptions of the Berlin housing market and to create a basis for further research of subjective assessments.\n\n","type":"content","url":"/notebooks/students-needs-and-preferences#needs-and-preferences","position":21},{"hierarchy":{"lvl1":"Needs and Preferences","lvl2":"General Statistics"},"type":"lvl2","url":"/notebooks/students-needs-and-preferences#general-statistics","position":22},{"hierarchy":{"lvl1":"Needs and Preferences","lvl2":"General Statistics"},"content":"As a preliminary analysis of the data, similar to the Descriptive Market Statistics chapter, a generalised summary statistics assessment of respondents’ answers was conducted across four key thematic topics reflecting the main dimensions of the student housing experience: affordability, location and proximity, transportation, and social and living conditions.\n\ngroup_columns = {\n    'Affordability': ['a_price', 'a_cond', 'a_hidd'],\n    'Location & Proximity': ['l_uni', 'l_ring', 'l_mensa', 'l_green', 'l_grocer'],\n    'Transportation': ['t_connect', 't_bike', 't_night'],\n    'Social & Living Conditions': ['s_safe', 's_cultur', 's_common', 's_env']\n}\n\norder = [\n    'a_price', 'a_cond', 'a_hidd', 'Affordability',\n    'l_uni', 'l_ring', 'l_mensa', 'l_green', 'l_grocer', 'Location & Proximity',\n    't_connect', 't_bike', 't_night', 'Transportation',\n    's_safe', 's_cultur', 's_common', 's_env', 's_incl', 'Social & Living Conditions'\n]\n# 'stress', 'satisfied'\n\nitem_rename = {\n    'a_price': 'Monthly Rent Within Budget',\n    'a_cond': 'Price Matches Apartment Condition',\n    'a_hidd': 'Hidden Costs',\n    'l_uni': 'Proximity to the University',\n    'l_ring': 'Proximity to the Ring-Bahn',\n    'l_mensa': 'Proximity to the Mensa',\n    'l_green': 'Proximity to Green Spaces (parks, canals)',\n    'l_grocer': 'Proximity to Essential Services',\n    't_connect': 'Quality of Public Transport Connections',\n    't_bike': 'Bike-Friendly Infrastructure',\n    't_night': 'Night Transport Options',\n    's_safe': 'Safety in the Neighborhood',\n    's_cultur': 'Access to Cultural/Student Events',\n    's_common': 'Proximity to Student Communities',\n    's_env': 'International Student-Friendly Environment',\n    's_incl': 'Inclusivity',\n    'stress': 'Level of Stress',\n    'satisfied': 'Level of Satisfaction',\n    'Affordability': 'Affordability',\n    'Location & Proximity': 'Location & Proximity',\n    'Transportation': 'Transportation',\n    'Social & Living Conditions': 'Social & Living Conditions'\n}\n\nint_columns = [\n    'a_price', 'a_cond', 'a_hidd', 'l_uni', 'l_ring', 'l_mensa', 'l_green',\n    'l_grocer', 't_connect', 't_bike', 't_night', 's_safe', 's_cultur',\n    's_common', 's_env', 's_incl'\n]\n#'stress', 'satisfied'\ngroup_columns = {\n    'Affordability': ['a_price', 'a_cond', 'a_hidd'],\n    'Location & Proximity': ['l_uni', 'l_ring', 'l_mensa', 'l_green', 'l_grocer'],\n    'Transportation': ['t_connect', 't_bike', 't_night'],\n    'Social & Living Conditions': ['s_safe', 's_cultur', 's_common', 's_env']\n}\n\n\n\nBased on the descriptive statistics presented (Table XX), several key patterns can be identified in students’ preferences for living conditions.\n\nThe Affordability category shows the highest and most consistent ratings among all the blocks analysed. The average value for the group is 8.29 with a low standard deviation, which indicates relative uniformity of perception. The affordability of rent is particularly highly rated (mean = 9.12, median = 10), reflecting students’ adaptation to financial constraints or forced compromises when choosing accommodation. At the same time, issues of hidden costs and value for money have a higher variance, indicating heterogeneous experiences and the presence of problematic cases.\n\nThe Location & Proximity block is characterised by a significantly lower average value (5.74) and greater variability in ratings. The most important aspect is proximity to canteens and affordable places to eat (mean = 3.52), as well as to universities and the Ring-Bahn, reflecting the spatial gap between places of study and actual areas of residence for students. At the same time, access to everyday services is rated relatively highly, indicating the compensatory role of urban infrastructure outside university clusters.\n\nIn the Transportation category, there is a marked contrast between individual indicators. The quality of public transport receives one of the highest ratings in the sample (mean = 8.53), confirming the important role of Berlin’s transport system as a compensatory mechanism for long-distance commuting. At the same time, cycling infrastructure is rated significantly lower (mean = 4.42) and shows high dispersion, indicating a spatially uneven distribution of bicycle-friendly conditions.\n\nThe most vulnerable group of indicators is Social & Living Conditions, with an average score of 5.19. Despite a relatively high sense of security in the neighbourhood, access to student communities, cultural events and a sense of an inclusive environment receive low ratings and are characterised by high variability. This indicates social fragmentation in student housing and weak integration of some students, especially international students, into local social structures.\n\nOverall, the results of the initial analysis show that economic affordability and transport connectivity are priority factors in a stressed market.\n\nimport pandas as pd\n\n# Clean column names\ndf.columns = df.columns.str.strip()\n\n# Individual stats\nindividual_stats = df[int_columns].describe().T[['mean', 'std', 'min', '50%', 'max']].round(2)\nindividual_stats.rename(columns={'50%': 'median'}, inplace=True)\nindividual_stats.index.name = 'Item'\nindividual_stats.reset_index(inplace=True)\n\n# Grouped stats\ngrouped_stats = []\nfor group_name, cols in group_columns.items():\n    group_df = df[cols].mean(axis=1)  # row-wise mean for the group\n    stats = {\n        'Item': group_name,\n        'mean': group_df.mean().round(2),\n        'std': group_df.std().round(2),\n#        'min': group_df.min().round(2),\n        'median': group_df.median().round(2),\n#        'max': group_df.max().round(2)\n    }\n    grouped_stats.append(stats)\n\ngroup_stats_df = pd.DataFrame(grouped_stats)\n\n# Combine both\nstatistics = pd.concat([individual_stats, group_stats_df], ignore_index=True)\n\nstatistics.set_index('Item', inplace=True)\nstatistics = statistics.loc[order].reset_index()\n\nstatistics['Item'] = statistics['Item'].replace(item_rename)\n\n# Display result\nstatistics\n\n\n\nTable XX. General Student Needs and Preferences\n\nCorrelation analysis of student needs and preferences (Figure XX) reveals stable relationships between individual aspects of housing choice, thereby deepening the interpretation of descriptive statistics results. Overall, the correlation matrix shows moderate but structurally meaningful relationships, indicating the multidimensional nature of student housing capacity, where no single factor is completely isolated.\n\nAffordability indicators show relatively weak correlations with spatial and social characteristics. Rent affordability and hidden costs are more closely related to each other than to other blocks, confirming their autonomous role in the decision-making process. This indicates that financial constraints are seen by students as a separate structural condition rather than an element of the integrated quality of the living environment.\n\nBlocks associated with Location & Proximity form a dense cluster of interrelationships. Proximity to the university, the ring-bahn, the mensa, green areas, and basic services shows consistent positive correlations with each other (in the range of approximately 0.27–0.50). This indicates that students tend to view accessibility not in terms of individual objects, but as a comprehensive characteristic of the living environment. A particularly strong link is observed between proximity to the Mensa and student communities, as well as between green areas and cultural access, which emphasises the role of everyday routes and infrastructure in creating a comfortable environment.\n\nTransportation indicators act as a link between spatial and social characteristics. The quality of public transport correlates moderately with proximity to key urban functions and night-time transport, reflecting the importance of the transport system as a mechanism for commuters. At the same time, cycling infrastructure shows more selective links, including a negative correlation with the sense of safety in the area, which may indicate local conflicts between different types of mobility or spatial heterogeneity of cycling conditions in the city.\n\nSocial & Living Conditions form a separate but interrelated cluster. Access to cultural events, proximity to student communities, an internationally friendly environment, and inclusiveness demonstrate moderate positive correlations. The strongest link is observed between student communities and an international-friendly environment, which highlights the importance of social networks and “social density” for international students. At the same time, the feeling of safety is weakly correlated with most social indicators, which may indicate a gap between the physical and social comfort of the environment.\n\nOverall, correlation analysis confirms that student housing choices are shaped by the intersection of three factors: economic adaptation, spatial accessibility, and social integration. At the same time, it is precisely spatial and social connections that are the most structured, while financial parameters act more as a strict limitation than as an active factor in shaping preferences.\n\ncustom_colors = [ \"#8FB9AE\", \"#A9CCC1\", \"#C8E0D4\",\"#EAF4E8\",  \"#FBF0EA\",\"#FFE5D9\", \"#FFD7BA\", \"#FEC89A\", \"#FFB78F\"]\n\nlabel_dict = {\n    'a_price': 'Monthly Rent Within Budget',\n    'a_cond': 'Price Matches Condition',\n    'a_hidd': 'Hidden Costs',\n    'l_uni': 'Proximity to University',\n    'l_ring': 'Proximity to Ring-Bahn',\n    'l_mensa': 'Proximity to Mensa',\n    'l_green': 'Proximity to Green Spaces',\n    'l_grocer': 'Proximity to Essential Services',\n    't_connect': 'Public Transport Quality',\n    't_bike': 'Bike Infrastructure',\n    't_night': 'Night Transport',\n    's_safe': 'Neighborhood Safety',\n    's_cultur': 'Cultural Access',\n    's_common': 'Student Communities',\n    's_env': 'Intl. Student-Friendly',\n    's_incl': 'Inclusivity'\n}\n\n# Define columns to analyze\nloc_cols = [\n    'a_price', 'a_cond', 'a_hidd', 'l_uni', 'l_ring', 'l_mensa', 'l_green',\n    'l_grocer', 't_connect', 't_bike', 't_night', 's_safe', 's_cultur',\n    's_common', 's_env', 's_incl'\n]\n\n# Compute correlation matrix and round to 2 decimals\ncorr_matrix = df[loc_cols].corr().round(2)\n\n# Plot heatmap\nplt.figure(figsize=(12, 10))\nax = sns.heatmap(\n    corr_matrix,\n    annot=True,\n    cmap=custom_colors,\n    center=0,\n    fmt=\".2f\",\n    cbar_kws={'label': 'Correlation Strength'}\n)\nax.set_xticklabels([label_dict.get(x.get_text(), x.get_text()) for x in ax.get_xticklabels()], \n                  rotation=45, ha='right', fontsize=10)\nax.set_yticklabels([label_dict.get(y.get_text(), y.get_text()) for y in ax.get_yticklabels()], \n                  rotation=0, fontsize=10)\n\nplt.title('Correlation Between Housing Needs and Preferences', fontsize=14, pad=15, weight='bold' )\n\nsave_path = os.path.join(hf, \"Correlation Between Housing Needs and Preferences.png\")\nplt.savefig(save_path, dpi=300, bbox_inches=\"tight\")\n\nplt.tight_layout()\nplt.show()\n\n\n\nFigure XX. Correlation Between Housing Needs and Preferences\n\n","type":"content","url":"/notebooks/students-needs-and-preferences#general-statistics","position":23},{"hierarchy":{"lvl1":"Needs and Preferences","lvl2":"Statistics by Origin"},"type":"lvl2","url":"/notebooks/students-needs-and-preferences#statistics-by-origin","position":24},{"hierarchy":{"lvl1":"Needs and Preferences","lvl2":"Statistics by Origin"},"content":"In order to avoid generalising students, it is necessary to conduct a comparative analysis of students’ housing needs and preferences (Table XX) depending on their country of origin (German, EU, Non-EU) and identify both common patterns and structural differences between groups.\n\n# origin order and stats order\norigin_order = ['German', 'EU', 'Non-EU']\nstats_order = ['mean', 'std', 'min', 'median', 'max']\n\n# Prepare list to collect data rows (one row per Item per origin category)\nrows = []\n\n# Helper: function to calc stats on a Series or array\ndef calc_stats(series):\n    return {\n        'mean': round(series.mean(), 2),\n        'std': round(series.std(), 2), \n        'median': group_df.median().round(2)\n    }\n\nfor origin_cat in origin_order:\n    df_origin = df[df['origin'] == origin_cat]\n\n    # Individual items stats\n    for item in int_columns:\n        if item in df_origin.columns:\n            stats = calc_stats(df_origin[item].dropna())\n            stats['Item'] = item\n            stats['origin_cat'] = origin_cat\n            rows.append(stats)\n    \n    # Grouped features stats\n    for group_name, cols in group_columns.items():\n        group_avg = df_origin[cols].mean(axis=1, skipna=True)\n        stats = calc_stats(group_avg.dropna())\n        stats['Item'] = group_name\n        stats['origin_cat'] = origin_cat\n        rows.append(stats)\n\n# Create DataFrame\nsummary_df = pd.DataFrame(rows)\n\n# Pivot so origin categories are columns with subcolumns = stats\nstatictics_byorigin = summary_df.pivot(index='Item', columns='origin_cat')\n\n# Flatten MultiIndex columns to tuples for easier control (will be multi-level in output)\nstatictics_byorigin.columns.names = ['stat', 'origin_cat']\nstatictics_byorigin = statictics_byorigin.swaplevel(axis=1).sort_index(axis=1, level=0)  # origin_cat first, then stat\n\nstatictics_byorigin = statictics_byorigin.reindex(order)\n\nstatictics_byorigin.index = statictics_byorigin.index.to_series().replace(item_rename)\n\nstatictics_byorigin = statictics_byorigin.reindex(columns=origin_order, level=0)\n\nstatictics_byorigin\n\n\n\nTable XX. Student Needs and Preferences by Origin\n\nIn the Affordability section, the differences between the groups are relatively slight. For all categories of students, the affordability of rent is rated very highly (9), confirming the universal importance of the price factor. At the same time, students from the EU and especially non-EU countries rate the value for money of housing and the importance of hidden costs slightly higher, which may reflect their lower awareness of the local market and higher costs of searching for housing. In the aggregate indicator of affordability, it is foreign students who demonstrate the highest values, which emphasises their increased sensitivity to financial constraints.\n\nThe Location & Proximity section shows more noticeable differences. On average, non-EU students rate proximity to the university, the ring-bahn and, in particular, basic services higher than German students. This indicates that international students are more dependent on a compact and well-served urban environment where everyday functions are accessible without complicated navigation around the city. German students, on the other hand, give lower ratings for proximity, which may be due to their better knowledge of the city and greater willingness to make spatial compromises.\n\nThe differences are most noticeable in the Transportation category. Foreign students (EU and non-EU) rate the quality of public transport and night-time transport options significantly higher, while German students tend to value cycling infrastructure more. This reflects differences in mobility practices: for local students, bicycles are a familiar mode of transport, while international students rely more on public transport, especially at night.\n\nThe Social & Living Conditions section reveals the most contrasting results. Non-EU students rate the importance of neighbourhood safety significantly higher, indicating increased vulnerability and a need for a subjective sense of security in an unfamiliar urban environment. At the same time, foreign students rate access to cultural events, student communities and an international-friendly environment lower than German students, which may indicate structural barriers to integration and limited inclusion in local social networks. German students, on the other hand, rate their proximity to student communities and cultural life higher, reflecting their more stable position in the urban and academic environment.\n\nprice_order = ['German', 'EU', 'Non-EU']\n\n# Label mapping\nlabel_dict = {\n    'a_price': 'Monthly Rent Within Budget',\n    'a_cond': 'Price Matches Condition',\n    'a_hidd': 'Hidden Costs',\n    'l_uni': 'Proximity to University',\n    'l_ring': 'Proximity to Ring-Bahn',\n    'l_mensa': 'Proximity to Mensa',\n    'l_green': 'Proximity to Green Spaces',\n    'l_grocer': 'Proximity to Essential Services',\n    't_connect': 'Public Transport Quality',\n    't_bike': 'Bike Infrastructure',\n    't_night': 'Night Transport',\n    's_safe': 'Neighborhood Safety',\n    's_cultur': 'Cultural Access',\n    's_common': 'Student Communities',\n    's_env': 'Intl. Student-Friendly',\n    's_incl': 'Inclusivity'\n}\n\n# 6 most distinct pastel colors\ncolors = [ '#B9C0BA',\"#FFD7BA\", \"#FFB78F\"]\n\n\n# Metrics and labels\nmetrics = list(label_dict.keys())\nmetric_labels = list(label_dict.values())\n\n# Radar setup\nN = len(metrics)\nangles = np.linspace(0, 2 * pi, N, endpoint=False).tolist()\nangles += angles[:1]  # close the loop\n\n# Aggregate your data\nagg_df = df.groupby('origin')[metrics].mean().reset_index()\n\n# Setup figure\nfig = plt.figure(figsize=(11, 11))\nax = fig.add_subplot(111, polar=True)\nax.set_theta_offset(pi / 2)\nax.set_theta_direction(-1)\n\n# Draw labels and grid\nplt.xticks(angles[:-1], metric_labels, fontsize=8, rotation=0)\nax.tick_params(axis='x', pad=20)\nax.set_rlabel_position(0)\nplt.ylim(0, 10)\nplt.yticks([2, 4, 6, 8, 10], [\"2\", \"4\", \"6\", \"8\", \"10\"], color=\"grey\", size=8)\n\n# Plot each model\nfor idx, (_, row) in enumerate(agg_df.iterrows()):\n    values = row[metrics].tolist()\n    values += values[:1]  # loop\n    ax.plot(angles, values, color=colors[idx % len(colors)], linewidth=2, label=row['origin'])\n    ax.fill(angles, values, color=colors[idx % len(colors)], alpha=0.25)\n\n# Title and legend\nplt.title('Student Needs and Preferences by Origin', size=15, weight='bold' )\nlegend = plt.legend(price_order, loc='upper right', bbox_to_anchor=(1.4, 1.1), frameon=False)\n\nsave_path = os.path.join(hf, \"Student Needs and Preferences by Origin.png\")\nplt.savefig(save_path, dpi=300, bbox_inches=\"tight\")\n\nplt.tight_layout()\nplt.show()\n\n\n\nFigure XX. Student Needs and Preferences by Origin\n\nOverall, the results (Figure XX) show that students’ origins have a significant impact on the structure of their housing priorities. For international students, accessibility, transport and safety are key, while for German students, social and cultural aspects as well as alternative forms of mobility play a greater role. These differences highlight the need for a differentiated approach to analysing student housing capacity and confirm that a single ‘student’ model does not reflect the real diversity of user groups in the student housing market in Berlin.\n\ndf.to_excel(os.path.join(hf, \"user_data.xlsx\"), index=False)\n\n","type":"content","url":"/notebooks/students-needs-and-preferences#statistics-by-origin","position":25},{"hierarchy":{"lvl1":"4.3 Student Experiences"},"type":"lvl1","url":"/notebooks/students-experiences","position":0},{"hierarchy":{"lvl1":"4.3 Student Experiences"},"content":"import warnings\n\nwarnings.filterwarnings(\"ignore\")\n\nimport os\nhf = r'../outputs/4.3_students_experiences/'\nos.makedirs(hf, exist_ok=True)\n\n\n\n","type":"content","url":"/notebooks/students-experiences","position":1},{"hierarchy":{"lvl1":"4.3 Student Experiences"},"type":"lvl1","url":"/notebooks/students-experiences#id-4-3-student-experiences","position":2},{"hierarchy":{"lvl1":"4.3 Student Experiences"},"content":"\n\nThe student experience of finding accommodation clearly demonstrates the difficulties and problems faced by the most vulnerable groups during the ongoing housing crisis. In order to better understand the students, individual interviews were conducted, where open-ended questions were asked to guide the storytelling.\n\nThese problems and difficulties need to be analysed before proposing ways to resolve the student housing crisis, as they serve as barriers between student accommodation and users.\n\n","type":"content","url":"/notebooks/students-experiences#id-4-3-student-experiences","position":3},{"hierarchy":{"lvl1":"4.3 Student Experiences","lvl2":"Set Up"},"type":"lvl2","url":"/notebooks/students-experiences#set-up","position":4},{"hierarchy":{"lvl1":"4.3 Student Experiences","lvl2":"Set Up"},"content":"\n\nImport Libraries\n\nimport pandas as pd\nimport geopandas as gpd\nimport chardet\nimport gspread\nimport seaborn as sns\nimport matplotlib.pyplot as plt\nimport textwrap\nfrom pywaffle import Waffle\nimport numpy as np\nfrom matplotlib.patches import Patch\nfrom math import pi\n\n\n\nColors\n\nfrom matplotlib.colors import LinearSegmentedColormap\n\ncolors= [\"#FFE5D9\", \"#FFD7BA\", \"#FEC89A\", \"#FFB78F\", \"#F49F7D\", \"#F28B6D\", \"#E1755CFF\"]\n\n\n\nFont\n\nplt.rcParams[\"font.family\"] = \"Helvetica\"\n\n\n\nScripts\n\nimport pandas as pd          \nimport matplotlib.pyplot as plt  \n\ndef plot_pie_chart(column_name, title=None):\n    if column_name not in df.columns:\n        print(f\"Column '{column_name}' not found in DataFrame\")\n        return\n    \n    # Count values and prepare data\n    value_counts = df[column_name].value_counts()\n    total = value_counts.sum()\n    \n\n    # Custom function to show count and percentage\n    def make_autopct(values):\n        def my_autopct(pct):\n            count = int(round(pct * total / 100.0))\n            return f\"{pct:.1f}%\\n[{count}]\"\n        return my_autopct\n\n    # Create pie chart\n    plt.figure(figsize=(8, 8))\n    patches, texts, autotexts = plt.pie(\n        value_counts,\n        labels=value_counts.index,\n        colors=colors[:len(value_counts)],\n        autopct=make_autopct(value_counts),\n        startangle=90,\n        textprops={'fontsize': 12}\n    )\n    \n    # Equal aspect ratio ensures pie is drawn as circle\n    plt.axis('equal')  \n    \n    # Set title (use column name if no custom title provided)\n    if not title:\n        title = f\"Distribution of {column_name}\"\n    plt.title(title, fontsize=14, pad=20, weight='bold')\n    \n    # Improve label readability\n    plt.setp(texts, size=12)\n    plt.setp(autotexts, size=10, color='black')\n    \n    plt.tight_layout()\n\n    plt.savefig(os.path.join(hf, f\"{column_name}_pie_chart.png\"))\n\n    plt.show()\n\n\n\n\nimport pandas as pd          \nimport matplotlib.pyplot as plt  \n\ndef plot_bar_chart(column_name, title=None, rotate_labels=True):\n    if column_name not in df.columns:\n        print(f\"Column '{column_name}' not found in DataFrame\")\n        return\n\n    value_counts = df[column_name].value_counts()\n    total = value_counts.sum()\n\n    plt.figure(figsize=(10, 6))\n    bars = plt.bar(value_counts.index,\n                   value_counts.values,\n                   color=colors[:len(value_counts)])\n\n    # add 15 % breathing room above tallest bar\n    plt.ylim(0, value_counts.max() * 1.15)\n\n    # annotate bars\n    for bar, value in zip(bars, value_counts.values):\n        pct = 100 * value / total\n        plt.text(bar.get_x() + bar.get_width() / 2,\n                 bar.get_height() + value_counts.max() * 0.02,  # a little above the bar\n                 f\"{pct:.1f}%\\n[{value}]\",\n                 ha='center', va='bottom', fontsize=10)\n\n    if not title:\n        title = f\"Distribution of {column_name}\"\n    plt.title(title, fontsize=14, pad=15, weight='bold')\n    plt.ylabel(\"Count\")\n\n    if rotate_labels:\n        plt.xticks(rotation=45, ha='right')\n\n    plt.tight_layout()\n\n    # Save the figure\n    plt.savefig(os.path.join(hf, f\"{column_name}_bar_chart.png\"))\n\n    plt.show()\n\n\n\nData Import\n\nfp = r\"../inputs/4.3_students_experiences/user_data.xlsx\" \n\ndf = pd.read_excel(fp)\n\n\n\n","type":"content","url":"/notebooks/students-experiences#set-up","position":5},{"hierarchy":{"lvl1":"Difficulties and Problems"},"type":"lvl1","url":"/notebooks/students-experiences#difficulties-and-problems","position":6},{"hierarchy":{"lvl1":"Difficulties and Problems"},"content":"\n\n","type":"content","url":"/notebooks/students-experiences#difficulties-and-problems","position":7},{"hierarchy":{"lvl1":"Difficulties and Problems","lvl2":"Too Much Competition"},"type":"lvl2","url":"/notebooks/students-experiences#too-much-competition","position":8},{"hierarchy":{"lvl1":"Difficulties and Problems","lvl2":"Too Much Competition"},"content":"One of the most frequently mentioned problems when looking for accommodation is excessive competition, which permeates all segments of the student rental market. Virtually all respondents describe a situation in which the number of applicants significantly exceeds the available supply, especially in the budget segment. Even when actively submitting applications, students rarely receive responses, and scheduled viewings are often cancelled at the last minute. As one participant noted: The worse problem is competition. I wrote people and even arranged meetings, but they did not respond and cancelled meetings because they rented the place already to another person. In such a competitive environment, time becomes a critical factor — a delay of even a few hours can mean losing an opportunity: You had to apply very quickly, or you'd be too late.\n\n","type":"content","url":"/notebooks/students-experiences#too-much-competition","position":9},{"hierarchy":{"lvl1":"Difficulties and Problems","lvl2":"Stress"},"type":"lvl2","url":"/notebooks/students-experiences#stress","position":10},{"hierarchy":{"lvl1":"Difficulties and Problems","lvl2":"Stress"},"content":"Due to excessive competition, 55.3% of student housing users experience stress levels above 8 points. Similar to the high demand–capacity pressure indicators recorded in the spatial analysis, high stress levels reflect not only a structural shortage of student housing, but also a combination of related difficulties, including uncertainty, temporary solutions, and emotional costs associated with the housing search process.\n\nimport matplotlib.pyplot as plt\nimport pandas as pd\nimport numpy as np\n\nstress_levels = range(1, 11)\nvalue_counts = df['stress'].value_counts().reindex(stress_levels, fill_value=0)\ntotal = value_counts.sum()\n\ncolor = [\"#FFD7BA\"] * len(value_counts)\n\nplt.figure(figsize=(8, 6))\nbars = plt.barh(value_counts.index, \n                value_counts.values,\n                color=color)\n\n# Force y-axis to show all levels 1-10\nplt.yticks(stress_levels)\nplt.ylim(0.5, 10.5)  # Padding for better visibility\n\n# Add 15% breathing room on x-axis\nplt.xlim(0, value_counts.max() * 1.15)\n\n# Annotate bars (only if value > 0)\nfor bar, value in zip(bars, value_counts.values):\n    if value > 0:\n        pct = 100 * value / total\n        plt.text(bar.get_width() + value_counts.max() * 0.02,\n                 bar.get_y() + bar.get_height()/2,\n                 f\"{pct:.1f}%\\n[{value}]\", \n                 ha='left', va='center', fontsize=10)\n\n# Customize labels\nplt.title(\"Stress Levels During Housing Search\", \n          fontsize=14, pad=15, weight='bold')\nplt.xlabel(\"Number of Students\")\nplt.ylabel(\"Stress Level (1 = Low, 10 = High)\")\n\n# Add grid\nplt.grid(axis='x', linestyle='--', alpha=0.7)\n\nsave_path = os.path.join(hf, \"Stress Levels During Housing Search.png\")\nplt.savefig(save_path, dpi=300, bbox_inches=\"tight\")\n\nplt.tight_layout()\nplt.show()\n\n\n\nFigure XX. Stress Levels During Housing Search\n\nThe stress levels diagram (Figure XX) demonstrates differences and similarities in stress levels among students with different backgrounds when searching for accommodation. For German students, the median stress level is around 6 points, with a relatively wide range of responses, indicating a heterogeneous experience — from a relatively comfortable search to an extremely stressful one. At the same time, for students from EU and non-EU countries, the median values are significantly higher (around 8–9 points), and the upper quartiles in both cases reach the maximum value on the scale, indicating a systematically high level of stress.\n\nIt is particularly telling that the distributions for the EU and non-EU groups largely overlap: despite differences in legal status and access to resources, both groups face comparable levels of emotional stress.\n\n# Define expected categories (for ordering)\norign_categories = ['German', 'EU', 'Non-EU']\n\n# Create exploded version from origin column\nplot_df = df.explode('origin')[['origin', 'stress']].dropna()\n\n# Standardize any remaining values to 'Other'\nplot_df['origin'] = plot_df['origin'].apply(\n    lambda x: x if x in orign_categories else 'Other'\n)\n\n# Plot\nplt.figure(figsize=(10, 6))\nsns.boxplot(\n    data=plot_df,\n    x='origin',\n    y='stress',\n    order=orign_categories,\n    palette=colors,\n    showmeans=True,\n    meanprops={\n        'marker': 'o',\n        'markerfacecolor': 'white',\n        'markeredgecolor': 'black',\n        'markersize': '8'\n    }\n)\n\n# Formatting\nplt.title('Stress Levels During Housing Search by Origin', \n          fontsize=14, weight='bold', pad=20)\nplt.xticks(rotation=45, fontsize=11)\nplt.yticks(fontsize=11)\nplt.ylabel('Stress Level (1 = Low, 10 = High)', fontsize=12)\nplt.xlabel('Origin', fontsize=12)\nplt.grid(axis='y', linestyle='--', alpha=0.4)\nplt.tight_layout()\n\nsave_path = os.path.join(hf, \"Stress Levels During Housing Search by Origin.png\")\nplt.savefig(save_path, dpi=300, bbox_inches=\"tight\")\n\nplt.show()\n\n\n\nFigure XX. Stress Levels During Housing Search by Origin\n\nUncertainty, constant rejections and fear of being left homeless directly affect mental health and academic adaptation. One participant directly links the housing crisis to depression: It was kind of difficult and, to be honest, scary because of the new country.\n\nAnother student emphasises that the stress reached such a level that professional help was required: I was really very depressed, but I took therapy at the TU. Thus, housing instability becomes not a temporary difficulty, but a factor that directly affects the well-being and ability of students to study and integrate.\n\n","type":"content","url":"/notebooks/students-experiences#stress","position":11},{"hierarchy":{"lvl1":"Difficulties and Problems","lvl2":"Searching Time"},"type":"lvl2","url":"/notebooks/students-experiences#searching-time","position":12},{"hierarchy":{"lvl1":"Difficulties and Problems","lvl2":"Searching Time"},"content":"The distribution of searching time (Figure XX) demonstrates the high heterogeneity of student experiences and highlights the structural tension in the market. For the largest share of respondents, the search took between 1 and 3 months (35.0%), which indicates a relatively ‘standard’ scenario, requiring, nevertheless, significant time and emotional resources. Another 27.2% of students were able to find accommodation in less than a month, which is probably due to a combination of favorable market conditions and an increased budget.\n\nAt the same time, almost one in five students (21.4%) searched for accommodation for more than six months, and another 16.5% searched for 3 to 6 months. Taken together, this means that more than a third of respondents faced a protracted and problematic search that went beyond one semester. Such long search periods directly correlate with increased stress and housing instability and point to a systemic shortage of affordable and long-term student housing in Berlin, as well as a general lack of transparency in the search process.\n\nplot_pie_chart(\"term\", title=\"Searching Time Distribution\")\n\n\n\nFigure XX. Searching Time Distribution\n\n","type":"content","url":"/notebooks/students-experiences#searching-time","position":13},{"hierarchy":{"lvl1":"Difficulties and Problems","lvl2":"Applications Count"},"type":"lvl2","url":"/notebooks/students-experiences#applications-count","position":14},{"hierarchy":{"lvl1":"Difficulties and Problems","lvl2":"Applications Count"},"content":"\n\nThe application count distribution diagram (Figure XX) clearly reflects the scale of competition in the student housing market in Berlin and the efforts that students have to make in their search.\n\nThe largest group of respondents (35.9%) submitted between 1 and 5 applications, which is typically characteristic of students who managed to find accommodation relatively quickly — most often through acquaintances, university channels or state-run student halls of residence. Another 16.5% submitted between 6 and 15 applications, which may also indicate relatively favorable search conditions or a lucky coincidence in terms of timing and budget.\n\nAt the same time, almost half of the survey participants reported a significantly higher level of search effort. About 14.6% of students submitted 16–30 applications, and the same number submitted 31–50 applications. It is particularly noteworthy that 18.5% of respondents submitted more than 50 applications, including 10.7% who submitted more than 100 applications. These figures indicate a high degree of frustration, a prolonged search and a systemic shortage of available housing options.\n\nThus, the distribution of applications highlights the polarisation of the search experience: some students find accommodation relatively quickly, while for a significant proportion, the search becomes a protracted and time-consuming process. Combined with high levels of stress, this confirms the existence of a structural imbalance between supply and demand in the student housing market in Berlin.\n\nplot_pie_chart(\"applic_count\", title=\"Application Count Distribution\")\n\n\n\nFigure XX. Application Count Distribution\n\n","type":"content","url":"/notebooks/students-experiences#applications-count","position":15},{"hierarchy":{"lvl1":"Difficulties and Problems","lvl2":"Short Term Agreement"},"type":"lvl2","url":"/notebooks/students-experiences#short-term-agreement","position":16},{"hierarchy":{"lvl1":"Difficulties and Problems","lvl2":"Short Term Agreement"},"content":"Almost a quarter of students (24.3%) do not have a long-term rental contract for a period of one year or more throughout their studies (Figure XX). Given that the duration of studies can range from 2 to 6 years, this means that a significant proportion of students have to repeatedly search for accommodation, facing recurring stress, uncertainty, and additional financial costs.\n\nAgainst this backdrop, state-run student halls of residence remain the most stable and reliable landlords. They usually offer one-year contracts with the possibility of renewal, providing basic housing security and predictability of living conditions. However, the limited capacity of such accommodations significantly reduces their systemic role and does not compensate for the instability characteristic of the private segment of the student housing market.\n\nplot_pie_chart(\"longtermagree\", title=\"Long Term Agreement Distribution\") \n\n\n\nFigure XX. Long Term Agreement Distribution\n\n","type":"content","url":"/notebooks/students-experiences#short-term-agreement","position":17},{"hierarchy":{"lvl1":"Difficulties and Problems","lvl2":"No Anmeldung"},"type":"lvl2","url":"/notebooks/students-experiences#no-anmeldung","position":18},{"hierarchy":{"lvl1":"Difficulties and Problems","lvl2":"No Anmeldung"},"content":"The lack of a long-term rental agreement is directly linked to the issue of registering at the place of residence (Anmeldung), which, in turn, is a mandatory condition for extending visas and residence permits in Germany. Several survey participants who did not have a long-term contract indicated that they had to pay extra to register their residence or register at the address of acquaintances, which indicates the prevalence of informal and legally vulnerable practices in the student housing market.\n\nIn addition, the absence of a long-term contract often indicates subletting or re-renting from previous tenants. This practice is usually accompanied by higher rents and, at the same time, deprives students of the right to official registration. This creates a vicious circle of housing instability, in which short-term rentals increase financial pressure, legal insecurity and administrative risks, especially for international students.\n\nНSeveral participants indicated that the possibility of registration was promised before signing the contract, but later turned out to be impossible due to illegal subletting. This creates serious legal and administrative risks: Before signing the contract, I was told that Anmeldung would be possible, and afterwards the landlord told us that it isn't. In one interview, the situation is described as a vicious circle: You need papers to get an Anmeldung, and you need an Anmeldung before you can apply for your residence permit.\n\nMany students are forced to live without official registration or use old addresses, which creates a chain of further problems — from renewing their residence permits to accessing public services. Anmeldung is transformed from a basic administrative procedure into a tool of pressure and control by landlords.\n\n","type":"content","url":"/notebooks/students-experiences#no-anmeldung","position":19},{"hierarchy":{"lvl1":"Difficulties and Problems","lvl2":"Hidden Costs"},"type":"lvl2","url":"/notebooks/students-experiences#hidden-costs","position":20},{"hierarchy":{"lvl1":"Difficulties and Problems","lvl2":"Hidden Costs"},"content":"In addition to high rents, students regularly encounter hidden and non-transparent costs that significantly increase the actual cost of living and make housing less affordable than advertised. These costs include high deposits, additional payments for utilities, furniture, and internet, as well as administrative fees and agency services.\n\nThe search for housing takes place in parallel with the start of studies, adaptation to a new country and, in some cases, a lack of social and financial support. One respondent sums up the general mood as follows: The entire system is screwed. Students who don't have financial support from their families have it especially rough.\n\n","type":"content","url":"/notebooks/students-experiences#hidden-costs","position":21},{"hierarchy":{"lvl1":"Difficulties and Problems","lvl2":"Scams"},"type":"lvl2","url":"/notebooks/students-experiences#scams","position":22},{"hierarchy":{"lvl1":"Difficulties and Problems","lvl2":"Scams"},"content":"Housing shortages and high competition make students particularly vulnerable to fraud in the rental market. Interviews show that some respondents lost significant amounts of money due to fake advertisements, fictitious landlords, or requests to transfer a deposit before viewing the property.\n\nOne of the most dangerous and financially painful types of fraud in the rental market involves fake offers and advance deposit payments, where the victim is told that a flat has been found and that a deposit (Kaution) must be transferred before meeting or signing the contract. This happened to one participant in the study, who noted: That's how 300 other people lost 2000 euros of deposit... The scheme involves the prospective tenant transferring a significant amount of money as a deposit or advance payment, waiting for the keys and confirmation of the transaction, but after the transfer, contact with the ‘landlord’ is lost and they disappear. This is a typical sign of a rental scam — the scammer creates the appearance of legitimacy, but has no right to rent out the property, and the transferred funds become non-refundable.\n\nWhen time is short and there aren’t many options, students often have to make quick decisions, which makes it harder for them to think critically about the risks. International students who are outside Germany or aren’t familiar with local laws and market conditions are especially vulnerable. The fear of being left without accommodation leads to unsafe decisions, including temporary accommodation without a contract or in illegal conditions. In this context, fraud is not a separate problem, but a direct consequence of the structural crisis in student housing, in which the shortage and asymmetry of information systematically work against students.\n\n","type":"content","url":"/notebooks/students-experiences#scams","position":23},{"hierarchy":{"lvl1":"Difficulties and Problems","lvl2":"Discrimination"},"type":"lvl2","url":"/notebooks/students-experiences#discrimination","position":24},{"hierarchy":{"lvl1":"Difficulties and Problems","lvl2":"Discrimination"},"content":"Although more than half of respondents formally stated that they had not encountered direct discrimination (Figure XX), qualitative interviews show that discrimination often takes hidden and institutionalised forms. The most common practices are ignoring applications, failing to respond, and rejecting applications without explanation. One student emphasises: Haven't encountered direct discrimination, rather landlords ignore applications. Such “invisible discrimination” is particularly characteristic of an overheated market, where refusal does not require justification but systematically affects students, foreigners and people with diverse social profiles.\n\n# Dedisce discancing categories\ndisc_categories = ['Nationality', 'Language', 'Gender', 'Economic', 'Sexual Orientation']\n\ncolors = [\"#FFE5D9\", \"#FFD7BA\", \"#FEC89A\", \"#FFB78F\", \"#F49F7D\", \"#F28B6D\", \"#E1755CFF\"]\n\n# Create an empty counter\ndisc_counts = {cat: 0 for cat in disc_categories}\ndisc_counts['Didn\\'t face Discrimination'] = 0\n\n# Count occurrences (handling multiple answers per student)\nfor entry in df['discrimination_e'].dropna():\n    # Convert to lowercase and split multiple answers\n    entries = [e.strip().lower() for e in str(entry).split(',')]\n    matched = False\n    for cat in disc_categories:\n        if any(cat.lower() in e for e in entries):\n            disc_counts[cat] += 1\n            matched = True\n    if not matched and entries:  # Only count as 'Other' if non-empty\n        disc_counts['Didn\\'t face Discrimination'] += 1\n\n# Convert to DataFrame for plotting\ndisc_df = pd.DataFrame(list(disc_counts.items()), columns=['Source', 'Count'])\n\n# Dedisce autopct function with access to counts\ndef make_autopct(values):\n    total = sum(values)\n    def my_autopct(pct):\n        count = int(round(pct * total / 100.0))\n        return f\"{pct:.1f}%\\n[{count}]\"\n    return my_autopct\n\n# Plot pie chart\nplt.figure(figsize=(10, 8))\nplt.pie(disc_df['Count'], \n        labels=disc_df['Source'], \n        autopct=make_autopct(disc_df['Count']),\n        startangle=120, \n        colors=colors[:len(disc_counts)],\n        textprops={'fontsize': 12})\nplt.title('Discrimination Factors Distribution', \n          fontsize=14, weight='bold', pad=20)\nplt.axis('equal')\n\nsave_path = os.path.join(hf, \"Discrimination Factors Distribution.png\")\nplt.savefig(save_path, dpi=300, bbox_inches=\"tight\")\n\nplt.tight_layout()\nplt.show()\n\n\n\nFigure XX. Discrimination Factors Distribution\n\nDiscrimination is most evident on the basis of nationality and origin, as confirmed by both quantitative data and interviews. Some respondents encountered outright refusals related to their citizenship or name: I don't get a lot of replies to be honest, I’m assuming that the reason behind it may be me being a student and my non-German name, while another participant notes: Actually, you can really see how important a German surname can sometimes be when competing for accommodation. In some cases, discrimination is explicit, such as refusing to accept students of a certain nationality: Due to today’s situation, the landlord decided not take Russian students. These examples highlight the vulnerability of international students in the absence of transparent control mechanisms.\n\nFinancial discrimination is another key barrier and is closely linked to student status. Many landlords and housing companies require proof of income at a level that is unaffordable for most students: Many housing companies require proof of income and require you to make at least three times the monthly rent, which is entirely unattainable for most students. As a result, housing is effectively reserved for working professionals, while students are systematically excluded from the market: Apartments only for people with work contracts. This is particularly painful for foreign students who cannot provide German guarantors or credit history (Schufa).\n\nA separate and particularly vulnerable group are students who face discrimination on the basis of gender, family status and queer identity. One interviewee describes being denied a rental because of their ‘non-traditional’ family configuration: Another agent denied our application because we are an alternative family configuration and not a straight couple. Others mention advertisements with strict restrictions: Women only, no LGBT, which directly excludes certain groups from the housing market. The inevitable consequence of such discrimination is a retreat into the grey area of renting, accompanied by risks and exploitation: I had to live in flats without contracts, hiding from the Hausverwaltung, creating a very stressful power struggle.\n\nTaken together, this evidence shows that discrimination in the student housing sector is rarely an isolated or purely interpersonal phenomenon. Rather, it is embedded in the structure of a market where competition, scarcity and excessive requirements legitimise the exclusion of students, particularly international and socially vulnerable groups.\n\n","type":"content","url":"/notebooks/students-experiences#discrimination","position":25},{"hierarchy":{"lvl1":"Key Findings"},"type":"lvl1","url":"/notebooks/students-experiences#key-findings","position":26},{"hierarchy":{"lvl1":"Key Findings"},"content":"\n\nThe housing crisis in Berlin has a systemic and multi-level impact on students’ lives, significantly limiting their choices and undermining their sense of stability. High prices and intense competition dramatically narrow the range of available options, making even minimally acceptable housing difficult to obtain. Many students note that there are virtually no affordable options on the market that are specifically tailored to their needs: nothing affordable for students or fewer flats, more competition. In this situation, housing ceases to be a matter of preference and becomes a matter of survival.\n\nAs a result, students are forced to lower their expectations and settle for inadequate or temporary solutions. Some remain in dormitories with outdated facilities and a lack of privacy, as alternatives are financially unattainable: I’m stuck with my affordable dormitory option with older amenities and a lack of privacy. Others consider moving to neighbouring cities or the suburbs, which increases the time and cost of daily commutes: Flats are expensive and/or in districts not suitable for my daily living. Thus, the crisis directly affects students’ spatial mobility and their daily organisation of life.\n\nThe crisis has a particularly acute impact on students’ psychological and emotional state. The search for housing is described as an exhausting and demanding process that takes priority over studying and social life. Respondents emphasise that they had to spend several hours a day exclusively on searching, often without any results: It was very stressful and time-consuming. I couldn't do much else besides search for an apartment. For some, this situation becomes almost unbearable: Not yet, but soon it will break me, which indicates the risk of long-term emotional exhaustion.\n\nOverall, the results show that the housing crisis creates an atmosphere of constant instability and forced gratitude for minimally acceptable conditions. Even those students who have managed to find accommodation realise that they were simply lucky, rather than that the system works effectively: I was lucky, but just a couple of months later it was almost impossible to find a room. Awareness of the shortage and lack of alternatives forces students to give up actively searching in advance and rely entirely on student dormitories as the only realistic option. This highlights the structural nature of the crisis and its long-term consequences for the student population, especially those who do not have financial support or social connections.","type":"content","url":"/notebooks/students-experiences#key-findings","position":27},{"hierarchy":{"lvl1":"5.1 Conclusion"},"type":"lvl1","url":"/notebooks/conclusion","position":0},{"hierarchy":{"lvl1":"5.1 Conclusion"},"content":"I attempted to combine spatial, quantitative, and qualitative aspects to rethink the student housing crisis in Berlin and came up with the following conclusions:\n\nPublic student accommodations are more evenly distributed across the periphery, reflecting their role as affordable, welfare-oriented infrastructure. Private facilities are more concentrated in central areas and high-demand areas, particularly in Mitte, Friedrichshain-Kreuzberg and Charlottenburg-Wilmersdorf, reflecting market logic that prioritises profitable locations with high rents over equal access.\n\nEast Berlin shows a high concentration of large student complexes and compact clusters. Western Berlin, on the other hand, is characterised by a predominance of stable areas with low capacity and a shortage of supply.\n\nPrivate universities are mainly concentrated in Mitte, Charlottenburg-Wilmersdorf and Friedrichshain-Kreuzberg – areas that are already characterised by high demand for housing – while public universities occupy both central areas and more peripheral areas such as Lichtenberg, Steglitz-Zehlendorf and Treptow-Köpenick.\n\nUniversities with high numbers of international students are not grouped geographically, but rather distributed in a fragmented manner and often separated from similar neighbors. The West Berlin traditionally concentrates international academic demand, while the East remains unattractive in an international context.\n\nIn the vast majority of university market areas, university international demand significantly exceeds available student accommodation capacity.\n\nMarket pressure is not generated by individual market areas, but by the overlap of multiple accessibility zones, which explains why it is the concentration of university functions — and not just the local shortage of student accommodation.\n\nBerlin have pronounced polycentricity of educational space: central locations at the highest levels concentrate the greatest student demand and form the main clusters of attraction, while lower-level zones perform supporting functions. At the same time, demand significantly exceeds supply at all levels. Thus, the analysis shows that the student housing crisis in Berlin has a clearly defined spatial structure.\n\nStudent accommodation in Berlin serves a wider range of educational tracks. A significant proportion of users university students, including preparatory undergraduates, college students, postgraduates, exchange students, interns, young research workers and teaching staff.\n\nThe affordability of rent is highly rated, reflecting students’ adaptation to financial constraints or forced compromises when choosing accommodation. The location and proximity to universities reflecting the spatial gap between places of study and actual areas of residence for students. In other words students priorities affordability over proximity to university.\n\nThe housing crisis in Berlin has a systemic and multi-level impact on students’ lives, significantly limiting their choices and undermining their sense of stability. High prices and intense competition dramatically narrow the range of available options, making even minimally acceptable housing difficult to obtain. The crisis has a particularly acute impact on students’ psychological and emotional state. The search for housing is described as an exhausting and demanding process that takes priority over studying and social life. The housing crisis creates an atmosphere of constant instability and forced gratitude for minimally acceptable conditions.\n\nIn a broader context, these findings imply that the student housing crisis in Berlin is not a temporary market failure or the result of individual student decisions. Rather, it is the result of institutional and political priorities that have placed social student housing secondary to the investment logic of urban development. The spatial structure of the crisis points to a systemic mismatch between education policy, migration dynamics and urban housing planning.\n\nThe polycentric structure of Berlin’s educational space, with demand concentrated in central areas and insufficient supply of affordable housing at all levels, demonstrates a lack of coordinated policy between universities, senates and housing operators. Universities continue to increase their international student enrolment without accompanying this growth with an equivalent expansion of public housing infrastructure. As a result, responsibility for student accommodation is effectively shifted to the private market, which operates on the logic of profit maximisation rather than equal access.\n\nParticularly problematic is the fact that purpose-built student accommodation, despite being formally positioned as a solution to the crisis, reinforces social selection and spatial inequality. The concentration of private halls of residence in central and prestigious areas does not reduce overall market pressure but, on the contrary, contributes to rising rents and the displacement of socially vulnerable groups. Thus, private purpose-built student accommodation functions more as an investment asset than as an element of social housing policy, which contradicts Berlin’s stated goals of providing affordable housing.\n\nAt the city policy level, this points to the need to rethink the role of student housing as critical social infrastructure rather than a niche segment of the real estate market. The research data shows that without active public sector involvement — through the expansion of state-owned student housing, regulation of private operators, and the integration of housing into educational and spatial planning — the crisis will continue and deepen. This particularly affects international students, for whom the lack of stable housing is directly linked to their legal status, access to registration and the ability to participate fully in city life.\n\nIn a political sense, the student housing crisis is becoming an indicator of a broader problem—the crisis of accessibility in the city as such. Limited choices, the normalisation of temporary and unstable forms of housing, increased psychological stress, and forced gratitude for minimally acceptable conditions all point to the gradual loss of the city as an inclusive space. This calls into question the implementation of the Right to the City principle and requires a shift from reactive measures to a long-term, structural strategy in which students are seen not as temporary users of the city, but as its rightful residents.","type":"content","url":"/notebooks/conclusion","position":1},{"hierarchy":{"lvl1":"5.2 Reflection"},"type":"lvl1","url":"/notebooks/discussion","position":0},{"hierarchy":{"lvl1":"5.2 Reflection"},"content":"Theoretical Reflection\n\nMethodological Reflection\nНесмотря на использование в различных главах работы нескольких исследовательских методов, ключевым методологическим инструментом данного исследования является пространственный анализ. В отличие от исключительно количественных или качественных подходов, пространственный анализ позволяет ответить не только на вопросы что, почему и как, но также принципиально важный для urban planning вопрос — где формируются и проявляются структурные дисбалансы студенческого жилищного рынка.\n\nВ процессе подготовки дипломной работы было применено более десяти различных техник пространственного анализа. Однако не все из них продемонстрировали статистически значимые различия или привели к принципиально новым интерпретациям. Так, в рамках исследования была разработана gravity model с использованием математических методов и элементов машинного обучения, однако полученные результаты в значительной степени воспроизвели пространственные оси городского развития, ранее выявленные с помощью Central Place Analysis. Это подтвердило устойчивость выявленных пространственных закономерностей, но также обосновало выбор в пользу менее сложных и более интерпретируемых аналитических инструментов.\n\nПринципиальным методологическим решением стало использование автоматизированных процедур анализа на основе языка программирования Python, а также сознательное ограничение исследования двумя ключевыми наборами геоданных — student accommodation capacity и higher education universities students demand. Такой подход обеспечил воспроизводимость исследования: при наличии аналогичных данных методология может быть повторно применена как в Берлине через 3–5 лет для анализа динамики рынка, так и в других крупных городах.\n\nВ ходе работы входные данные неоднократно дополнялись и уточнялись, что приводило к изменению промежуточных и итоговых результатов. Использование программируемых аналитических процессов позволило оперативно обновлять расчёты и визуализации. В отсутствие автоматизации каждая новая запись потребовала бы повторения значительного объёма ручных операций в геоинформационных системах, таких как QGIS или ArcGIS, что существенно увеличило бы риск ошибок и снизило воспроизводимость анализа.\n\nСледует также отметить, что в классическом пространственном анализе, как правило, используется более двух наборов геоданных. Для формирования более комплексной картины целесообразным было бы сопоставление полученных результатов с данными о транспортной доступности, плотности населения, характере застройки и другими пространственными показателями. Однако включение подобных сравнений выходит за рамки научных целей, сформулированных в начале исследования, и потому осознанно не было реализовано в рамках данной работы.\n\nДополнительно следует подчеркнуть, что сознательное ограничение количества входных данных было методологическим решением, а не упущением. Фокус на двух ключевых наборах геоданных — student accommodation capacity и higher education universities students demand — позволил избежать избыточной сложности модели и сохранить интерпретируемость результатов. В условиях высокой неоднородности данных и отсутствия единых стандартов учёта студенческого жилья в Берлине, включение дополнительных слоёв могло бы усилить шум и затруднить выявление структурных закономерностей.\n\nИспользование смешанного подхода, сочетающего количественный пространственный анализ с качественными методами (опросы и интервью), позволило компенсировать ограничения каждого из методов по отдельности. Пространственный анализ выявил зоны повышенного рыночного давления и структурные дисбалансы между спросом и предложением, в то время как качественные данные позволили интерпретировать эти паттерны через опыт студентов, их повседневные практики и стратегии адаптации к кризису. Таким образом, методология исследования выходит за рамки чисто описательного картографирования и направлена на выявление социально-пространственных последствий жилищного кризиса.\n\nПри этом необходимо отметить, что результаты пространственного анализа в значительной степени зависят от качества и полноты исходных данных. В частности, данные о вместимости студенческих общежитий и численности студентов по университетам являются агрегированными и не учитывают такие факторы, как реальная текучесть мест, краткосрочная аренда, неформальные формы проживания и нелегальные субаренды. Эти формы жилья, как показало качественное исследование, играют значительную роль в реальном жилищном опыте студентов, однако остаются «невидимыми» в официальной статистике.\n\nНаконец, методологический подход данной работы следует рассматривать как основу для дальнейших исследований, а не как завершённую модель. В будущем пространственный анализ может быть расширен за счёт включения транспортной доступности, временных затрат на дорогу, ценовых градиентов аренды, а также нормативно-правовых ограничений. Тем не менее, даже в рамках выбранных ограничений, исследование демонстрирует, что сочетание воспроизводимых, автоматизированных пространственных методов с социально ориентированным анализом позволяет не только диагностировать кризис студенческого жилья, но и заложить основу для обоснованных политических и планировочных решений.\n\nEmpirical Reflection\n\nhere will be the discussion that take place in Milano about capaciyty and demand what form it, how we can influence it, which solutions we have","type":"content","url":"/notebooks/discussion","position":1},{"hierarchy":{"lvl1":"5.3 Future Research"},"type":"lvl1","url":"/notebooks/future-research","position":0},{"hierarchy":{"lvl1":"5.3 Future Research"},"content":"here will be future actions and collaborations that can take place","type":"content","url":"/notebooks/future-research","position":1},{"hierarchy":{"lvl1":"6.1 References"},"type":"lvl1","url":"/notebooks/references","position":0},{"hierarchy":{"lvl1":"6.1 References"},"content":"","type":"content","url":"/notebooks/references","position":1},{"hierarchy":{"lvl1":"6.1 References","lvl2":"Literature Reserch"},"type":"lvl2","url":"/notebooks/references#literature-reserch","position":2},{"hierarchy":{"lvl1":"6.1 References","lvl2":"Literature Reserch"},"content":"\n\nAalbers, M.B. and Christophers, B., 2014. Centring Housing in Political Economy. Housing, Theory and Society, 31(4), pp. 373–394. \n\nAalbers & Christophers (2014)\n\nAaron, L., 2024. Digital Arrival Infrastructures: Housing Platforms and Residency Governance in Berlin’s Rental Sector. UP, 9(8480). \n\nAaron (2024)\n\nAhlfeldt, G.M., Maennig, W. and Richter, F.J., 2017. Urban renewal after the Berlin Wall: a place-based policy evaluation. Journal of Economic Geography, 17(1), pp. 129–156. \n\nAhlfeldt et al. (2016)\n\nAnna Granath Hansson, 2018. Combatting the housing shortage through institutional reform: The parallel cases of Germany and Sweden. Zeitschrift für Geodäsie, Geoinformation und Landmanagement, 2(1), pp. 93–99.\n\nAttia, S., Alphonsine, P., Amer, M. and Ruellan, G., 2020. Towards a European rating system for sustainable student housing: Key performance indicators (KPIs) and a multi-criteria assessment approach. Environmental and Sustainability Indicators, 7(100052). \n\nAttia et al. (2020)\n\nAvogo, F.A., Appau, W.M. and Attakora-Amaniampong, E., 2022. The effects of word-of-mouth and online review marketing strategies on students’ satisfaction with their housing selection during COVID-19 season. F, 40(2), pp. 394–411. \n\nAvogo et al. (2022)\n\nBellini, O.E., Gullace, M.T. and Mocchi, M., 2022. Re-Start: Student Housing Polycrisis post-Coronavirus. Techne, pp. 94–103. \n\nBellini et al. (2022)\n\nBernt, M., 2022. The Commodification Gap: Gentrification and Public Policy in London, Berlin and St Petersburg. 1st ed. Wiley.\n\nBernt, M., Grell, B. and Holm, A. (Eds.), 2013. The Berlin Reader: A Compendium on Urban Change and Activism. transcript Verlag.\n\nCBRE GmbH, 2025. Housing Market Report Berlin 2024. Berlin.\n\nDeutsches Studierendenwerk e. V., 2024. Wohnraum für Studierende: Statistische Übersicht 2024. Berlin.\n\nDiehl, C., Andorfer, V.A., Khoudja, Y., Krause, K., 2013. Not In My Kitchen? Ethnic Discrimination and Discrimination Intentions in Shared Housing among University Students in Germany. Journal of Ethnic and Migration Studies, 39(10), pp. 1679–1697. \n\nDiehl et al. (2013)\n\nDuso, T., Michelsen, C., Schaefer, M. and Tran, K.D., 2024. Airbnb and rental markets: Evidence from Berlin. Regional Science and Urban Economics, 106(104007). \n\nDuso et al. (2024)\n\nESN, ESU, Contributors: Sara Tagliabracci, Lina Mohoric, Pedro Gonzalez, Rita Dias, 2023. International Student Housing: How Are Exchange Students in Europe Navigating the Housing Crisis? European Students’ Union (ESU), Erasmus Student Network (ESN).\n\nFields, D. and Uffer, S., 2016. The financialisation of rental housing: A comparative analysis of New York City and Berlin. Urban Studies, 53(10), pp. 1486–1502. \n\nhttps://​doi​.org​/10​.1177​/0042098014543704\n\nFranz, Y. and Gruber, E., 2022. The Changing Role of Student Housing as Social Infrastructure. UP, 7(4). \n\nFranz & Gruber (2022)\n\nFrederike Gerdes and Martina Kroher, 2024. Studying and Living on Your Own: Possible But not Affordable? The Current State of Student Housing in Germany. Autonomie locali e servizi sociali, pp. 371–404. \n\nundefined & undefined (2024)\n\nFrench, N., Bhat, G., Matharu, G., Guimarães, F.O. and Solomon, D., 2018. Investment opportunities for student housing in Europe. Journal of Property Investment & Finance, 36(5), pp. 578–584. \n\nFrench et al. (2018)\n\nGranath Hansson, A., 2019. City strategies for affordable housing: the approaches of Berlin, Hamburg, Stockholm, and Gothenburg. International Journal of Housing Policy, 19(1), pp. 95–119. \n\nGranath Hansson (2017)\n\nGwosc, C., 2024. Students’ housing situation, in: Social and Economic Conditions of Student Life in Europe: Eurostudent 8 Synopsis of Indicators 2021-2024. wbv Media GmbH & Co. KG.\n\nHahn, A.M., Kholodilin, K.A., Waltl, S.R. and Fongoni, M., 2024. Forward to the Past: Short-Term Effects of the Rent Freeze in Berlin. Management Science, 70(6), pp. 1901–1923. \n\nHahn et al. (2024)\n\nHauschildt, K., 2024. Policy considerations, in: Social and Economic Conditions of Student Life in Europe: Eurostudent 8 Synopsis of Indicators 2021-2024. wbv Media GmbH & Co. KG.\n\nHauschildt, K., Gwosc, C., Schirmer, H., Mandl, S. and Menz, C., 2024. Social and Economic Conditions of Student Life in Europe: Eurostudent 8 Synopsis of Indicators 2021-2024. wbv Publikation, Bielefeld.\n\nHeeg, S., 2022. Finanzinvestoren auf dem deutschen Wohnungsmarkt. WSI, 75(3), pp. 197–204. \n\nHEEG (2022)\n\nHofstede, H., 2024. “Making sense of rural identities in future horizons of Dutch and German students living in rural areas.” Journal of Rural Studies, 107(103219). \n\nHofstede (2024)\n\nHolm, Andrej, Gerhardt, Sebastian, Scheller, David and Gastaminza Vacas, Itziar, 2024. Keine Profite mit der Miete: Strategien für eine bestandssichernde, nachhaltige und soziale Bewirtschaftung großer Wohnungsbestände. 2nd ed. Studien. Rosa-Luxemburg-Stiftung, Berlin.\n\nIglesias, M., Huesca, L. and Lozada, K., 2024. Focusing on academic tourism: demographics, behaviours and impacts. fg, 23(1), pp. 117–131. \n\nIglesias et al. (2024)\n\nInvestitionsbank Berlin, 2024. IBB Wohnungsmarktbericht 2024: Schwerpunktthema – Wohnbedarfe und Verteilung von Wohnraum auf dem Berliner Wohnungsmarkt, Berliner Wohnungsmarktbericht. Berlin.\n\nLehner, M., Richter, J.L., Kreinin, H., Mamut, P., Vadovics, E., Henman, J., Mont, O. and Fuchs, D., 2024. Living smaller: acceptance, effects and structural factors in the EU. B&C, 5(438). \n\nLehner et al. (2024)\n\nLindenthal, T. and Eichholtz, P., 2012. Prolonged Crisis: Housing in Germany and Berlin, in: Bardhan, A., Edelstein, R.H., Kroll, C.A. (Eds.), Global Housing Markets. Wiley, pp. 69–99.\n\nLisa von Witten Sonsfeld and Elisabeth Beusker, 2023. The future development of student housing in Germany by the example of the city Aachen.\n\nMiessner, M., 2021. Studentification in Germany: How investors generate profits from student tenants in Goettingen and the impacts on urban segregation. European Urban and Regional Studies, 28(1), pp. 133–154. \n\nMiessner (2020)\n\nMitze, T., Burgard, C. and Alecke, B., 2015. The tuition fee ‘shock’: Analysing the response of first-year students to a spatially discontinuous policy change in Germany. Papers in Regional Science, 94(3), pp. 385–420. \n\nMitze et al. (2015)\n\nMLP Finanzberatung SE, 2024. MLP Studentenwohnreport 2024. Institut der deutschen Wirtschaft, Wiesloch.\n\nÖzkan, D. and Büyüksaraç, G.B. (Eds.), 2020. Contradictions of housing commons Between middle-class and anarchist models in Berlin, in: Commoning the City: Empirical Perspectives on Urban Ecology, Economics and Ethics, Space, Materiality and the Normative. Routledge, Taylor & Francis Group, Abingdon, Oxon New York, NY.\n\nPiekut, M., 2024. Housing conditions in European one-person households. PLoS ONE, 19(3), p. e0303295. \n\nPiekut (2024)\n\nPreetz, R., Greifenberg, J., Hülsemann, J. and Filser, A., 2022. Moving Back to the Parental Home in Times of COVID-19: Consequences for Students’ Life Satisfaction. International Journal of Environmental Research and Public Health, 19(17), p. 10659. \n\nPreetz et al. (2022)\n\nSage, J., Smith, D. and Hubbard, P., 2013. New-build Studentification: A Panacea for Balanced Communities? Urban Studies, 50(12), pp. 2623–2641. \n\nSage et al. (2013)\n\nSchwittay, A., 2025. Students take over: prefiguring urban commons in student housing co-operatives. Housing Studies, 40(7), pp. 966–987. \n\nSchwittay (2024)\n\nSmith, D., 2018. The Politics of Studentification and `(Un)balanced’ Urban Populations: Lessons for Gentrification and Sustainable Communities? Urban Studies, 45(12), pp. 2541–2564. \n\nSmith (2008)\n\nSteinführer, A. and Haase, A., 2019. Flexible–inflexible: socio-demographic, spatial and temporal dimensions of flat sharing in Leipzig (Germany). GeoJournal, 74(7), pp. 567–587. \n\nSteinführer & Haase (2009)\n\nStoll, N., 2022. Vergesellschaftung als Transformationsstrategie: „Deutsche Wohnen & Co. enteignen“ im diskursiven und politischen Kontext. PROKLA, 52(209), pp. 631–648. \n\nStoll (2022)\n\nTwan Dimmendaal, 2022. Afraid of becoming homeless; the effects of a housing crisis on international students.\n\nVollmer, L. and Gutiérrez, D., 2022. Organizing for expropriation: How a tenants campaign convinced Berliners to vote for expropriating big landlords. RHJ, 4(1), pp. 47–66. \n\nVollmer & Gutiérrez (2022)\n\nVon Wittenhorst Zu Sonsfeld, L. and Beusker, E., 2024. An examination of the needs and preferences for student housing in Germany in relation to different financial backgrounds using the example of the city of Aachen. Journal of European Real Estate Research, 17(2), pp. 286–308. \n\nvon Wittenhorst zu Sonsfeld & Beusker (2024)\n\nWijburg, G. and Aalbers, M.B., 2017. The alternative financialization of the German housing market. Housing Studies, 32(6), pp. 968–989. \n\nWijburg & Aalbers (2017)\n\nWijburg, G., Aalbers, M.B. and Heeg, S., 2018. The Financialisation of Rental Housing 2.0: Releasing Housing into the Privatised Mainstream of Capital Accumulation. Antipode, 50(4), pp. 1098–1119. \n\nWijburg et al. (2018)\n\nWittowsky, D., Hoekveld, J., Welsch, J. and Steier, M., 2020. Residential housing prices: impact of housing characteristics, accessibility and neighbouring apartments – a case study of Dortmund, Germany. Urban, Planning and Transport Research, 8(1), pp. 44–70. \n\nWittowsky et al. (2020)\n\nWolter, F., Raviv, O.C. and Mertens, M., 2023. Discriminatory Residential Preferences in Germany—A Vignette Study. Köln Z Soziol, 75(2), pp. 263–288. \n\nWolter et al. (2023)\n\nZunder, T.H., Aditjandra, P.T., Schoemaker, J.T., Vaghi, C., Laparidou, K. and Österle, I., 2014. Engaging city stakeholders to achieve efficient and environmentally friendly urban freight movements. \n\nZunder et al. (2014)\n\n","type":"content","url":"/notebooks/references#literature-reserch","position":3},{"hierarchy":{"lvl1":"6.1 References","lvl2":"Master Thisis"},"type":"lvl2","url":"/notebooks/references#master-thisis","position":4},{"hierarchy":{"lvl1":"6.1 References","lvl2":"Master Thisis"},"content":"\n\n\n\n\n\n\n\n# with open(\"../references/literature_review.bib\", \"r\", encoding=\"utf-8\") as f:\n#     bib_text = f.read()\n\n# print(bib_text) \n\n\n\n ```{../references/literature_review}``` ","type":"content","url":"/notebooks/references#master-thisis","position":5},{"hierarchy":{"lvl1":"Colour Palettes Design"},"type":"lvl1","url":"/notebooks/xx-color-palettes","position":0},{"hierarchy":{"lvl1":"Colour Palettes Design"},"content":"import warnings\n\nwarnings.filterwarnings(\"ignore\")\n\n\n\n","type":"content","url":"/notebooks/xx-color-palettes","position":1},{"hierarchy":{"lvl1":"Colour Palettes Design"},"type":"lvl1","url":"/notebooks/xx-color-palettes#colour-palettes-design","position":2},{"hierarchy":{"lvl1":"Colour Palettes Design"},"content":"\n\nВыбор палитры для визуализации данных влючает в себя не только поиск гармоничных цветовб, но и построение логики по который эти цвета будут использованы. Задача по подбору цветовой палитры для исследования осложняеться необходимостью визуализировать картографические данные.\nДля визуалищации картографических данных используеться три вида цветовых схем:\n\nsequential schemes - mapping orderable or numeric data that progress from low to high (or vice versa)\n\ndiverging schemes - mapping quantitative data above and below an interesting mid-point\n\nqualitative schemes - mapping categorical differences in qualitative data\n\nСпециализированные вебсайты, такие как \n\nColorBrewer, \n\nMapColPal and \n\nCartoColors не только помогают в подборе всех трех видов цыетовых схем, но и наглядно демонтрируют как цвета будут смотреться на картах.\n\n","type":"content","url":"/notebooks/xx-color-palettes#colour-palettes-design","position":3},{"hierarchy":{"lvl1":"Colour Palettes Design","lvl2":"Colour Definitions"},"type":"lvl2","url":"/notebooks/xx-color-palettes#colour-definitions","position":4},{"hierarchy":{"lvl1":"Colour Palettes Design","lvl2":"Colour Definitions"},"content":"sequential schemes - “Mint”, “Pi”, “Or”, “GrSc”\n\ndiverging schemes - “MintPi”, “MintOr”, “PiOr”\n\nqualitative schemes - “MiPiOr”\n\ncolor_palettes = {\n    \"Mint\": [\"#EAF4E8\", \"#C8E0D4\", \"#A9CCC1\", \"#8FB9AE\", \"#76A79D\", \"#5F968E\", \"#498581\"], \n    \"Pi\": [\"#F8EDEB\", \"#FAE1DD\", \"#FCD5CE\", \"#FEC5BB\", \"#F8AD9D\", \"#F4978E\", \"#F08080\"],\n    \"Or\": [\"#FFE5D9\", \"#FFD7BA\", \"#FEC89A\", \"#FFB78F\", \"#F49F7D\", \"#F28B6D\", \"#E1755CFF\"],\n    \"GrSc\":  ['#EFEFEF', '#D9D9D9', '#CCCCCC', '#B7B7B7', '#999999', '#666666', '#434343'],\n    \"MintPi\": [\"#76A79D\", \"#8FB9AE\", \"#A9CCC1\", \"#C8E0D4\", \"#FBF0EA\", \"#FCD5CE\", \"#FEC5BB\", \"#F8AD9D\", \"#F4978E\"],\n    \"MintOr\": [\"#76A79D\", \"#8FB9AE\", \"#A9CCC1\", \"#C8E0D4\", \"#FBF0EA\", \"#FFD7BA\", \"#FEC89A\", \"#FFB78F\", \"#F28B6D\"],\n    \"PiOr\": [\"#F4978E\", \"#F8AD9D\", \"#FEC5BB\", \"#FCD5CE\", \"#FBF0EA\", \"#FFD7BA\", \"#FEC89A\", \"#FFB78F\", \"#F28B6D\"],\n    \"MiPiOr\": ['#EAF4E8', '#FAE1DD', '#C8E0D4', '#FFD7BA', '#F8EDEB', '#FCD5CE', '#FFE5D9']\n}\n\n\n\n“MiPiOr”: [‘#EAF4E8’, ‘#FEC89A’ , ‘#FAE1DD’, ‘#C8E0D4’, ‘#FFD7BA’,‘#8FB9AE’,‘#F8EDEB’, ‘#FCD5CE’, ‘#A9CCC1’, ‘#FFE5D9’]“#e1755cff”\n\n“GrSc”:  [“#434343”, “#666666”, “#999999”, “#b7b7b7”, “#cccccc”, “#d9d9d9”, “#efefef”,\n\ncolors = [‘#FAE1DD’, ‘#FEC89A’, ‘#C8E0D4’, ‘#FEC5BB’, ‘#FFE5D9’, ‘#EAF4E8’, ‘#FBF0EA’, ‘#FFB78F’]\n\nimport matplotlib.pyplot as plt\nfrom matplotlib import colors\n\ncols    = max(len(p) for p in color_palettes.values())\ncols    = max(len(p) for p in color_palettes.values())\nrows    = len(color_palettes)\nfig, axs = plt.subplots(rows, 1, figsize=(cols*1, rows*1), constrained_layout=True)\n\nif rows == 1:\n    axs = [axs]\n\nfor ax, (name, palette) in zip(axs, color_palettes.items()):\n    rgb = [colors.hex2color(c) for c in palette]\n    arr = [rgb]                    \n\n    ax.imshow(arr, aspect='auto')\n    ax.set_xticks([]); ax.set_yticks([])\n    ax.set_ylim(-0.40, 0)\n\n    for i, c in enumerate(palette):\n        ax.text(i, -0.5, c, ha='center', va='center',\n                fontsize=8, color='black')\n\n    ax.set_title(name, loc='left', fontsize=12, pad=10)\n    ax.set_axis_off() \n\n\n\nFigure XX. bla bla bla\n\nimport pathlib\nimport os\n\ncwd = pathlib.Path(os.getcwd())          \nproject_root = cwd.parent                       \n\noutput_subdir = \"xx_color_palettes\"             \nout_dir = project_root / \"outputs\" / output_subdir\nout_dir.mkdir(parents=True, exist_ok=True)\n\nout_path = out_dir / \"color_palettes.jpg\"\n\nfig.savefig(out_path, format=\"jpg\", dpi=300, bbox_inches=\"tight\", pad_inches=0.2)\n\n\n\n","type":"content","url":"/notebooks/xx-color-palettes#colour-definitions","position":5},{"hierarchy":{"lvl1":"Colour Palettes Design","lvl2":"Color Blindness Test"},"type":"lvl2","url":"/notebooks/xx-color-palettes#color-blindness-test","position":6},{"hierarchy":{"lvl1":"Colour Palettes Design","lvl2":"Color Blindness Test"},"content":"\n\nDifferences in vision cover both blindness and color vision deficiency\nThese can be described by three concepts: accessibility, usability, and universal design. (Iwarson and Ståhl, 2003)\n\nTo ensure graphical materials are universal and enjoyable for everyone theories about color blindness are investigated alongside with accessibility and usability theories.\n\nColor Blindes can be seen as differences in vision cover both blindness and color vision deficiency. Color perception in the human eye is build up by three different types of cones. Each type is sensitive to a certain wavelength of light (red, green, and blue) and every perceived color is therefore a mixture of stimuli of those three cone types. (\n\nhttps://​www​.color​-blindness​.com​/what​-is​-color​-blindness/)\n\nCoblis — Color Blindness Simulator\n\n\n\nFigure XX. bla bla bla\n\n! use Pi und Or together only with different color strenght !! PiOr colour palete dont use !\n\nTODO: MintPiOr check second time , do i really need it\n\ncolor_palettes = {\n    \"Mint\": [\"#EAF4E8\", \"#C8E0D4\", \"#A9CCC1\", \"#8FB9AE\", \"#76A79D\", \"#5F968E\", \"#498581\"], \n    \"Pi\": [\"#F8EDEB\", \"#FAE1DD\", \"#FCD5CE\", \"#FEC5BB\", \"#F8AD9D\", \"#F4978E\", \"#F08080\"],\n    \"Or\": [\"#FFE5D9\", \"#FFD7BA\", \"#FEC89A\", \"#FFB78F\", \"#F49F7D\", \"#F28B6D\", \"#E1755CFF\"],\n    \"GrSc\":  ['#EFEFEF', '#D9D9D9', '#CCCCCC', '#B7B7B7', '#999999', '#666666', '#434343'],\n    \"MintPi\": [\"#76A79D\", \"#8FB9AE\", \"#A9CCC1\", \"#C8E0D4\", \"#FBF0EA\", \"#FCD5CE\", \"#FEC5BB\", \"#F8AD9D\", \"#F4978E\"],\n    \"MintOr\": [\"#76A79D\", \"#8FB9AE\", \"#A9CCC1\", \"#C8E0D4\", \"#FBF0EA\", \"#FFD7BA\", \"#FEC89A\", \"#FFB78F\", \"#F28B6D\"],\n    \"MiPiOr\": ['#EAF4E8', '#FAE1DD', '#C8E0D4', '#FFD7BA', '#F8EDEB', '#FCD5CE', '#FFE5D9']\n} \n\n\n\n","type":"content","url":"/notebooks/xx-color-palettes#color-blindness-test","position":7},{"hierarchy":{"lvl1":"Colour Palettes Design","lvl2":"Colour Palettes Export"},"type":"lvl2","url":"/notebooks/xx-color-palettes#colour-palettes-export","position":8},{"hierarchy":{"lvl1":"Colour Palettes Design","lvl2":"Colour Palettes Export"},"content":"\n\nfrom matplotlib.colors import LinearSegmentedColormap\n\ncmap_mint = LinearSegmentedColormap.from_list(\"Mint\", color_palettes[\"Mint\"])\ncmap_pi = LinearSegmentedColormap.from_list(\"Pi\", color_palettes[\"Pi\"])\ncmap_or = LinearSegmentedColormap.from_list(\"Or\", color_palettes[\"Or\"])\ncmap_mintpi = LinearSegmentedColormap.from_list(\"MintPi\", color_palettes[\"MintPi\"])\ncmap_mintor = LinearSegmentedColormap.from_list(\"MintOr\", color_palettes[\"MintOr\"])\ncmap_grsc = LinearSegmentedColormap.from_list(\"GrSc\", color_palettes[\"GrSc\"])\ncmap_mipior = LinearSegmentedColormap.from_list(\"MiPiOr\", color_palettes[\"MiPiOr\"])\n\n\n\n","type":"content","url":"/notebooks/xx-color-palettes#colour-palettes-export","position":9},{"hierarchy":{"lvl1":"Colour Palettes Design","lvl2":"New color pallets"},"type":"lvl2","url":"/notebooks/xx-color-palettes#new-color-pallets","position":10},{"hierarchy":{"lvl1":"Colour Palettes Design","lvl2":"New color pallets"},"content":"\n\nhere will be a color pallets fro new visualisations and for apendix content\n\nimport matplotlib.pyplot as plt\nimport numpy as np\n\ncolors = ['#FAE1DD', '#FFD7BA', '#A9CCC1', '#FEC5BB', '#FFE5D9', '#C8E0D4', '#FFB78F', '#F08080'] \n\nfig, ax = plt.subplots(figsize=(8, 1))\nax.set_xlim(0, len(colors))\nax.set_ylim(0, 1)\nfor i, c in enumerate(colors):\n    rect = plt.Rectangle((i, 0), 1, 1, facecolor=c)\n    ax.add_patch(rect)\n    ax.text(i + 0.5, 0.5, c, ha='center', va='center', fontsize=8, color='black')\nax.axis('off')\nplt.tight_layout()\nplt.savefig('colors.jpg', dpi=300, bbox_inches='tight')\nplt.close(fig)\n\n","type":"content","url":"/notebooks/xx-color-palettes#new-color-pallets","position":11},{"hierarchy":{"lvl1":"Material & Data"},"type":"lvl1","url":"/notebooks/xx-materials-and-data","position":0},{"hierarchy":{"lvl1":"Material & Data"},"content":"Set Up\n\nimport os\nimport numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport geopandas as gpd\nfrom shapely.geometry import Point, MultiPoint\nfrom pyproj import CRS\nfrom scipy.stats import norm\n\n\n\nFont\n\nplt.rcParams[\"font.family\"] = \"Helvetica\"\n\n\n\n\n\nhere will be all materials used in master thesis and data sourses\n\nsee expose and miro","type":"content","url":"/notebooks/xx-materials-and-data","position":1}]}