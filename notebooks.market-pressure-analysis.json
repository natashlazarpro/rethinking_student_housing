{"version":3,"kind":"Notebook","sha256":"bf03a117e2356dc2d066efd2fc226fc0a047551a02d21f9201e27aedd4e13a8e","slug":"notebooks.market-pressure-analysis","location":"/notebooks/3.3_market_pressure_analysis.ipynb","dependencies":[],"frontmatter":{"title":"3.3 Market Pressure Analysis","content_includes_title":true,"kernelspec":{"name":"python3","display_name":"geodatascience2.0","language":"python"},"authors":[{"nameParsed":{"literal":"Lazareva Nataliia","given":"Lazareva","family":"Nataliia"},"name":"Lazareva Nataliia","id":"contributors-myst-generated-uid-0"},{"nameParsed":{"literal":"Urban Design M.Sc.","given":"Urban Design","family":"M.Sc."},"name":"Urban Design M.Sc.","id":"contributors-myst-generated-uid-1"},{"nameParsed":{"literal":"Technical University of Berlin","given":"Technical University","non_dropping_particle":"of","family":"Berlin"},"name":"Technical University of Berlin","id":"contributors-myst-generated-uid-2"}],"github":"https://github.com/natashlazarpro/rethinking_student_housing","copyright":"2025","numbering":{"title":{"offset":1}},"source_url":"https://github.com/natashlazarpro/rethinking_student_housing/blob/main/student-housing-book/notebooks/3.3_market_pressure_analysis.ipynb","edit_url":"https://github.com/natashlazarpro/rethinking_student_housing/edit/main/student-housing-book/notebooks/3.3_market_pressure_analysis.ipynb","exports":[{"format":"ipynb","filename":"3.3_market_pressure_analysis.ipynb","url":"/rethinking_student_housing/build/3.3_market_pressure_-3f40241bf245e19890d0eb66bd6dfb8f.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"import warnings\n\nwarnings.filterwarnings(\"ignore\")\n\nimport os\nhf = r'../outputs/3.3_market_pressure_analysis/'\nos.makedirs(hf, exist_ok=True)","visibility":"show","key":"G5iRFxY9QG"},{"type":"outputs","id":"ZRSof8R-l05qqhSDUqEFi","children":[],"visibility":"show","key":"Aq7QIrkraC"}],"visibility":"remove","key":"qsIntOwQa0"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":1,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"3.3 Market Pressure Analysis","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Umpcf9LRZQ"}],"identifier":"id-3-3-market-pressure-analysis","label":"3.3 Market Pressure Analysis","html_id":"id-3-3-market-pressure-analysis","implicit":true,"key":"LQY2rfGIPL"}],"key":"DirYtgy1BJ"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"In the chapter Central Place Analysis, spatial economics metrics were calculated, including demand–capacity pressure for each market area. The task of the chapter Market Pressure Analysis is to move from numerical characteristics to spatial ones and to calculate the local pressure on the student housing market and particular student accommodations.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"cQRCjKCX8J"}],"key":"t0FpoqoJ2e"}],"key":"FOrQnSFCtS"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Set Up","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"kLYQmzgM1m"}],"identifier":"set-up","label":"Set Up","html_id":"set-up","implicit":true,"key":"zbm7aenJ9E"}],"key":"S0zJTbbWZ3"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Import Libraries","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"x32JhcHQ0Q"}],"key":"uKVwBftSij"}],"key":"KMIUQYyKT3"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nimport geopandas as gpd\nfrom matplotlib.colors import LinearSegmentedColormap\nimport seaborn as sns\nimport matplotlib.patheffects as path_effects\nfrom matplotlib.colors import ListedColormap\nfrom shapely.ops import unary_union\nimport rasterio\nfrom rasterio import features\nfrom affine import Affine\nfrom scipy.ndimage import gaussian_filter","key":"YmHIPrqb6Z"},{"type":"outputs","id":"ovJqEWIxajqlgPQoCvS3R","children":[],"key":"CK4v2iINPF"}],"key":"wjuwtKWRPw"},{"type":"block","kind":"notebook-content","data":{"tags":[]},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Colors","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"uyuns1KaxV"}],"key":"oXK8fjBMh4"}],"visibility":"remove","key":"BEG7gl4agc"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"color_palettes = {\n    \"Mint\": [\"#EAF4E8\", \"#C8E0D4\", \"#A9CCC1\", \"#8FB9AE\", \"#76A79D\", \"#5F968E\", \"#498581\"], \n    \"Pi\": [\"#F8EDEB\", \"#FAE1DD\", \"#FCD5CE\", \"#FEC5BB\", \"#F8AD9D\", \"#F4978E\", \"#F08080\"],\n    \"Or\": [\"#FFE5D9\", \"#FFD7BA\", \"#FEC89A\", \"#FFB78F\", \"#F49F7D\", \"#F28B6D\"], \n    \"MintPi\": [\"#76A79D\", \"#8FB9AE\", \"#A9CCC1\", \"#C8E0D4\", \"#FBF0EA\", \"#FCD5CE\", \"#FEC5BB\", \"#F8AD9D\", \"#F4978E\"],\n    \"MintOr\": [\"#76A79D\", \"#8FB9AE\", \"#A9CCC1\", \"#C8E0D4\", \"#FBF0EA\", \"#FFD7BA\", \"#FEC89A\", \"#FFB78F\", \"#F28B6D\"],\n    \"GrSc\":  [\"#434343\", \"#666666\", \"#999999\", \"#b7b7b7\", \"#cccccc\", \"#d9d9d9\", \"#efefef\", \"#f3f3f3\", \"#ffffff\"]\n}\n\ncmap_mint = LinearSegmentedColormap.from_list(\"Mint\", color_palettes[\"Mint\"])\ncmap_pi = LinearSegmentedColormap.from_list(\"Pi\", color_palettes[\"Pi\"])\ncmap_or = LinearSegmentedColormap.from_list(\"Or\", color_palettes[\"Or\"])\ncmap_mintpi = LinearSegmentedColormap.from_list(\"MintPi\", color_palettes[\"MintPi\"])\ncmap_mintor = LinearSegmentedColormap.from_list(\"MintOr\", color_palettes[\"MintOr\"])\ncmap_grsc = LinearSegmentedColormap.from_list(\"GrSc\", color_palettes[\"GrSc\"])","visibility":"show","key":"LoQw5aWcrJ"},{"type":"outputs","id":"nk5SQtj3ZNRr2I0qo4f4h","children":[],"visibility":"show","key":"NITcktMknZ"}],"visibility":"remove","key":"lZphEHBwAo"},{"type":"block","kind":"notebook-content","data":{"tags":[]},"children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Font","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"nJ5w6Izmbd"}],"key":"woCGB8G5d4"}],"visibility":"remove","key":"uyQabgYsBq"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"plt.rcParams[\"font.family\"] = \"Helvetica\"","visibility":"show","key":"Hv9nGYWLdL"},{"type":"outputs","id":"dFMVBLYVyoLX3KZ8gN1KT","children":[],"visibility":"show","key":"iFeDVmIadM"}],"visibility":"remove","key":"eCzdwnIrRb"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Berlin Spatial Boundaries","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"S0TgJQKtjW"}],"key":"tJrm8Wzc9i"}],"key":"WooXg5jWsS"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"pf = r\"../inputs/3.3_market_pressure_analysis/lor_pgr.gpkg\"\npgr = gpd.read_file(pf)\npgr.replace({'-': np.nan, 0: np.nan, '': np.nan}, inplace=True)\n\nbf = r\"../inputs/3.3_market_pressure_analysis/adm_bz.gpkg\"\nbz = gpd.read_file(bf)\nbz.replace({'-': np.nan, 0: np.nan, '': np.nan}, inplace=True)\n\nof = r\"../inputs/3.3_market_pressure_analysis/adm_out.gpkg\"\nout = gpd.read_file(of)\nout.replace({'-': np.nan, 0: np.nan, '': np.nan}, inplace=True)","key":"XZ30ing1Wr"},{"type":"outputs","id":"Dg9SyGBqxd6sesewrz2ww","children":[],"key":"yMaI7a3UV4"}],"key":"rB9GUprnBN"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Data Import","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"GlL7wIFVir"}],"key":"Sy9KIn4qWE"}],"key":"SwWEkRStPV"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"ff = r\"../inputs/3.3_market_pressure_analysis/market_area_central_place_analysis.gpkg\"\nmarket_area = gpd.read_file(ff)\n\ncf = r\"../inputs/3.3_market_pressure_analysis/central_places.gpkg\"\ncentral_places = gpd.read_file(cf)\n\npf = r\"../inputs/3.3_market_pressure_analysis/pbsa_capacity_analysis.gpkg\"\npbsa_cap = gpd.read_file(pf)","key":"QGEkrTITtA"},{"type":"outputs","id":"wkUD9iHnjJxH0YuR2CFB2","children":[],"key":"v5OUN9dJe2"}],"key":"OYJfk3IhiC"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":1,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Overlap Problem","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"tnnLERAdON"}],"identifier":"overlap-problem","label":"Overlap Problem","html_id":"overlap-problem","implicit":true,"key":"iaOQbRMzXp"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Whereas in the original Central Place, theory market areas do not overlap, in order to analyse the aggregate market pressure on the student housing market, it is necessary to move from the overlapping market areas obtained as a result of the Central Place Analysis (Figure XX) to a more accurate local structure that reflects the aggregate pressure on a particular part of the city.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"RR0H2U2GZ4"}],"key":"AiROv2QVcP"}],"key":"Xi2rDOImew"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"market_area['demand_capacity_pressure_rank'] = pd.qcut(\n    market_area['demand_capacity_pressure'],\n    q=5, labels=range(1, 6)   # 1‑5 classes\n)","key":"j7pEsNwUc1"},{"type":"outputs","id":"xEAuckdMnV0TYaHSGYx6Z","children":[],"key":"zZVLYZpYYV"}],"key":"KsQxWPyRzN"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"cmap_mint_mini = ListedColormap(cmap_mint(np.linspace(0.15, 1, 256)))\n\nfig, ax = plt.subplots(figsize=(12, 12))\n\npgr.plot(ax=ax, facecolor='none', edgecolor='#cccccc', linewidth=0.5, linestyle=\"--\")\nbz.plot(ax=ax, facecolor='none', edgecolor='#999999', linewidth=0.75)\nout.plot(ax=ax, facecolor='none', edgecolor='#666666', linewidth=1.25)\n\nvmin=0\nvmax=5\n\nmarket_area.plot(\n    ax=ax,\n    column='demand_capacity_pressure_rank',\n    cmap=cmap_mint,\n    edgecolor='none',\n    linewidth=0.3,\n    alpha=0.55,\n    legend=True,\n    legend_kwds={'frameon': False}, \n    label = 'demand capacity pressure rank', \n    vmax = vmax)  # Matching Previous plott\n\nplt.tight_layout()\n\n# sm = plt.cm.ScalarMappable(cmap=cmap_mint_mini, norm=plt.Normalize(vmin, vmax))\n# cbar = fig.colorbar(sm, ax=ax, shrink=0.6)\n# cbar.set_label(\"demand capacity pressure\")\n# cbar.set_ticks(range(vmin, 6))\n# cbar.outline.set_visible(False)\n\nmarket_area.plot(\n    ax=ax,\n    edgecolor='white',  # variable for colormap\n    facecolor=\"none\",        # transparent polygons  # edge colors from your column\n    linewidth=0.3,\n    alpha=1\n)\nplt.tight_layout()\n\ncentral_places.plot(ax=ax,\n           color='#434343',\n           markersize= 10,\n           alpha=0.75,\n           edgecolor='white',\n           linewidth=1)\nplt.tight_layout()\nfor idx, row in central_places.iterrows():\n    offset = 3  # vertical offset in points\n    ax.annotate(\n        row['abr'],  # abbreviation\n        xy=(row.geometry.x, row.geometry.y),  # position of the point\n        xytext=(0, offset),  # move text upward\n        textcoords='offset points',\n        color='#1b4332',     # dark mint / forest green for good contrast\n        fontsize=8,\n        ha='center',\n        va='bottom',\n        alpha=1,\n        zorder=6,\n        path_effects=[\n            path_effects.Stroke(linewidth=2, foreground='white'),\n            path_effects.Normal()\n        ]\n    )\n\nax.set_title('Market Areas Demand Capacity Pressure', fontsize=16, weight='bold')\nax.set_axis_off()\n\nsave_path = os.path.join(hf, \"Market_Areas_Demand_Capacity_Pressure.png\")\nplt.savefig(save_path, dpi=300, bbox_inches=\"tight\")\n\nplt.show()","visibility":"remove","key":"DKnOb5nrvN"},{"type":"outputs","id":"29MOFX7EkNKu7F4ThHYNA","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"bdd91e8208fae1b61bc46792c1da8841","path":"/rethinking_student_housing/build/bdd91e8208fae1b61bc46792c1da8841.png"},"text/plain":{"content":"<Figure size 1200x1200 with 1 Axes>","content_type":"text/plain"}}},"children":[],"key":"CnneuXbF1I"}],"visibility":"show","key":"HPRB4IdZVK"}],"visibility":"show","key":"odwHiGUOby"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"emphasis","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Figure XX. Market Areas Demand Capacity Pressure Rank","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"EqmnyFClH0"}],"key":"CrL6zw4C6G"}],"key":"NQN3uRVbMu"}],"key":"INzOyVtGfO"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Market Areas Demand Capacity Pressure Rank (Figure XX) illustrates that each university forms its own accessibility zone, and these zones naturally overlap. On the one hand, this overlap reflects the real competition for student flows for the same housing stock. On the other hand, it creates analytical complexity: some territories are part of several market areas at the same time, which complicates the interpretation of local pressure.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"iUelolxAX2"}],"key":"ssEQbsXD3R"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"This is partly due to the fact that, initially, isochrones were calculated using multipolygons, which form complex geometries and consist of several polygon parts. These fragments overlap with each other and with the polygons of other universities.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"iJSoexwduL"}],"key":"foKaQCgiPr"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"According to the results of spatial analysis, individual market areas of overlap and are part of at least five different market areas, while particularly central areas, such as parts of the Mitte district, are part of 14 market areas simultaneously. In order to simplify such a dense network of intersecting zones of influence, it is necessary to eliminate overlaps.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"SK7iy79Xrl"}],"key":"IiUR5S9tX4"}],"key":"MeJo3vYRMH"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"market_area['er_overlap'] = 0\n\n# Calculate overlaps\nfor i, current_poly in market_area.iterrows():\n    overlap_count = 0\n    for j, other_poly in market_area.iterrows():\n        if i != j:  # Don't compare with itself\n            if current_poly.geometry.intersects(other_poly.geometry):\n                overlap_count += 1\n    market_area.at[i, 'er_overlap'] = overlap_count\n\nprint(f\"Overlap Counts Range for Market Areas: {market_area['er_overlap'].min()} to {market_area['er_overlap'].max()}\")\n\nff = r'../outputs/3.3_market_pressure_analysis/market_areas_not_explode_overlap.gpkg'\nmarket_area.to_file(ff, driver=\"GPKG\")","key":"yt5UvD2Mjk"},{"type":"outputs","id":"uYS1NVAOq81Uv7J0RUWh7","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"Overlap Counts Range for Market Areas: 5 to 14\n"},"children":[],"key":"z8179j5yw5"}],"key":"Z76dzjT7qQ"}],"key":"ZK04OOASSG"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"One way to simplify geometry is to divide complex multipolygon geometry into simple polygons ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"HEAjctUjHW"},{"type":"inlineCode","value":"market_area.explode(ignore_index=True)","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"hIRzckOtV8"},{"type":"text","value":". In this case, polygons intersect between 0 and 51 times.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"rbHUSJExgy"}],"key":"LC7POkx8ZV"}],"key":"IpqwL2YovD"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"market_area_exp = market_area.explode(ignore_index=True)\n\nmarket_area_exp['er_overlap'] = 0\n\nfor i, current_poly in market_area_exp.iterrows():\n    overlap_count = 0\n    for j, other_poly in market_area_exp.iterrows():\n        if i != j:  \n            if current_poly.geometry.intersects(other_poly.geometry):\n                overlap_count += 1\n    market_area_exp.at[i, 'er_overlap'] = overlap_count\n\nprint(f\"Overlap Counts Range for Exploded Market Areas: {market_area_exp['er_overlap'].min()} to {market_area_exp['er_overlap'].max()}\")","key":"rpMR1h7qUl"},{"type":"outputs","id":"-JnAqrgRH4QVJy-r_Xxo_","children":[{"type":"output","jupyter_data":{"name":"stdout","output_type":"stream","text":"Overlap Counts Range for Exploded Market Areas: 0 to 51\n"},"children":[],"key":"CwUkUXAL0Z"}],"key":"zoCRxNThzt"}],"key":"IvdnSwebuI"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"This means that in order to switch to simple geometry, it will be necessary to apply the division 51 more times. Such a task is not only difficult in terms of computing power, but will also result in the resulting non-intersecting polygons being extremely small.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"DfY1hD7HRX"}],"key":"DE6Io9Ixpw"}],"key":"kPQx3kTprF"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":1,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Rasterisation","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"nDtxlGzjNg"}],"identifier":"rasterisation","label":"Rasterisation","html_id":"rasterisation","implicit":true,"key":"LknRRzNo98"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Another way to eliminate the problem of multiple market area overlaps is to switch from vector geometry to raster representation, i.e., to a regular grid of fixed size. Rasterisation allows complex, overlapping polygons to be replaced with a set of uniform pixel cells. Unlike a vector model, where a single territory can belong to several market areas at once, a raster grid forces a unique spatial correspondence: one cell equals one pressure value.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"K1MU8egbl2"}],"key":"MDnuLEWD5M"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"The use of a regular 25-meter grid provides a sufficient level of spatial detail to identify micro-zones of local congestion, especially in areas where the density of universities and student accommodation is highest.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"kaMXQQbZJZ"}],"key":"r7ZVIAZhLO"}],"key":"n3Iq7nCIjn"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"value_col = \"demand_capacity_pressure\"\n\n# Define raster resolution (in meters)\nresolution = 25 \n\n# Bounding box\nminx, miny, maxx, maxy = market_area.total_bounds\n\n# Create transform (affine)\ntransform = Affine.translation(minx, maxy) * Affine.scale(resolution, -resolution)\n\n# Calculate raster shape\nwidth = int((maxx - minx) / resolution)\nheight = int((maxy - miny) / resolution)","key":"V43YxY9xNq"},{"type":"outputs","id":"ayaOIZYoZfUvPMuTjYNc1","children":[],"key":"CXve9m4CYN"}],"key":"d9DLXYKxmZ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"raster = np.zeros((height, width), dtype=np.float32)\n\n# For each polygon, add pressure values\nfor _, row in market_area.iterrows():\n    shapes = [(row.geometry, row[value_col])]\n    layer = features.rasterize(\n        shapes=shapes,\n        out_shape=(height, width),\n        transform=transform,\n        fill=0,\n        all_touched=True,\n        dtype=np.float32\n    )\n    raster += layer","key":"jUgT3BcwIX"},{"type":"outputs","id":"M_ka50GtRUuanN3FMM9DV","children":[],"key":"RjbOToYmOb"}],"key":"AyzXpNsCQd"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":1,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Demand Capacity Pressure","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"a6uHVbSrYl"}],"identifier":"demand-capacity-pressure","label":"Demand Capacity Pressure","html_id":"demand-capacity-pressure","implicit":true,"key":"HJF5G3LK61"}],"key":"LS80bgKgVt"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Thus, rasterisation can be used to assess Market Areas Local Demand Capacity Pressure (Figure XX).","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"lz1r271Mjp"}],"key":"uWAlYTfsf9"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"The Local Demand–Capacity Pressure (Figure XX) shows the spatial distribution of the total market pressure arising from the overlap of the catchment areas of all universities. Unlike capacity–demand pressure, which is calculated at the level of individual market areas, this visualisation shows the ‘accumulated’ pressure, reflecting the cumulative effect of student competition for housing resources at each point in the urban area.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"pyhyuIl6Qd"}],"key":"dma64x00QE"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"The most intense pressure zones are marked in saturated red shades and are concentrated in the central part of the city — primarily in the districts of Mitte, Charlottenburg-Wilmersdorf, and Friedrichshain-Kreuzberg. This core coincides with the spatial location of the largest educational clusters: the University of the Arts Berlin (UAB), University of Europe for Applied Sciences (UEAS), Berlin International University (BIU), Berlin School of Technology (BTS), and School of Economics and Law (HWR_BA). The catchment areas of these universities overlap most densely, which greatly increases the pressure on the limited housing stock in the central districts. It is here that local pressure reaches its maximum values — over 30, which indicates extremely high competition among international students for available places.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"VOeaNN1Sqs"}],"key":"yTi6i6s9Kc"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"As move away from the central core, the intensity of the pressure gradually decreases, transitioning into moderate greenish hues. However, the decrease is asymmetrical: in the south-west (Steglitz-Zehlendorf), south-east (Treptow-Köpenick), and partly in the north-east (Pankow), there are still local areas of increased local pressure caused by the influence of the large universities FU, HU, and HTW. At the same time, the districts of Reinickendorf, Spandau, and Marzahn-Hellersdorf show the lowest local pressure values, indicating weak involvement in competition for housing stock and relatively low attractiveness for students.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"y0B4LAajoN"}],"key":"LmQUZFFNqM"},{"type":"paragraph","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Thus, the local demand–capacity pressure map clearly shows that market tension in the student housing market in Berlin is concentrated and polycentric, reaching its peak in the central ‘education corridor’ and gradually weakening towards the periphery.","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"r7FDFDPu3u"}],"key":"dcvkqHMiUd"},{"type":"paragraph","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"Importantly, this visualisation emphasises that the pressure is not generated by individual market areas, but by the overlap of multiple accessibility zones, which explains why it is the concentration of university functions — and not just the local shortage of student accommodation — that is the key driver of market pressure in the central areas of the city.","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"Zu3ijS6QcS"}],"key":"jjzv9kgrCT"}],"key":"IDM3afw6NG"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"fig, ax = plt.subplots(figsize=(12, 12))\nextent = (minx, maxx, miny, maxy)\n\ncmap_mintpi_mini = ListedColormap(cmap_mintpi(np.linspace(0.15, 1, 256)))\n\n\n# Replace pgr, bz, out with your base layers if needed\npgr.plot(ax=ax, facecolor='none', edgecolor='#cccccc', linewidth=0.5, linestyle=\"--\")\nbz.plot(ax=ax, facecolor='none', edgecolor='#999999', linewidth=0.75)\nout.plot(ax=ax, facecolor='none', edgecolor='#666666', linewidth=1.25)\n\n\n#-----------------------------1-------------------------------------\n\ncentral_places.plot(ax=ax,\n           color='#434343',\n           markersize= 10,\n           alpha=0.85,\n           edgecolor=None,\n           linewidth=1)\nplt.tight_layout()\nfor idx, row in central_places.iterrows():\n    offset = 3  # vertical offset in points\n    ax.annotate(\n        row['abr'],  # abbreviation\n        xy=(row.geometry.x, row.geometry.y),  # position of the point\n        xytext=(0, offset),  # move text upward\n        textcoords='offset points',\n        color='#1b4332',     # dark mint / forest green for good contrast\n        fontsize=8,\n        ha='center',\n        va='bottom',\n        alpha=1,\n        zorder=6,\n        path_effects=[\n            path_effects.Stroke(linewidth=2, foreground='white'),\n            path_effects.Normal()\n        ]\n    )\n\n#-----------------------------2-------------------------------------  \npbsa_cap.plot(ax=ax,\n           color='#434343',\n           markersize= 10,\n           alpha=0.75,\n           edgecolor='white',\n           linewidth=1)\n\n#-----------------------------3-------------------------------------  \n                  \nmasked_raster = np.ma.masked_where(raster == 0, raster)\n\nim = ax.imshow(\n    masked_raster,\n    cmap=cmap_mintpi_mini,\n    alpha=0.9,\n    zorder=1\n)\n\nax.imshow(masked_raster, cmap=cmap_mintpi_mini, extent=extent) #, extent=extent\nax.set_title('Market Areas Local Demand Capacity Pressure', fontsize=16, weight='bold')\nax.axis('off') \n\ncbar = plt.colorbar(im, ax=ax, fraction=0.036, pad=0.04)\ncbar.set_label('local demand capacity pressure', fontsize=12)\ncbar.outline.set_visible(False)  # cleaner look\n\nsave_path = os.path.join(hf, \"Market Areas Local Demand Capacity Pressure.png\")\nplt.savefig(save_path, dpi=300, bbox_inches=\"tight\")\n\nplt.tight_layout()\nplt.show()\nax.set_axis_off()","visibility":"remove","key":"iv7Mv6Vp5C"},{"type":"outputs","id":"BDfclVhMDT5IqIkwt4LVF","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"030c03480753445636c2c04c02d40590","path":"/rethinking_student_housing/build/030c03480753445636c2c04c02d40590.png"},"text/plain":{"content":"<Figure size 1200x1200 with 2 Axes>","content_type":"text/plain"}}},"children":[],"key":"ZYwxUmIekF"}],"visibility":"show","key":"aTrN0Up0x5"}],"visibility":"show","key":"I25W3eISFR"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"emphasis","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Figure XX. Market Areas Local Demand Capacity Pressure","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"dWuBJ3bIph"}],"key":"pFVWGNtKN5"}],"key":"FlaKDb0M6U"}],"key":"m1ICxdzmpF"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"out_raw = r'../outputs/3.3_market_pressure_analysis/market_pressure_sum_raw.tif'","key":"dgNuahsKCf"},{"type":"outputs","id":"vWTCkX9TgnYPn1zGTV5qH","children":[],"key":"G6bTrxKE2t"}],"key":"GixGIrFTzc"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":1,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Student Accommodation Pressure","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ntYodIVvWA"}],"identifier":"student-accommodation-pressure","label":"Student Accommodation Pressure","html_id":"student-accommodation-pressure","implicit":true,"key":"vG8wPVL34h"}],"key":"K3orIgonS5"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Data Import","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"hWR3l2dwRk"}],"key":"XVUevpuZP6"}],"key":"ih4wQt9HR3"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"out_raw = r'../outputs/3.3_market_pressure_analysis/market_pressure_sum_raw.tif'\n\nwith rasterio.open(out_raw) as src:\n    raster = src.read(1)  # read first band as numpy array\n    transform = src.transform\n    crs = src.crs\n\nef = r\"../inputs/3.3_market_pressure_analysis/pbsa_capacity_analysis.gpkg\"\npbsa_cap = gpd.read_file(ef)\n\npbsa_cap.drop(columns=['link', '!cap_slag', '!cap_std', '!cap_slag_std', 'cluster', 'model', 'color', 'city'], inplace=True, errors='ignore') ","key":"ZGRmOlUG2M"},{"type":"outputs","id":"DniXi_671pZ0eVfkVP-I0","children":[],"key":"KEbT1cPts5"}],"key":"tQadgMFu1F"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"coords = [(geom.x, geom.y) for geom in pbsa_cap.geometry]\nwith rasterio.open(out_raw) as src:\n    pbsa_cap[\"local_demand_capacity_pressure\"] = [val[0] for val in src.sample(coords)]\n\npbsa_cap[\"local_demand_capacity_pressure\"] = pbsa_cap[\"local_demand_capacity_pressure\"].round(3)","key":"iVCObdLVHN"},{"type":"outputs","id":"N8zdR0G4arvq_jz_ipmFs","children":[],"key":"XzK70usMqy"}],"key":"GGfSxQZelc"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Less Pressured Student Accommodations:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"n8oHyqWXbC"}],"key":"B9eBfaKnLb"}],"key":"UFidRyUEkY"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"pbsa_cap[pbsa_cap[\"local_demand_capacity_pressure\"] > 0][[\n    \"name\",\n    \"plz\",\n    \"ownership\",\n    \"!cap\",\n    \"ownership_model\",\n    \"cluster_cap\",\n    \"local_demand_capacity_pressure\",\n]].sort_values(\"local_demand_capacity_pressure\").head(10)","key":"Wjrbkke5QL"},{"type":"outputs","id":"6cqBt0id2XAHy93vwyNv0","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":17,"metadata":{},"data":{"application/vnd.microsoft.datawrangler.viewer.v0+json":{"content":"{\"columns\":[{\"name\":\"index\",\"rawType\":\"int64\",\"type\":\"integer\"},{\"name\":\"name\",\"rawType\":\"object\",\"type\":\"string\"},{\"name\":\"plz\",\"rawType\":\"object\",\"type\":\"string\"},{\"name\":\"ownership\",\"rawType\":\"object\",\"type\":\"string\"},{\"name\":\"!cap\",\"rawType\":\"float64\",\"type\":\"float\"},{\"name\":\"ownership_model\",\"rawType\":\"object\",\"type\":\"string\"},{\"name\":\"cluster_cap\",\"rawType\":\"object\",\"type\":\"string\"},{\"name\":\"local_demand_capacity_pressure\",\"rawType\":\"float32\",\"type\":\"float\"}],\"ref\":\"766ea061-fad5-413a-b9ca-10e579fef135\",\"rows\":[[\"86\",\"Walter-Friedländer-Straße Pankow\",\"10249\",\"Berlinovo\",\"285.0\",\"State-Owned\",\"HL\",\"0.738\"],[\"37\",\"Storckower Straße Lichtenberg I\",\"10369\",\"Berlinovo\",\"141.0\",\"State-Owned\",\"HL\",\"0.738\"],[\"31\",\"Rhinstraße Lichtenberg\",\"10315\",\"Berlinovo\",\"800.0\",\"State-Owned\",\"HH\",\"1.167\"],[\"55\",\"WH Aristotelessteig\",\"10318\",\"Studierendenwerk Berlin\",\"913.0\",\"State-Owned\",\"HH\",\"1.167\"],[\"54\",\"WH Allee der Kosmonauten\",\"10315\",\"Studierendenwerk Berlin\",\"298.0\",\"State-Owned\",\"HH\",\"1.167\"],[\"42\",\"Studentenwohnheim Alfred-Jung-Straße\",\"10369\",\"Home in Berlin GmbH\",\"800.0\",\"Privat-Owned\",\"HH\",\"1.167\"],[\"8\",\"Elfriede-Tygör-Straße\",\"10319\",\"Berlinovo\",\"202.0\",\"State-Owned\",\"HL\",\"1.167\"],[\"11\",\"Friedenhorster Straße Friedrichsfelde\",\"10319\",\"Berlinovo\",\"138.0\",\"State-Owned\",\"HL\",\"1.167\"],[\"80\",\"WH Sewanstraße\",\"10319\",\"Studierendenwerk Berlin\",\"700.0\",\"State-Owned\",\"HH\",\"1.167\"],[\"83\",\"WH Storkower Straße (Ferdinand Thomas)\",\"10367\",\"Studierendenwerk Berlin\",\"508.0\",\"State-Owned\",\"HH\",\"1.595\"]],\"shape\":{\"columns\":7,\"rows\":10}}","content_type":"application/vnd.microsoft.datawrangler.viewer.v0+json"},"text/html":{"content":"<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>name</th>\n      <th>plz</th>\n      <th>ownership</th>\n      <th>!cap</th>\n      <th>ownership_model</th>\n      <th>cluster_cap</th>\n      <th>local_demand_capacity_pressure</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>86</th>\n      <td>Walter-Friedländer-Straße Pankow</td>\n      <td>10249</td>\n      <td>Berlinovo</td>\n      <td>285.0</td>\n      <td>State-Owned</td>\n      <td>HL</td>\n      <td>0.738</td>\n    </tr>\n    <tr>\n      <th>37</th>\n      <td>Storckower Straße Lichtenberg I</td>\n      <td>10369</td>\n      <td>Berlinovo</td>\n      <td>141.0</td>\n      <td>State-Owned</td>\n      <td>HL</td>\n      <td>0.738</td>\n    </tr>\n    <tr>\n      <th>31</th>\n      <td>Rhinstraße Lichtenberg</td>\n      <td>10315</td>\n      <td>Berlinovo</td>\n      <td>800.0</td>\n      <td>State-Owned</td>\n      <td>HH</td>\n      <td>1.167</td>\n    </tr>\n    <tr>\n      <th>55</th>\n      <td>WH Aristotelessteig</td>\n      <td>10318</td>\n      <td>Studierendenwerk Berlin</td>\n      <td>913.0</td>\n      <td>State-Owned</td>\n      <td>HH</td>\n      <td>1.167</td>\n    </tr>\n    <tr>\n      <th>54</th>\n      <td>WH Allee der Kosmonauten</td>\n      <td>10315</td>\n      <td>Studierendenwerk Berlin</td>\n      <td>298.0</td>\n      <td>State-Owned</td>\n      <td>HH</td>\n      <td>1.167</td>\n    </tr>\n    <tr>\n      <th>42</th>\n      <td>Studentenwohnheim Alfred-Jung-Straße</td>\n      <td>10369</td>\n      <td>Home in Berlin GmbH</td>\n      <td>800.0</td>\n      <td>Privat-Owned</td>\n      <td>HH</td>\n      <td>1.167</td>\n    </tr>\n    <tr>\n      <th>8</th>\n      <td>Elfriede-Tygör-Straße</td>\n      <td>10319</td>\n      <td>Berlinovo</td>\n      <td>202.0</td>\n      <td>State-Owned</td>\n      <td>HL</td>\n      <td>1.167</td>\n    </tr>\n    <tr>\n      <th>11</th>\n      <td>Friedenhorster Straße Friedrichsfelde</td>\n      <td>10319</td>\n      <td>Berlinovo</td>\n      <td>138.0</td>\n      <td>State-Owned</td>\n      <td>HL</td>\n      <td>1.167</td>\n    </tr>\n    <tr>\n      <th>80</th>\n      <td>WH Sewanstraße</td>\n      <td>10319</td>\n      <td>Studierendenwerk Berlin</td>\n      <td>700.0</td>\n      <td>State-Owned</td>\n      <td>HH</td>\n      <td>1.167</td>\n    </tr>\n    <tr>\n      <th>83</th>\n      <td>WH Storkower Straße (Ferdinand Thomas)</td>\n      <td>10367</td>\n      <td>Studierendenwerk Berlin</td>\n      <td>508.0</td>\n      <td>State-Owned</td>\n      <td>HH</td>\n      <td>1.595</td>\n    </tr>\n  </tbody>\n</table>\n</div>","content_type":"text/html"},"text/plain":{"content":"                                      name    plz                ownership  \\\n86        Walter-Friedländer-Straße Pankow  10249                Berlinovo   \n37         Storckower Straße Lichtenberg I  10369                Berlinovo   \n31                  Rhinstraße Lichtenberg  10315                Berlinovo   \n55                     WH Aristotelessteig  10318  Studierendenwerk Berlin   \n54                WH Allee der Kosmonauten  10315  Studierendenwerk Berlin   \n42    Studentenwohnheim Alfred-Jung-Straße  10369      Home in Berlin GmbH   \n8                    Elfriede-Tygör-Straße  10319                Berlinovo   \n11   Friedenhorster Straße Friedrichsfelde  10319                Berlinovo   \n80                          WH Sewanstraße  10319  Studierendenwerk Berlin   \n83  WH Storkower Straße (Ferdinand Thomas)  10367  Studierendenwerk Berlin   \n\n     !cap ownership_model cluster_cap  local_demand_capacity_pressure  \n86  285.0     State-Owned          HL                           0.738  \n37  141.0     State-Owned          HL                           0.738  \n31  800.0     State-Owned          HH                           1.167  \n55  913.0     State-Owned          HH                           1.167  \n54  298.0     State-Owned          HH                           1.167  \n42  800.0    Privat-Owned          HH                           1.167  \n8   202.0     State-Owned          HL                           1.167  \n11  138.0     State-Owned          HL                           1.167  \n80  700.0     State-Owned          HH                           1.167  \n83  508.0     State-Owned          HH                           1.595  ","content_type":"text/plain"}}},"children":[],"key":"KTrgi0JTq4"}],"key":"EqdN1DV7t6"}],"key":"EIlVTxZvta"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"emphasis","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Table XX. Less Pressured Student Accommodations","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"mHI06y7N9H"}],"key":"iaIpX3iDSR"}],"key":"prdZEnyTfJ"}],"key":"ki9GxySIrw"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"pbsa_cap[pbsa_cap[\"local_demand_capacity_pressure\"] > 0][[\n    \"name\",\n    \"plz\",\n    \"ownership\",\n    \"!cap\",\n    \"ownership_model\",\n    \"cluster_cap\",\n    \"local_demand_capacity_pressure\",\n]].sort_values(\"local_demand_capacity_pressure\", ascending=False).head(10)","key":"vY7BkykI5l"},{"type":"outputs","id":"mEZ3n65zr83FKEbms_uNt","children":[{"type":"output","jupyter_data":{"output_type":"execute_result","execution_count":18,"metadata":{},"data":{"application/vnd.microsoft.datawrangler.viewer.v0+json":{"content":"{\"columns\":[{\"name\":\"index\",\"rawType\":\"int64\",\"type\":\"integer\"},{\"name\":\"name\",\"rawType\":\"object\",\"type\":\"string\"},{\"name\":\"plz\",\"rawType\":\"object\",\"type\":\"string\"},{\"name\":\"ownership\",\"rawType\":\"object\",\"type\":\"string\"},{\"name\":\"!cap\",\"rawType\":\"float64\",\"type\":\"float\"},{\"name\":\"ownership_model\",\"rawType\":\"object\",\"type\":\"string\"},{\"name\":\"cluster_cap\",\"rawType\":\"object\",\"type\":\"string\"},{\"name\":\"local_demand_capacity_pressure\",\"rawType\":\"float32\",\"type\":\"float\"}],\"ref\":\"99820232-6f1d-4a51-afbf-8521f76c9a67\",\"rows\":[[\"2\",\"Am Mühlenberg\",\"10825\",\"Gewobag\",\"158.0\",\"State-Owned\",\"LL\",\"34.094\"],[\"15\",\"Insider Apartments Berliner Straße\",\"10715\",\"Insider Apartment Community Living GmbH\",\"200.0\",\"Privat-Owned\",\"LL\",\"33.356\"],[\"63\",\"WH Düsseldorfer Straße\",\"10719\",\"Studierendenwerk Berlin\",\"73.0\",\"State-Owned\",\"LL\",\"31.245\"],[\"78\",\"WH Pfalzburgerstraße\",\"10717\",\"Studierendenwerk Berlin\",\"28.0\",\"State-Owned\",\"LL\",\"31.245\"],[\"62\",\"WH Derfflingerstraße (Haus Unger)\",\"10785\",\"Studierendenwerk Berlin\",\"143.0\",\"State-Owned\",\"LL\",\"28.344\"],[\"81\",\"WH Siegmunds Hof\",\"10555\",\"Studierendenwerk Berlin\",\"590.0\",\"State-Owned\",\"LH\",\"28.344\"],[\"17\",\"Insider Apartments Leibniz Straße\",\"10625\",\"Insider Apartment Community Living GmbH\",\"200.0\",\"Privat-Owned\",\"LL\",\"28.344\"],[\"76\",\"WH Nollendorfstraße\",\"10777\",\"Studierendenwerk Berlin\",\"183.0\",\"State-Owned\",\"LL\",\"28.344\"],[\"70\",\"WH Hardenbergstraße\",\"10623\",\"Studierendenwerk Berlin\",\"46.0\",\"State-Owned\",\"LL\",\"28.344\"],[\"47\",\"Studentenwohnheim Walter-May-Haus\",\"13353\",\"Home in Berlin GmbH\",\"276.0\",\"Privat-Owned\",\"NS\",\"27.154\"]],\"shape\":{\"columns\":7,\"rows\":10}}","content_type":"application/vnd.microsoft.datawrangler.viewer.v0+json"},"text/html":{"content":"<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>name</th>\n      <th>plz</th>\n      <th>ownership</th>\n      <th>!cap</th>\n      <th>ownership_model</th>\n      <th>cluster_cap</th>\n      <th>local_demand_capacity_pressure</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>2</th>\n      <td>Am Mühlenberg</td>\n      <td>10825</td>\n      <td>Gewobag</td>\n      <td>158.0</td>\n      <td>State-Owned</td>\n      <td>LL</td>\n      <td>34.094002</td>\n    </tr>\n    <tr>\n      <th>15</th>\n      <td>Insider Apartments Berliner Straße</td>\n      <td>10715</td>\n      <td>Insider Apartment Community Living GmbH</td>\n      <td>200.0</td>\n      <td>Privat-Owned</td>\n      <td>LL</td>\n      <td>33.355999</td>\n    </tr>\n    <tr>\n      <th>63</th>\n      <td>WH Düsseldorfer Straße</td>\n      <td>10719</td>\n      <td>Studierendenwerk Berlin</td>\n      <td>73.0</td>\n      <td>State-Owned</td>\n      <td>LL</td>\n      <td>31.245001</td>\n    </tr>\n    <tr>\n      <th>78</th>\n      <td>WH Pfalzburgerstraße</td>\n      <td>10717</td>\n      <td>Studierendenwerk Berlin</td>\n      <td>28.0</td>\n      <td>State-Owned</td>\n      <td>LL</td>\n      <td>31.245001</td>\n    </tr>\n    <tr>\n      <th>62</th>\n      <td>WH Derfflingerstraße (Haus Unger)</td>\n      <td>10785</td>\n      <td>Studierendenwerk Berlin</td>\n      <td>143.0</td>\n      <td>State-Owned</td>\n      <td>LL</td>\n      <td>28.344000</td>\n    </tr>\n    <tr>\n      <th>81</th>\n      <td>WH Siegmunds Hof</td>\n      <td>10555</td>\n      <td>Studierendenwerk Berlin</td>\n      <td>590.0</td>\n      <td>State-Owned</td>\n      <td>LH</td>\n      <td>28.344000</td>\n    </tr>\n    <tr>\n      <th>17</th>\n      <td>Insider Apartments Leibniz Straße</td>\n      <td>10625</td>\n      <td>Insider Apartment Community Living GmbH</td>\n      <td>200.0</td>\n      <td>Privat-Owned</td>\n      <td>LL</td>\n      <td>28.344000</td>\n    </tr>\n    <tr>\n      <th>76</th>\n      <td>WH Nollendorfstraße</td>\n      <td>10777</td>\n      <td>Studierendenwerk Berlin</td>\n      <td>183.0</td>\n      <td>State-Owned</td>\n      <td>LL</td>\n      <td>28.344000</td>\n    </tr>\n    <tr>\n      <th>70</th>\n      <td>WH Hardenbergstraße</td>\n      <td>10623</td>\n      <td>Studierendenwerk Berlin</td>\n      <td>46.0</td>\n      <td>State-Owned</td>\n      <td>LL</td>\n      <td>28.344000</td>\n    </tr>\n    <tr>\n      <th>47</th>\n      <td>Studentenwohnheim Walter-May-Haus</td>\n      <td>13353</td>\n      <td>Home in Berlin GmbH</td>\n      <td>276.0</td>\n      <td>Privat-Owned</td>\n      <td>NS</td>\n      <td>27.153999</td>\n    </tr>\n  </tbody>\n</table>\n</div>","content_type":"text/html"},"text/plain":{"content":"                                  name    plz  \\\n2                        Am Mühlenberg  10825   \n15  Insider Apartments Berliner Straße  10715   \n63              WH Düsseldorfer Straße  10719   \n78                WH Pfalzburgerstraße  10717   \n62   WH Derfflingerstraße (Haus Unger)  10785   \n81                    WH Siegmunds Hof  10555   \n17   Insider Apartments Leibniz Straße  10625   \n76                 WH Nollendorfstraße  10777   \n70                 WH Hardenbergstraße  10623   \n47   Studentenwohnheim Walter-May-Haus  13353   \n\n                                  ownership   !cap ownership_model  \\\n2                                   Gewobag  158.0     State-Owned   \n15  Insider Apartment Community Living GmbH  200.0    Privat-Owned   \n63                  Studierendenwerk Berlin   73.0     State-Owned   \n78                  Studierendenwerk Berlin   28.0     State-Owned   \n62                  Studierendenwerk Berlin  143.0     State-Owned   \n81                  Studierendenwerk Berlin  590.0     State-Owned   \n17  Insider Apartment Community Living GmbH  200.0    Privat-Owned   \n76                  Studierendenwerk Berlin  183.0     State-Owned   \n70                  Studierendenwerk Berlin   46.0     State-Owned   \n47                      Home in Berlin GmbH  276.0    Privat-Owned   \n\n   cluster_cap  local_demand_capacity_pressure  \n2           LL                       34.094002  \n15          LL                       33.355999  \n63          LL                       31.245001  \n78          LL                       31.245001  \n62          LL                       28.344000  \n81          LH                       28.344000  \n17          LL                       28.344000  \n76          LL                       28.344000  \n70          LL                       28.344000  \n47          NS                       27.153999  ","content_type":"text/plain"}}},"children":[],"key":"VznbQawhUq"}],"key":"Jr2Ge94G2C"}],"key":"e6oJvVCCN1"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"emphasis","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Table XX. Most Pressured Student Accommodations","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"QHrMwgmVWm"}],"key":"BDULnyUNvz"}],"key":"wRNbLtxgEv"}],"key":"sIHXJLennp"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"большое давнение прихолитьмя именно на Studierendenwerk Berlin - госудавсвенные общежития","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"CRUTOBc2i8"}],"key":"ObVeavXN7K"}],"key":"vyvuAvNwsB"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"cmap_mint_mini = ListedColormap(cmap_mint(np.linspace(0.15, 1, 256)))\n\nfig, ax = plt.subplots(figsize=(12, 12))\n\n# Replace pgr, bz, out with your base layers if needed\npgr.plot(ax=ax, facecolor='none', edgecolor='#cccccc', linewidth=0.5, linestyle=\"--\")\nbz.plot(ax=ax, facecolor='none', edgecolor='#999999', linewidth=0.75)\n# for idx, row in bz.iterrows():\n#     centroid = row['geometry'].centroid\n#     txt = ax.text(\n#         centroid.x, centroid.y,\n#         str(row['namgem']),\n#         fontsize=8, color='#666666', ha='center', va='center'\n#     )\n#     txt.set_path_effects([\n#         path_effects.Stroke(linewidth=2, foreground='white'),\n#         path_effects.Normal()\n#     ])\nout.plot(ax=ax, facecolor='none', edgecolor='#666666', linewidth=1.25)\n\nvmin=0\nvmax=35\n\npbsa_cap.plot(\n    ax=ax,\n    column='local_demand_capacity_pressure',\n    cmap=cmap_mintpi_mini,\n    edgecolor='none',\n    linewidth=0.3,\n    alpha=1,\n    legend=False,\n    vmin = vmin,\n    vmax = vmax)  # Matching Previous plott\n\nplt.tight_layout()\n\ncbar = plt.colorbar(im, ax=ax, fraction=0.036, pad=0.04)\ncbar.set_label('local_demand_capacity_pressure', fontsize=12)\ncbar.outline.set_visible(False)  # cleaner look\n\n# sm = plt.cm.ScalarMappable(cmap=cmap_mintpi_mini, norm=plt.Normalize(vmin, vmax))\n# cbar = fig.colorbar(sm, ax=ax, shrink=0.6)\n# cbar.set_label(\"summed demand capacity pressure\")\n# cbar.set_ticks(range(vmin, 36))\n\n# for _, r in market_area.iterrows():\n#     ax.annotate(str(int(r[\"cntr_hierracy_rank\"])), \n#                 xy=r[\"geometry\"].representative_point().coords[0],\n#                 ha=\"center\", va=\"center\", fontsize=7)\n\n# market_area.plot(\n#     ax=ax,\n#     edgecolor='white',  # variable for colormap\n#     facecolor=\"none\",        # transparent polygons  # edge colors from your column\n#     linewidth=0.3,\n#     alpha=1\n# )\nplt.tight_layout()\n\ncentral_places.plot(ax=ax,\n           color='#434343',\n           markersize= 10,\n           alpha=0.75,\n           edgecolor='white',\n           linewidth=1)\nplt.tight_layout()\nfor idx, row in central_places.iterrows():\n    offset = 3  # vertical offset in points\n    ax.annotate(\n        row['abr'],  # abbreviation\n        xy=(row.geometry.x, row.geometry.y),  # position of the point\n        xytext=(0, offset),  # move text upward\n        textcoords='offset points',\n        color='#1b4332',     # dark mint / forest green for good contrast\n        fontsize=8,\n        ha='center',\n        va='bottom',\n        alpha=1,\n        zorder=6,\n        path_effects=[\n            path_effects.Stroke(linewidth=2, foreground='white'),\n            path_effects.Normal()\n        ]\n    )\n\n#ax.legend(handles=legend_elements, loc='lower center', ncol=5, frameon=False, prop={'size': 10})\nax.set_title('Student Accommodation Demand Capacity Pressure', fontsize=16, weight='bold')\nax.set_axis_off()\n\nsave_path = os.path.join(hf, \"Student Accommodation Demand Capacity Pressure.png\")\nplt.savefig(save_path, dpi=300, bbox_inches=\"tight\")\n\nplt.show()","visibility":"remove","key":"YsCqRLM8TU"},{"type":"outputs","id":"EvpL_8yfLS31LYHRDs2Q_","children":[{"type":"output","jupyter_data":{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"dd05bc99b4de4c8e60c398783719b646","path":"/rethinking_student_housing/build/dd05bc99b4de4c8e60c398783719b646.png"},"text/plain":{"content":"<Figure size 1200x1200 with 2 Axes>","content_type":"text/plain"}}},"children":[],"key":"kYLVmEdBeu"}],"visibility":"show","key":"LXXjelBQGP"}],"visibility":"show","key":"BABUfh7M3U"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"emphasis","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Figure XX. Student Accommodation Demand Capacity Pressure","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"SyYNjpDiO1"}],"key":"ByXi6WgkPj"}],"key":"LvFMzoshYA"}],"key":"fsB0gVwxAw"}],"key":"v7W2yb3uRO"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"3.2 Central Place Analysis","url":"/notebooks/central-place-analysis","group":"3. Student Housing Market Imbalance"},"next":{"title":"4.1 Overview","url":"/notebooks/overview-2","group":"4. Students Behind the Numbers"}}},"domain":"http://localhost:3000"}